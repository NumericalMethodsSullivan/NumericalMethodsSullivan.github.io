<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>A Introduction to Python | Numerical Methods</title>
  <meta name="description" content="Inquiry Based Numerical Methods" />
  <meta name="generator" content="bookdown 0.24 and GitBook 2.6.7" />

  <meta property="og:title" content="A Introduction to Python | Numerical Methods" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Inquiry Based Numerical Methods" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="A Introduction to Python | Numerical Methods" />
  
  <meta name="twitter:description" content="Inquiry Based Numerical Methods" />
  

<meta name="author" content="Dr. Eric Sullivan" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-pdes.html"/>
<link rel="next" href="ch-writing.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front Matter</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#creative-commons"><i class="fa fa-check"></i>Creative Commons</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#to-the-student"><i class="fa fa-check"></i>To The Student</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-inquiry-based-approach"><i class="fa fa-check"></i>The Inquiry-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#to-the-instructor"><i class="fa fa-check"></i>To the Instructor</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-inquiry-based-approach-1"><i class="fa fa-check"></i>The Inquiry-Based Approach</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-projects"><i class="fa fa-check"></i>The Projects</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#coding"><i class="fa fa-check"></i>Coding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pacing"><i class="fa fa-check"></i>Pacing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-considerations"><i class="fa fa-check"></i>Other Considerations:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> Preliminary Topics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#what-is-numerical-analysis"><i class="fa fa-check"></i><b>1.1</b> What Is Numerical Analysis?</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#arithmetic-in-base-2"><i class="fa fa-check"></i><b>1.2</b> Arithmetic in Base 2</a></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#floating-point-arithmetic"><i class="fa fa-check"></i><b>1.3</b> Floating Point Arithmetic</a></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec:Taylor"><i class="fa fa-check"></i><b>1.4</b> Approximating Functions</a></li>
<li class="chapter" data-level="1.5" data-path="ch-intro.html"><a href="ch-intro.html#approximation-error-with-taylor-series"><i class="fa fa-check"></i><b>1.5</b> Approximation Error with Taylor Series</a></li>
<li class="chapter" data-level="1.6" data-path="ch-intro.html"><a href="ch-intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="ch-intro.html"><a href="ch-intro.html#coding-exercises"><i class="fa fa-check"></i><b>1.6.1</b> Coding Exercises</a></li>
<li class="chapter" data-level="1.6.2" data-path="ch-intro.html"><a href="ch-intro.html#applying-what-youve-learned"><i class="fa fa-check"></i><b>1.6.2</b> Applying What You’ve Learned</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-algebra.html"><a href="ch-algebra.html"><i class="fa fa-check"></i><b>2</b> Algebra</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intro-to-numerical-root-finding"><i class="fa fa-check"></i><b>2.1</b> Intro to Numerical Root Finding</a></li>
<li class="chapter" data-level="2.2" data-path="ch-algebra.html"><a href="ch-algebra.html#the-bisection-method"><i class="fa fa-check"></i><b>2.2</b> The Bisection Method</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation"><i class="fa fa-check"></i><b>2.2.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis"><i class="fa fa-check"></i><b>2.2.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-algebra.html"><a href="ch-algebra.html#the-regula-falsi-method"><i class="fa fa-check"></i><b>2.3</b> The Regula Falsi Method</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-1"><i class="fa fa-check"></i><b>2.3.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.3.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-algebra.html"><a href="ch-algebra.html#newtons-method"><i class="fa fa-check"></i><b>2.4</b> Newton’s Method</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-2"><i class="fa fa-check"></i><b>2.4.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-2"><i class="fa fa-check"></i><b>2.4.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch-algebra.html"><a href="ch-algebra.html#the-secant-method"><i class="fa fa-check"></i><b>2.5</b> The Secant Method</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-3"><i class="fa fa-check"></i><b>2.5.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.5.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-3"><i class="fa fa-check"></i><b>2.5.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-algebra.html"><a href="ch-algebra.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ch-algebra.html"><a href="ch-algebra.html#algorithm-summaries"><i class="fa fa-check"></i><b>2.6.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="2.6.2" data-path="ch-algebra.html"><a href="ch-algebra.html#applying-what-youve-learned-1"><i class="fa fa-check"></i><b>2.6.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="ch-algebra.html"><a href="ch-algebra.html#projects"><i class="fa fa-check"></i><b>2.7</b> Projects</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="ch-algebra.html"><a href="ch-algebra.html#basins-of-attraction"><i class="fa fa-check"></i><b>2.7.1</b> Basins of Attraction</a></li>
<li class="chapter" data-level="2.7.2" data-path="ch-algebra.html"><a href="ch-algebra.html#artillery"><i class="fa fa-check"></i><b>2.7.2</b> Artillery</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-calculus.html"><a href="ch-calculus.html"><i class="fa fa-check"></i><b>3</b> Calculus</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-calculus.html"><a href="ch-calculus.html#intro-to-numerical-calculus"><i class="fa fa-check"></i><b>3.1</b> Intro to Numerical Calculus</a></li>
<li class="chapter" data-level="3.2" data-path="ch-calculus.html"><a href="ch-calculus.html#differentiation"><i class="fa fa-check"></i><b>3.2</b> Differentiation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-calculus.html"><a href="ch-calculus.html#the-first-derivative"><i class="fa fa-check"></i><b>3.2.1</b> The First Derivative</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-calculus.html"><a href="ch-calculus.html#error-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Error Analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-calculus.html"><a href="ch-calculus.html#efficient-coding"><i class="fa fa-check"></i><b>3.2.3</b> Efficient Coding</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-calculus.html"><a href="ch-calculus.html#a-better-first-derivative"><i class="fa fa-check"></i><b>3.2.4</b> A Better First Derivative</a></li>
<li class="chapter" data-level="3.2.5" data-path="ch-calculus.html"><a href="ch-calculus.html#the-second-derivative"><i class="fa fa-check"></i><b>3.2.5</b> The Second Derivative</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-calculus.html"><a href="ch-calculus.html#integration"><i class="fa fa-check"></i><b>3.3</b> Integration</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch-calculus.html"><a href="ch-calculus.html#riemann-sums"><i class="fa fa-check"></i><b>3.3.1</b> Riemann Sums</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch-calculus.html"><a href="ch-calculus.html#trapezoidal-rule"><i class="fa fa-check"></i><b>3.3.2</b> Trapezoidal Rule</a></li>
<li class="chapter" data-level="3.3.3" data-path="ch-calculus.html"><a href="ch-calculus.html#simpsons-rule"><i class="fa fa-check"></i><b>3.3.3</b> Simpsons Rule</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ch-calculus.html"><a href="ch-calculus.html#optimization"><i class="fa fa-check"></i><b>3.4</b> Optimization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch-calculus.html"><a href="ch-calculus.html#single-variable-optimization"><i class="fa fa-check"></i><b>3.4.1</b> Single Variable Optimization</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-calculus.html"><a href="ch-calculus.html#multivariable-optimization"><i class="fa fa-check"></i><b>3.4.2</b> Multivariable Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ch-calculus.html"><a href="ch-calculus.html#calculus-with-numpy-and-scipy"><i class="fa fa-check"></i><b>3.5</b> Calculus with <code>numpy</code> and <code>scipy</code></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch-calculus.html"><a href="ch-calculus.html#differentiation-1"><i class="fa fa-check"></i><b>3.5.1</b> Differentiation</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-calculus.html"><a href="ch-calculus.html#integration-1"><i class="fa fa-check"></i><b>3.5.2</b> Integration</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-calculus.html"><a href="ch-calculus.html#optimization-1"><i class="fa fa-check"></i><b>3.5.3</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch-calculus.html"><a href="ch-calculus.html#least-squares-curve-fitting"><i class="fa fa-check"></i><b>3.6</b> Least Squares Curve Fitting</a></li>
<li class="chapter" data-level="3.7" data-path="ch-calculus.html"><a href="ch-calculus.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="ch-calculus.html"><a href="ch-calculus.html#algorithm-summaries-1"><i class="fa fa-check"></i><b>3.7.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="3.7.2" data-path="ch-calculus.html"><a href="ch-calculus.html#applying-what-youve-learned-2"><i class="fa fa-check"></i><b>3.7.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="ch-calculus.html"><a href="ch-calculus.html#projects-1"><i class="fa fa-check"></i><b>3.8</b> Projects</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="ch-calculus.html"><a href="ch-calculus.html#galaxy-integration"><i class="fa fa-check"></i><b>3.8.1</b> Galaxy Integration</a></li>
<li class="chapter" data-level="3.8.2" data-path="ch-calculus.html"><a href="ch-calculus.html#higher-order-integration"><i class="fa fa-check"></i><b>3.8.2</b> Higher Order Integration</a></li>
<li class="chapter" data-level="3.8.3" data-path="ch-calculus.html"><a href="ch-calculus.html#dam-integration"><i class="fa fa-check"></i><b>3.8.3</b> Dam Integration</a></li>
<li class="chapter" data-level="3.8.4" data-path="ch-calculus.html"><a href="ch-calculus.html#edge-detection-in-images"><i class="fa fa-check"></i><b>3.8.4</b> Edge Detection in Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html"><i class="fa fa-check"></i><b>4</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#intro-to-numerical-linear-algebra"><i class="fa fa-check"></i><b>4.1</b> Intro to Numerical Linear Algebra</a></li>
<li class="chapter" data-level="4.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#vectors-and-matrices-in-python"><i class="fa fa-check"></i><b>4.2</b> Vectors and Matrices in Python</a></li>
<li class="chapter" data-level="4.3" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#matrix-and-vector-operations"><i class="fa fa-check"></i><b>4.3</b> Matrix and Vector Operations</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-dot-product"><i class="fa fa-check"></i><b>4.3.1</b> The Dot Product</a></li>
<li class="chapter" data-level="4.3.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#matrix-multiplication"><i class="fa fa-check"></i><b>4.3.2</b> Matrix Multiplication</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-lu-factorization"><i class="fa fa-check"></i><b>4.4</b> The LU Factorization</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#a-recap-of-row-reduction"><i class="fa fa-check"></i><b>4.4.1</b> A Recap of Row Reduction</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-lu-decomposition"><i class="fa fa-check"></i><b>4.4.2</b> The LU Decomposition</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#solving-triangular-systems"><i class="fa fa-check"></i><b>4.4.3</b> Solving Triangular Systems</a></li>
<li class="chapter" data-level="4.4.4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#solving-systems-with-lu"><i class="fa fa-check"></i><b>4.4.4</b> Solving Systems with LU</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-qr-factorization"><i class="fa fa-check"></i><b>4.5</b> The QR Factorization</a></li>
<li class="chapter" data-level="4.6" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#over-determined-systems-and-curve-fitting"><i class="fa fa-check"></i><b>4.6</b> Over Determined Systems and Curve Fitting</a></li>
<li class="chapter" data-level="4.7" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-eigenvalue-eigenvector-problem"><i class="fa fa-check"></i><b>4.7</b> The Eigenvalue-Eigenvector Problem</a></li>
<li class="chapter" data-level="4.8" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#exercises-3"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#algorithm-summaries-2"><i class="fa fa-check"></i><b>4.8.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="4.8.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#applying-what-youve-learned-3"><i class="fa fa-check"></i><b>4.8.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#projects-2"><i class="fa fa-check"></i><b>4.9</b> Projects</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-google-page-rank-algorithm"><i class="fa fa-check"></i><b>4.9.1</b> The Google Page Rank Algorithm</a></li>
<li class="chapter" data-level="4.9.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#alternative-methods-to-solving-a-boldsymbolx-boldsymbolb"><i class="fa fa-check"></i><b>4.9.2</b> Alternative Methods To Solving <span class="math inline">\(A \boldsymbol{x} = \boldsymbol{b}\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-odes.html"><a href="ch-odes.html"><i class="fa fa-check"></i><b>5</b> Ordinary Differential Equations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-odes.html"><a href="ch-odes.html#intro-to-numerical-odes"><i class="fa fa-check"></i><b>5.1</b> Intro to Numerical ODEs</a></li>
<li class="chapter" data-level="5.2" data-path="ch-odes.html"><a href="ch-odes.html#recalling-the-basics-of-odes"><i class="fa fa-check"></i><b>5.2</b> Recalling the Basics of ODEs</a></li>
<li class="chapter" data-level="5.3" data-path="ch-odes.html"><a href="ch-odes.html#eulers-method"><i class="fa fa-check"></i><b>5.3</b> Euler’s Method</a></li>
<li class="chapter" data-level="5.4" data-path="ch-odes.html"><a href="ch-odes.html#the-midpoint-method"><i class="fa fa-check"></i><b>5.4</b> The Midpoint Method</a></li>
<li class="chapter" data-level="5.5" data-path="ch-odes.html"><a href="ch-odes.html#the-runge-kutta-4-method"><i class="fa fa-check"></i><b>5.5</b> The Runge-Kutta 4 Method</a></li>
<li class="chapter" data-level="5.6" data-path="ch-odes.html"><a href="ch-odes.html#animating-ode-solutions"><i class="fa fa-check"></i><b>5.6</b> Animating ODE Solutions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ch-odes.html"><a href="ch-odes.html#ipywidgets.interactive"><i class="fa fa-check"></i><b>5.6.1</b> <code>ipywidgets.interactive</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="ch-odes.html"><a href="ch-odes.html#matplotlib.animation"><i class="fa fa-check"></i><b>5.6.2</b> <code>matplotlib.animation</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ch-odes.html"><a href="ch-odes.html#the-backwards-euler-method"><i class="fa fa-check"></i><b>5.7</b> The Backwards Euler Method</a></li>
<li class="chapter" data-level="5.8" data-path="ch-odes.html"><a href="ch-odes.html#fitting-ode-models-to-data"><i class="fa fa-check"></i><b>5.8</b> Fitting ODE Models to Data</a></li>
<li class="chapter" data-level="5.9" data-path="ch-odes.html"><a href="ch-odes.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="ch-odes.html"><a href="ch-odes.html#algorithm-summaries-3"><i class="fa fa-check"></i><b>5.9.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="5.9.2" data-path="ch-odes.html"><a href="ch-odes.html#applying-what-youve-learned-4"><i class="fa fa-check"></i><b>5.9.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="ch-odes.html"><a href="ch-odes.html#projects-3"><i class="fa fa-check"></i><b>5.10</b> Projects</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="ch-odes.html"><a href="ch-odes.html#the-covid-19-pandemic"><i class="fa fa-check"></i><b>5.10.1</b> The COVID-19 Pandemic</a></li>
<li class="chapter" data-level="5.10.2" data-path="ch-odes.html"><a href="ch-odes.html#pain-management"><i class="fa fa-check"></i><b>5.10.2</b> Pain Management</a></li>
<li class="chapter" data-level="5.10.3" data-path="ch-odes.html"><a href="ch-odes.html#the-h1n1-virus"><i class="fa fa-check"></i><b>5.10.3</b> The H1N1 Virus</a></li>
<li class="chapter" data-level="5.10.4" data-path="ch-odes.html"><a href="ch-odes.html#the-artillery-problem"><i class="fa fa-check"></i><b>5.10.4</b> The Artillery Problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-pdes.html"><a href="ch-pdes.html"><i class="fa fa-check"></i><b>6</b> Partial Differential Equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-pdes.html"><a href="ch-pdes.html#intro-to-pdes"><i class="fa fa-check"></i><b>6.1</b> Intro to PDEs</a></li>
<li class="chapter" data-level="6.2" data-path="ch-pdes.html"><a href="ch-pdes.html#solutions-to-pdes"><i class="fa fa-check"></i><b>6.2</b> Solutions to PDEs</a></li>
<li class="chapter" data-level="6.3" data-path="ch-pdes.html"><a href="ch-pdes.html#boundary-conditions"><i class="fa fa-check"></i><b>6.3</b> Boundary Conditions</a></li>
<li class="chapter" data-level="6.4" data-path="ch-pdes.html"><a href="ch-pdes.html#the-heat-equation"><i class="fa fa-check"></i><b>6.4</b> The Heat Equation</a></li>
<li class="chapter" data-level="6.5" data-path="ch-pdes.html"><a href="ch-pdes.html#stability-of-the-heat-equation-solution"><i class="fa fa-check"></i><b>6.5</b> Stability of the Heat Equation Solution</a></li>
<li class="chapter" data-level="6.6" data-path="ch-pdes.html"><a href="ch-pdes.html#the-wave-equation"><i class="fa fa-check"></i><b>6.6</b> The Wave Equation</a></li>
<li class="chapter" data-level="6.7" data-path="ch-pdes.html"><a href="ch-pdes.html#traveling-waves"><i class="fa fa-check"></i><b>6.7</b> Traveling Waves</a></li>
<li class="chapter" data-level="6.8" data-path="ch-pdes.html"><a href="ch-pdes.html#the-laplace-and-poisson-equations"><i class="fa fa-check"></i><b>6.8</b> The Laplace and Poisson Equations</a></li>
<li class="chapter" data-level="6.9" data-path="ch-pdes.html"><a href="ch-pdes.html#exercises-5"><i class="fa fa-check"></i><b>6.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="ch-pdes.html"><a href="ch-pdes.html#algorithm-summaries-4"><i class="fa fa-check"></i><b>6.9.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="6.9.2" data-path="ch-pdes.html"><a href="ch-pdes.html#applying-what-youve-learned-5"><i class="fa fa-check"></i><b>6.9.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="ch-pdes.html"><a href="ch-pdes.html#projects-4"><i class="fa fa-check"></i><b>6.10</b> Projects</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="ch-pdes.html"><a href="ch-pdes.html#hunting-and-diffusion"><i class="fa fa-check"></i><b>6.10.1</b> Hunting and Diffusion</a></li>
<li class="chapter" data-level="6.10.2" data-path="ch-pdes.html"><a href="ch-pdes.html#heating-adobe-houses"><i class="fa fa-check"></i><b>6.10.2</b> Heating Adobe Houses</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="ch-python.html"><a href="ch-python.html"><i class="fa fa-check"></i><b>A</b> Introduction to Python</a>
<ul>
<li class="chapter" data-level="A.1" data-path="ch-python.html"><a href="ch-python.html#why-python"><i class="fa fa-check"></i><b>A.1</b> Why Python?</a></li>
<li class="chapter" data-level="A.2" data-path="ch-python.html"><a href="ch-python.html#getting-started"><i class="fa fa-check"></i><b>A.2</b> Getting Started</a></li>
<li class="chapter" data-level="A.3" data-path="ch-python.html"><a href="ch-python.html#hello-world"><i class="fa fa-check"></i><b>A.3</b> Hello, World!</a></li>
<li class="chapter" data-level="A.4" data-path="ch-python.html"><a href="ch-python.html#python-programming-basics"><i class="fa fa-check"></i><b>A.4</b> Python Programming Basics</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="ch-python.html"><a href="ch-python.html#variables"><i class="fa fa-check"></i><b>A.4.1</b> Variables</a></li>
<li class="chapter" data-level="A.4.2" data-path="ch-python.html"><a href="ch-python.html#indexing-and-lists"><i class="fa fa-check"></i><b>A.4.2</b> Indexing and Lists</a></li>
<li class="chapter" data-level="A.4.3" data-path="ch-python.html"><a href="ch-python.html#list-operations"><i class="fa fa-check"></i><b>A.4.3</b> List Operations</a></li>
<li class="chapter" data-level="A.4.4" data-path="ch-python.html"><a href="ch-python.html#tuples"><i class="fa fa-check"></i><b>A.4.4</b> Tuples</a></li>
<li class="chapter" data-level="A.4.5" data-path="ch-python.html"><a href="ch-python.html#control-flow-loops-and-if-statements"><i class="fa fa-check"></i><b>A.4.5</b> Control Flow: Loops and If Statements</a></li>
<li class="chapter" data-level="A.4.6" data-path="ch-python.html"><a href="ch-python.html#functions"><i class="fa fa-check"></i><b>A.4.6</b> Functions</a></li>
<li class="chapter" data-level="A.4.7" data-path="ch-python.html"><a href="ch-python.html#lambda-functions"><i class="fa fa-check"></i><b>A.4.7</b> Lambda Functions</a></li>
<li class="chapter" data-level="A.4.8" data-path="ch-python.html"><a href="ch-python.html#packages"><i class="fa fa-check"></i><b>A.4.8</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="ch-python.html"><a href="ch-python.html#numerical-python-with-numpy"><i class="fa fa-check"></i><b>A.5</b> Numerical Python with <code>numpy</code></a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="ch-python.html"><a href="ch-python.html#numpy-arrays-array-operations-and-matrix-operations"><i class="fa fa-check"></i><b>A.5.1</b> Numpy Arrays, Array Operations, and Matrix Operations</a></li>
<li class="chapter" data-level="A.5.2" data-path="ch-python.html"><a href="ch-python.html#arange-linspace-zeros-ones-and-meshgrid"><i class="fa fa-check"></i><b>A.5.2</b> <code>arange, linspace, zeros, ones</code>, and <code>meshgrid</code></a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="ch-python.html"><a href="ch-python.html#plotting-with-matplotlib"><i class="fa fa-check"></i><b>A.6</b> Plotting with <code>matplotlib</code></a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="ch-python.html"><a href="ch-python.html#basics-with-plt.plot"><i class="fa fa-check"></i><b>A.6.1</b> Basics with <code>plt.plot()</code></a></li>
<li class="chapter" data-level="A.6.2" data-path="ch-python.html"><a href="ch-python.html#subplots"><i class="fa fa-check"></i><b>A.6.2</b> Subplots</a></li>
<li class="chapter" data-level="A.6.3" data-path="ch-python.html"><a href="ch-python.html#logarithmic-scaling-with-semilogy-semilogx-and-loglog"><i class="fa fa-check"></i><b>A.6.3</b> Logarithmic Scaling with <code>semilogy</code>, <code>semilogx</code>, and <code>loglog</code></a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="ch-python.html"><a href="ch-python.html#symbolic-python-with-sympy"><i class="fa fa-check"></i><b>A.7</b> Symbolic Python with <code>sympy</code></a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="ch-python.html"><a href="ch-python.html#symbolic-variables-with-symbols"><i class="fa fa-check"></i><b>A.7.1</b> Symbolic Variables with <code>symbols</code></a></li>
<li class="chapter" data-level="A.7.2" data-path="ch-python.html"><a href="ch-python.html#symbolic-algebra"><i class="fa fa-check"></i><b>A.7.2</b> Symbolic Algebra</a></li>
<li class="chapter" data-level="A.7.3" data-path="ch-python.html"><a href="ch-python.html#symbolic-function-evaluation"><i class="fa fa-check"></i><b>A.7.3</b> Symbolic Function Evaluation</a></li>
<li class="chapter" data-level="A.7.4" data-path="ch-python.html"><a href="ch-python.html#symbolic-calculus"><i class="fa fa-check"></i><b>A.7.4</b> Symbolic Calculus</a></li>
<li class="chapter" data-level="A.7.5" data-path="ch-python.html"><a href="ch-python.html#solving-equations-symbolically"><i class="fa fa-check"></i><b>A.7.5</b> Solving Equations Symbolically</a></li>
<li class="chapter" data-level="A.7.6" data-path="ch-python.html"><a href="ch-python.html#symbolic-plotting"><i class="fa fa-check"></i><b>A.7.6</b> Symbolic Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="ch-writing.html"><a href="ch-writing.html"><i class="fa fa-check"></i><b>B</b> Mathematical Writing</a>
<ul>
<li class="chapter" data-level="B.1" data-path="ch-writing.html"><a href="ch-writing.html#the-paper"><i class="fa fa-check"></i><b>B.1</b> The Paper</a></li>
<li class="chapter" data-level="B.2" data-path="ch-writing.html"><a href="ch-writing.html#figures-and-tables"><i class="fa fa-check"></i><b>B.2</b> Figures and Tables</a></li>
<li class="chapter" data-level="B.3" data-path="ch-writing.html"><a href="ch-writing.html#writing-style"><i class="fa fa-check"></i><b>B.3</b> Writing Style</a></li>
<li class="chapter" data-level="B.4" data-path="ch-writing.html"><a href="ch-writing.html#tips-for-writing-clear-math"><i class="fa fa-check"></i><b>B.4</b> Tips For Writing Clear Math</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="ch-writing.html"><a href="ch-writing.html#audience"><i class="fa fa-check"></i><b>B.4.1</b> Audience</a></li>
<li class="chapter" data-level="B.4.2" data-path="ch-writing.html"><a href="ch-writing.html#how-to-make-mathematics-readable-10-things-to-do"><i class="fa fa-check"></i><b>B.4.2</b> How To Make Mathematics Readable – 10 Things To Do</a></li>
<li class="chapter" data-level="B.4.3" data-path="ch-writing.html"><a href="ch-writing.html#some-writing-tips"><i class="fa fa-check"></i><b>B.4.3</b> Some Writing Tips</a></li>
<li class="chapter" data-level="B.4.4" data-path="ch-writing.html"><a href="ch-writing.html#mathematical-vocabulary"><i class="fa fa-check"></i><b>B.4.4</b> Mathematical Vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="ch-writing.html"><a href="ch-writing.html#code-and-mathematical-writing"><i class="fa fa-check"></i><b>B.5</b> Code and Mathematical writing</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="ch-extras.html"><a href="ch-extras.html"><i class="fa fa-check"></i><b>C</b> Optional Material</a>
<ul>
<li class="chapter" data-level="C.1" data-path="ch-extras.html"><a href="ch-extras.html#interpolation"><i class="fa fa-check"></i><b>C.1</b> Interpolation</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="ch-extras.html"><a href="ch-extras.html#vandermonde-interpolation"><i class="fa fa-check"></i><b>C.1.1</b> Vandermonde Interpolation</a></li>
<li class="chapter" data-level="C.1.2" data-path="ch-extras.html"><a href="ch-extras.html#lagrange-interpolation"><i class="fa fa-check"></i><b>C.1.2</b> Lagrange Interpolation</a></li>
<li class="chapter" data-level="C.1.3" data-path="ch-extras.html"><a href="ch-extras.html#chebyshev-points"><i class="fa fa-check"></i><b>C.1.3</b> Chebyshev Points</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="ch-extras.html"><a href="ch-extras.html#sec:mv_newton"><i class="fa fa-check"></i><b>C.2</b> Multi-Dimensional Newton’s Method</a></li>
<li class="chapter" data-level="C.3" data-path="ch-extras.html"><a href="ch-extras.html#the-method-of-lines"><i class="fa fa-check"></i><b>C.3</b> The Method Of Lines</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Numerical Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-python" class="section level1" number="7">
<h1><span class="header-section-number">A</span> Introduction to Python</h1>
<p>In this optional Chapter we will walk through some of the basics of
using Python3 - the powerful general-purpose programming language that
we’ll use throughout this class. I’m assuming throughout this Chapter
that you’re familiar with other programming languages such as R, Java,
C, or MATLAB. Hence, I’m assuming that you know the basics about what a
programming langue “is” and “does.” There are a lot of similarities
between several of these languages, and in fact they borrow heavily from
each other in syntax, ideas, and implementation.</p>
<p>While you work through this chapter it is expected that you do every one of the examples and exercises on your own. The material in this chapter is also support by a collection of YouTube videos which you can find here: <a href="https://www.youtube.com/playlist?list=PLftKiHShKwSO4Lr8BwrlKU_fUeRniS821" class="uri">https://www.youtube.com/playlist?list=PLftKiHShKwSO4Lr8BwrlKU_fUeRniS821</a>.</p>
<div id="why-python" class="section level2" number="7.1">
<h2><span class="header-section-number">A.1</span> Why Python?</h2>
<p>We are going to be using Python since</p>
<ul>
<li>Python is free,</li>
<li>Python is very widely used,</li>
<li>Python is flexible,</li>
<li>Python is relatively easy to learn,</li>
<li>and Python is quite powerful.</li>
</ul>
<p>It is important to keep in mind that Python is a general purpose language that we will be using for Scientific Computing. The purpose of Scientific Computing is <em>not</em> to build apps, build software, manage databases, or develop user interfaces. Instead, Scientific Computing is the use of a computer programming language (like Python) along with mathematics to solve scientific and mathematical problems. For this reason it is definitely not our purpose to write an all-encompassing guide for how to use Python. We’ll only cover what is necessary for our computing needs. You’ll learn more as the course progresses so use this chapter as a reference just to get going with the language.</p>
<p>There is an overwhelming abundance of information available about Python and the suite of tools that we will frequently use.</p>
<ul>
<li>Python <a href="https://www.python.org/" class="uri">https://www.python.org/</a>,</li>
<li><code>numpy</code> (numerical Python) <a href="https://www.numpy.org/" class="uri">https://www.numpy.org/</a>,</li>
<li><code>matplotlib</code> (a suite of plotting tools) <a href="https://matplotlib.org/" class="uri">https://matplotlib.org/</a>,</li>
<li><code>scipy</code> (scientific Python) <a href="https://www.scipy.org/" class="uri">https://www.scipy.org/</a>, and</li>
<li><code>sympy</code> (symbolic Python) <a href="https://www.sympy.org/en/index.html" class="uri">https://www.sympy.org/en/index.html</a>.</li>
</ul>
<p>These tools together provide all of the computational power that will need. And they’re free!</p>
</div>
<div id="getting-started" class="section level2" number="7.2">
<h2><span class="header-section-number">A.2</span> Getting Started</h2>
<p>Every computer is its own unique flower with its own unique requirements. Hence, we will not spend time here giving you all of the ways that you can install Python and all of the associated packages
necessary for this course. For this class we highly recommend that you use the Google Colab notebook tool for writing your Python code: <a href="https://colab.research.google.com" class="uri">https://colab.research.google.com</a>. Google Colab allows you to keep all of your Python code on your Google Drive. The Colab environment is meant to be a free and collaborative version of the popular Jupyter Notebook project. Jupyter Notebooks allow you to write and test code as well as to mix writing (including LaTeX formatting) in along with your code and your output.</p>
<p>If you insist on installing Python on your own machine then I highly recommend that you start with the Anaconda downloader <a href="https://www.anaconda.com/distribution/" class="uri">https://www.anaconda.com/distribution/</a> since it includes the most up-to-date version of Python as well as some of the common tools for writing Python code.</p>
</div>
<div id="hello-world" class="section level2" number="7.3">
<h2><span class="header-section-number">A.3</span> Hello, World!</h2>
<p>As is tradition for a new programming language, we should create code that prints the words “Hello, world!” to the screen. The code below does just that.</p>
<div class="sourceCode" id="cb119"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb119-1"><a href="ch-python.html#cb119-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Hello, world!&quot;</span>)</span></code></pre></div>
<p>In a Jupyter Notebook you will write your code in a code block, and when you’re ready to run it you can press Shift+Enter (or Control+Enter) and you’ll see your output. Shift+Enter will evaluate your code and advance to the next block of code. Control+Enter will evaluate without advancing the cursor to the next block.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-657" class="exercise"><strong>Exercise A.1  </strong></span>Have Python print <code>Hello, world!</code> to the screen.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-658" class="exercise"><strong>Exercise A.2  </strong></span>Write code to print your name to the screen.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-659" class="exercise"><strong>Exercise A.3  </strong></span>You should now spend a bit of time poking around in Jupyter Notebooks. Figure out how to</p>
<ul>
<li>save a file,</li>
<li>load a new iPython Notebook (Jupyter Notebook) file from your computer or your Google Drive,</li>
<li>write text, including LaTeX formatted mathematics,in a Jupyter Notebook,</li>
<li>share and download a Google Colab document, and</li>
<li>use the keyboard to switch between writing text and writing code.</li>
</ul>
</div>
<hr />
</div>
<div id="python-programming-basics" class="section level2" number="7.4">
<h2><span class="header-section-number">A.4</span> Python Programming Basics</h2>
<p>Throughout the remainder of this appendix it is expected that you run all of the blocks of code on your own and critically evaluate and understand the output.</p>
<div id="variables" class="section level3" number="7.4.1">
<h3><span class="header-section-number">A.4.1</span> Variables</h3>
<p>Variables in Python can contain letters (lower case or capital), numbers 0-9, and some special characters such as the underscore. Variable names should start with a letter. Of course there are a bunch of reserved words (just like in any other language). You should look up what the reserved words are in Python so you don’t accidentally use them.</p>
<p>You can do the typical things with variables. Assignment is with an equal sign (be careful R users, we will not be using the left-pointing arrow here!).</p>
<p><strong>Warning:</strong> When defining numerical variables you don’t always get floating point numbers. In some programming languages, if you write <code>x=1</code> then automatically <code>x</code> is saved as 1.0; a floating point decimal number, not an integer. However, in Python if you assign <code>x=1</code> it is defined as an integer (with no decimal digits) but if you assign <code>x=1.0</code> it is assigned as a floating point number.</p>
<div class="sourceCode" id="cb120"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb120-1"><a href="ch-python.html#cb120-1" aria-hidden="true" tabindex="-1"></a><span class="co"># assign some variables</span></span>
<span id="cb120-2"><a href="ch-python.html#cb120-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">7</span> <span class="co"># integer assignment of the integer 7</span></span>
<span id="cb120-3"><a href="ch-python.html#cb120-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="fl">7.0</span> <span class="co"># floating point assignment of the decimal number 7.0</span></span>
<span id="cb120-4"><a href="ch-python.html#cb120-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The variable x is&quot;</span>,x,<span class="st">&quot; and has type&quot;</span>, <span class="bu">type</span>(x),<span class="st">&quot;. </span><span class="ch">\n</span><span class="st">&quot;</span>)</span>
<span id="cb120-5"><a href="ch-python.html#cb120-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The variable y is&quot;</span>,y,<span class="st">&quot; and has type&quot;</span>, <span class="bu">type</span>(y),<span class="st">&quot;. </span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb121"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb121-1"><a href="ch-python.html#cb121-1" aria-hidden="true" tabindex="-1"></a><span class="co"># multiplying by a float will convert an integer to a float</span></span>
<span id="cb121-2"><a href="ch-python.html#cb121-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="dv">7</span> <span class="co"># integer assignment of the integer 7</span></span>
<span id="cb121-3"><a href="ch-python.html#cb121-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Multiplying x by 1.0 gives&quot;</span>,<span class="fl">1.0</span><span class="op">*</span>x)</span>
<span id="cb121-4"><a href="ch-python.html#cb121-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The type of this value is&quot;</span>, <span class="bu">type</span>(<span class="fl">1.0</span><span class="op">*</span>x),<span class="st">&quot;. </span><span class="ch">\n</span><span class="st">&quot;</span>)</span></code></pre></div>
<p>Note that the allowed mathematical operations are:</p>
<ul>
<li>Addition: <code>+</code></li>
<li>Subtraction: <code>-</code></li>
<li>Multiplication: <code>*</code></li>
<li>Division: <code>/</code></li>
<li>Integer Division (modular division): <code>//</code> and</li>
<li>Exponents: <code>**</code></li>
</ul>
<p>That’s right, the caret key, <code>^</code>, is NOT an exponent in Python (sigh). Instead we have to get used to <code>**</code> for exponents.</p>
<div class="sourceCode" id="cb122"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb122-1"><a href="ch-python.html#cb122-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">7.0</span></span>
<span id="cb122-2"><a href="ch-python.html#cb122-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="co"># square the value in x</span></span>
<span id="cb122-3"><a href="ch-python.html#cb122-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span></code></pre></div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-664" class="exercise"><strong>Exercise A.4  </strong></span>What happens if you type <code>7^2</code> into Python? What does it give you? Can
you figure out what it is doing?
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-665" class="exercise"><strong>Exercise A.5  </strong></span>Write code to define positive integers <span class="math inline">\(a,b,\)</span> and <span class="math inline">\(c\)</span> of your own choosing. Then calculate <span class="math inline">\(a^2\)</span>, <span class="math inline">\(b^2\)</span>, and <span class="math inline">\(c^2\)</span>. When you have all three values computed, check to see if your three values form a Pythagorean Triple so that <span class="math inline">\(a^2 + b^2 = c^2\)</span>. Have Python simply say True or False to verify that you do, or do not, have a Pythagorean Triple defined. Hint: You will need to use the <code>==</code> Boolean check just like in other programming languages.</p>
</div>
<hr />
</div>
<div id="indexing-and-lists" class="section level3" number="7.4.2">
<h3><span class="header-section-number">A.4.2</span> Indexing and Lists</h3>
<p>Lists are a key component to storing data in Python. Lists are exactly what the name says: lists of things (in our case, usually the entries are floating point numbers).</p>
<p><strong>Warning:</strong> Python indexing starts at 0 whereas some other programming languages have indexing starting at 1. In other words, the first entry of a list has index 0, the second entry as index 1, and so on. We just have to keep this in mind.</p>
<p>We can extract a part of a list using the syntax <code>name[start:stop]</code> which extracts elements between index <code>start</code> and <code>stop-1</code>. Take note that Python stops reading at the second to last index. This often catches people off guard when they first start with Python.</p>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-668" class="example"><strong>Example A.1  </strong></span>(<strong>Lists and Indexing</strong>) Let’s look at a few examples of indexing from lists. In this example we will use the list of numbers 0 through 8. This list contains 9 numbers indexed from 0 to 8.</p>
<ul>
<li>Create the list of numbers 0 through 8 and then print only the element with index 0.</li>
</ul>
</div>
<div class="sourceCode" id="cb123"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb123-1"><a href="ch-python.html#cb123-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>] </span>
<span id="cb123-2"><a href="ch-python.html#cb123-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList[<span class="dv">0</span>]) </span></code></pre></div>
<ul>
<li>Print all elements up to, but not including, the third element of <code>MyList</code>.</li>
</ul>
<div class="sourceCode" id="cb124"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb124-1"><a href="ch-python.html#cb124-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>] </span>
<span id="cb124-2"><a href="ch-python.html#cb124-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList[:<span class="dv">2</span>])</span></code></pre></div>
<ul>
<li>Print the last element of <code>MyList</code> (this is a handy trick!).</li>
</ul>
<div class="sourceCode" id="cb125"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb125-1"><a href="ch-python.html#cb125-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>] </span>
<span id="cb125-2"><a href="ch-python.html#cb125-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList[<span class="op">-</span><span class="dv">1</span>]) </span></code></pre></div>
<ul>
<li>Print the elements indexed 1 through 4. Beware! This is not the first through fifth element.</li>
</ul>
<div class="sourceCode" id="cb126"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb126-1"><a href="ch-python.html#cb126-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>] </span>
<span id="cb126-2"><a href="ch-python.html#cb126-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList[<span class="dv">1</span>:<span class="dv">5</span>]) </span></code></pre></div>
<ul>
<li>Print every other element in the list starting with the first.</li>
</ul>
<div class="sourceCode" id="cb127"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb127-1"><a href="ch-python.html#cb127-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>] </span>
<span id="cb127-2"><a href="ch-python.html#cb127-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList[<span class="dv">0</span>::<span class="dv">2</span>])</span></code></pre></div>
<ul>
<li>Print the last three elements of <code>MyList</code></li>
</ul>
<div class="sourceCode" id="cb128"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb128-1"><a href="ch-python.html#cb128-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>,<span class="dv">7</span>,<span class="dv">8</span>] </span>
<span id="cb128-2"><a href="ch-python.html#cb128-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList[<span class="op">-</span><span class="dv">3</span>:])</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-675" class="example"><strong>Example A.2  </strong></span>(<strong>Range and Lists</strong>) Let’s look at another example of indexing in lists. In this one we’ll use the <code>range</code> command to build the initial list of numbers. Read the code carefully so you know what each line does, and then execute the code on your own to verify your thinking.
</div>
<div class="sourceCode" id="cb129"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb129-1"><a href="ch-python.html#cb129-1" aria-hidden="true" tabindex="-1"></a><span class="co"># range is a handy command for creating a sequence of integers</span></span>
<span id="cb129-2"><a href="ch-python.html#cb129-2" aria-hidden="true" tabindex="-1"></a>MySecondList <span class="op">=</span> <span class="bu">range</span>(<span class="dv">4</span>,<span class="dv">20</span>) </span>
<span id="cb129-3"><a href="ch-python.html#cb129-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MySecondList) <span class="co"># this is a &quot;range object&quot; in Python.  </span></span>
<span id="cb129-4"><a href="ch-python.html#cb129-4" aria-hidden="true" tabindex="-1"></a><span class="co"># When using range() we won&#39;t actually store all of the </span></span>
<span id="cb129-5"><a href="ch-python.html#cb129-5" aria-hidden="true" tabindex="-1"></a><span class="co"># values in memory.</span></span>
<span id="cb129-6"><a href="ch-python.html#cb129-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">list</span>(MySecondList)) </span>
<span id="cb129-7"><a href="ch-python.html#cb129-7" aria-hidden="true" tabindex="-1"></a><span class="co"># notice that we didn&#39;t create the last element!</span></span>
<span id="cb129-8"><a href="ch-python.html#cb129-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb129-9"><a href="ch-python.html#cb129-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MySecondList[<span class="dv">0</span>]) <span class="co"># print the first element (index 0)</span></span>
<span id="cb129-10"><a href="ch-python.html#cb129-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MySecondList[<span class="op">-</span><span class="dv">5</span>]) <span class="co"># print the fifth element from the end</span></span>
<span id="cb129-11"><a href="ch-python.html#cb129-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MySecondList[<span class="op">-</span><span class="dv">1</span>:<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="co"># this creates a new range object.  </span></span>
<span id="cb129-12"><a href="ch-python.html#cb129-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Take careful note of how the above range object is defined.</span></span>
<span id="cb129-13"><a href="ch-python.html#cb129-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Print the last element to the one indexed by 1 counting backward</span></span>
<span id="cb129-14"><a href="ch-python.html#cb129-14" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">list</span>(MySecondList[<span class="op">-</span><span class="dv">1</span>:<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>])) </span>
<span id="cb129-15"><a href="ch-python.html#cb129-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MySecondList[<span class="op">-</span><span class="dv">1</span>::<span class="op">-</span><span class="dv">1</span>]) <span class="co"># this creates another new range object</span></span>
<span id="cb129-16"><a href="ch-python.html#cb129-16" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">list</span>(MySecondList[<span class="op">-</span><span class="dv">1</span>::<span class="op">-</span><span class="dv">1</span>])) <span class="co"># print the whole list backwards</span></span>
<span id="cb129-17"><a href="ch-python.html#cb129-17" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MySecondList[::<span class="dv">2</span>]) <span class="co"># create another new range object</span></span>
<span id="cb129-18"><a href="ch-python.html#cb129-18" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">list</span>(MySecondList[::<span class="dv">2</span>])) <span class="co"># print every other element </span></span></code></pre></div>
<hr />
<p>In Python, elements in a list do not need to be the same type. You can mix integers, floats, strings, lists, etc.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-677" class="example"><strong>Example A.3  </strong></span>In this example we see a list of several items that have different data types: float, integer, string, and complex. Note that the imaginary number <span class="math inline">\(i\)</span> is represented by <span class="math inline">\(1j\)</span> in Python. This is common in many scientific disciplines and is just another thing that we’ll need to get used to in Python. (For example, <span class="math inline">\(j\)</span> is commonly used as the symbol for the imaginary unit <span class="math inline">\(\sqrt{-1}\)</span> ) in electical engineering since <span class="math inline">\(i\)</span> is the symbol commonly used for electric current, and using <span class="math inline">\(i\)</span> for both would be problematic).
</div>
<div class="sourceCode" id="cb130"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb130-1"><a href="ch-python.html#cb130-1" aria-hidden="true" tabindex="-1"></a>MixedList <span class="op">=</span> [<span class="fl">1.0</span>, <span class="dv">7</span>, <span class="st">&#39;Bob&#39;</span>, <span class="dv">1</span><span class="op">-</span><span class="ot">1j</span>]</span>
<span id="cb130-2"><a href="ch-python.html#cb130-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MixedList)</span>
<span id="cb130-3"><a href="ch-python.html#cb130-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(MixedList[<span class="dv">0</span>]))</span>
<span id="cb130-4"><a href="ch-python.html#cb130-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(MixedList[<span class="dv">1</span>]))</span>
<span id="cb130-5"><a href="ch-python.html#cb130-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(MixedList[<span class="dv">2</span>]))</span>
<span id="cb130-6"><a href="ch-python.html#cb130-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">type</span>(MixedList[<span class="dv">3</span>])) </span>
<span id="cb130-7"><a href="ch-python.html#cb130-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that we use 1j for the imaginary number &quot;i&quot;.</span></span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-679" class="exercise"><strong>Exercise A.6  </strong></span>In this exercise you will put your new list skills into practice.</p>
<ol style="list-style-type: lower-alpha">
<li>Create the list of the first several Fibonacci numbers:
<span class="math display">\[1, 1, 2, 3, 5, 8, 13, 21, 34, 55, 89.\]</span></li>
<li>Print the first four elements of the list.</li>
<li>Print every third element of the list starting from the first.</li>
<li>Print the last element of the list.</li>
<li>Print the list in reverse order.</li>
<li>Print the list starting at the last element and counting backward by every other element.</li>
</ol>
</div>
<hr />
</div>
<div id="list-operations" class="section level3" number="7.4.3">
<h3><span class="header-section-number">A.4.3</span> List Operations</h3>
<p>Python is awesome about allowing you to do things like appending items to lists, removing items from lists, and inserting items into lists. Note in all of the examples below that we are using the code<br />
<code>variable.command</code><br />
where you put the variable name, a dot, and the thing that you would like to do to that variable. For example, <code>MyList.append(7)</code> will append the number 7 to the list <code>MyList</code>. This is a common programming feature in Python and we’ll use it often.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-680" class="example"><strong>Example A.4  </strong></span>The <code>.append</code> command can be used to append an element to the end of a list.
</div>
<div class="sourceCode" id="cb131"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb131-1"><a href="ch-python.html#cb131-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb131-2"><a href="ch-python.html#cb131-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span>
<span id="cb131-3"><a href="ch-python.html#cb131-3" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="st">&#39;a&#39;</span>) <span class="co"># append the string &#39;a&#39; to the end of the list</span></span>
<span id="cb131-4"><a href="ch-python.html#cb131-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span>
<span id="cb131-5"><a href="ch-python.html#cb131-5" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="st">&#39;a&#39;</span>) <span class="co"># do it again ... just for fun</span></span>
<span id="cb131-6"><a href="ch-python.html#cb131-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span>
<span id="cb131-7"><a href="ch-python.html#cb131-7" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="dv">15</span>) <span class="co"># append the number 15 to the end of the list</span></span>
<span id="cb131-8"><a href="ch-python.html#cb131-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-682" class="example"><strong>Example A.5  </strong></span>The <code>.remove</code> command can be used to remove an element from a list.
</div>
<div class="sourceCode" id="cb132"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb132-1"><a href="ch-python.html#cb132-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb132-2"><a href="ch-python.html#cb132-2" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="st">&#39;a&#39;</span>) <span class="co"># append the string &#39;a&#39; to the end of the list</span></span>
<span id="cb132-3"><a href="ch-python.html#cb132-3" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="st">&#39;a&#39;</span>) <span class="co"># do it again ... just for fun</span></span>
<span id="cb132-4"><a href="ch-python.html#cb132-4" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="dv">15</span>) <span class="co"># append the number 15 to the end of the list</span></span>
<span id="cb132-5"><a href="ch-python.html#cb132-5" aria-hidden="true" tabindex="-1"></a>MyList.remove(<span class="st">&#39;a&#39;</span>) <span class="co"># remove the first instance of `a` from the list</span></span>
<span id="cb132-6"><a href="ch-python.html#cb132-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span>
<span id="cb132-7"><a href="ch-python.html#cb132-7" aria-hidden="true" tabindex="-1"></a>MyList.remove(<span class="dv">3</span>) <span class="co"># now let&#39;s remove the 3</span></span>
<span id="cb132-8"><a href="ch-python.html#cb132-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-684" class="example"><strong>Example A.6  </strong></span>The <code>.insert</code> command can be used to insert an element at a location in a list.
</div>
<div class="sourceCode" id="cb133"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb133-1"><a href="ch-python.html#cb133-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>]</span>
<span id="cb133-2"><a href="ch-python.html#cb133-2" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="st">&#39;a&#39;</span>) <span class="co"># append the string &#39;a&#39; to the end of the list</span></span>
<span id="cb133-3"><a href="ch-python.html#cb133-3" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="st">&#39;a&#39;</span>) <span class="co"># do it again ... just for fun</span></span>
<span id="cb133-4"><a href="ch-python.html#cb133-4" aria-hidden="true" tabindex="-1"></a>MyList.append(<span class="dv">15</span>) <span class="co"># append the number 15 to the end of the list</span></span>
<span id="cb133-5"><a href="ch-python.html#cb133-5" aria-hidden="true" tabindex="-1"></a>MyList.remove(<span class="st">&#39;a&#39;</span>) <span class="co"># remove the first instance `a` from the list</span></span>
<span id="cb133-6"><a href="ch-python.html#cb133-6" aria-hidden="true" tabindex="-1"></a>MyList.remove(<span class="dv">3</span>) <span class="co"># now let&#39;s remove the 3</span></span>
<span id="cb133-7"><a href="ch-python.html#cb133-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span>
<span id="cb133-8"><a href="ch-python.html#cb133-8" aria-hidden="true" tabindex="-1"></a>MyList.insert(<span class="dv">0</span>,<span class="st">&#39;A&#39;</span>) <span class="co"># insert the letter `A` at the 0-indexed spot</span></span>
<span id="cb133-9"><a href="ch-python.html#cb133-9" aria-hidden="true" tabindex="-1"></a><span class="co"># insert the letter `B` at the spot with index 3 </span></span>
<span id="cb133-10"><a href="ch-python.html#cb133-10" aria-hidden="true" tabindex="-1"></a>MyList.insert(<span class="dv">3</span>,<span class="st">&#39;B&#39;</span>) </span>
<span id="cb133-11"><a href="ch-python.html#cb133-11" aria-hidden="true" tabindex="-1"></a><span class="co"># remember that index 3 means the fourth spot in the list</span></span>
<span id="cb133-12"><a href="ch-python.html#cb133-12" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(MyList)</span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-686" class="exercise"><strong>Exercise A.7  </strong></span>In this exercise you will go a bit further with your list operation skills.</p>
<ol style="list-style-type: lower-alpha">
<li>Create the list of the first several Lucas Numbers: <span class="math inline">\(1,3,4,7,11,18,29,47.\)</span></li>
<li>Add the next three Lucas Numbers to the end of the list.</li>
<li>Remove the number 3 from the list.</li>
<li>Insert the 3 back into the list in the correct spot.</li>
<li>Print the list in reverse order.</li>
<li>Do a few other list operations to this list and report your findings.</li>
</ol>
</div>
<hr />
</div>
<div id="tuples" class="section level3" number="7.4.4">
<h3><span class="header-section-number">A.4.4</span> Tuples</h3>
<p>In Python, a “tuple” is like an ordered pair (or order triple, or order quadruple, ...) in mathematics. We will occasionally see tuples in our work in numerical analysis so for now let’s just give a couple of code snippets showing how to store and read them.</p>
<p>We can define the tuple of numbers <span class="math inline">\((10,20)\)</span> in Python as follows.</p>
<div class="sourceCode" id="cb134"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb134-1"><a href="ch-python.html#cb134-1" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> <span class="dv">10</span>, <span class="dv">20</span> <span class="co"># notice that I don&#39;t need the parenthesis</span></span>
<span id="cb134-2"><a href="ch-python.html#cb134-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(point, <span class="bu">type</span>(point))</span></code></pre></div>
<p>We can also define a tuple with parenthesis if we like. Python doesn’t care.</p>
<div class="sourceCode" id="cb135"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb135-1"><a href="ch-python.html#cb135-1" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">20</span>) <span class="co"># now we define the tuple with parenthesis</span></span>
<span id="cb135-2"><a href="ch-python.html#cb135-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(point, <span class="bu">type</span>(point))</span></code></pre></div>
<p>We can then unpack the tuple into components if we wish.</p>
<div class="sourceCode" id="cb136"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb136-1"><a href="ch-python.html#cb136-1" aria-hidden="true" tabindex="-1"></a>point <span class="op">=</span> (<span class="dv">10</span>, <span class="dv">20</span>)</span>
<span id="cb136-2"><a href="ch-python.html#cb136-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> point</span>
<span id="cb136-3"><a href="ch-python.html#cb136-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;x = &quot;</span>, x)</span>
<span id="cb136-4"><a href="ch-python.html#cb136-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;y = &quot;</span>, y)</span></code></pre></div>
</div>
<div id="control-flow-loops-and-if-statements" class="section level3" number="7.4.5">
<h3><span class="header-section-number">A.4.5</span> Control Flow: Loops and If Statements</h3>
<p>Any time you’re doing some repetitive task with a programming language you should actually be using a loop. Just like in other programming languages we can do loops and conditional statements in very easy ways in Python. The thing to keep in mind is that the Python language is very white-space-dependent. This means that your indentations need to be correct in order for a loop to work. You could get away with sloppy indention in other languages but not so in Python. Also, in some languages (like R and Java) you need to wrap your loops in curly braces. Again, not so in Python.</p>
<p><strong>Caution:</strong> Be really careful of the white space in your code when you write loops.</p>
<div id="for-loops" class="section level4" number="7.4.5.1">
<h4><span class="header-section-number">A.4.5.1</span> <code>for</code> Loops</h4>
<p>A <code>for</code> loop is designed to do a task a certain number of times and then stop. This is a great tool for automating repetitive tasks, but it also nice numerically for building sequences, summing series, or just checking lots of examples. The following are several examples of Python for loops. Take careful note of the syntax for a for loop as it is the same as for other loops and conditional statements:</p>
<ul>
<li>a control statement,</li>
<li>a colon, a new line,</li>
<li>indent four spaces,</li>
<li>some programming statements</li>
</ul>
<p>When you are done with the loop just back out of the indention. There is no need for an <code>end</code> command or a curly brace. All of the control statements in Python are white-space-dependent.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-690" class="example"><strong>Example A.7  </strong></span>Print the first 6 perfect square.
</div>
<div class="sourceCode" id="cb137"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb137-1"><a href="ch-python.html#cb137-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>,<span class="dv">5</span>,<span class="dv">6</span>]:</span>
<span id="cb137-2"><a href="ch-python.html#cb137-2" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x<span class="op">**</span><span class="dv">2</span>)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-692" class="example"><strong>Example A.8  </strong></span>Print the names in a list.
</div>
<div class="sourceCode" id="cb138"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb138-1"><a href="ch-python.html#cb138-1" aria-hidden="true" tabindex="-1"></a>NamesList <span class="op">=</span> [<span class="st">&#39;Alice&#39;</span>,<span class="st">&#39;Billy&#39;</span>,<span class="st">&#39;Charlie&#39;</span>,<span class="st">&#39;Dom&#39;</span>,<span class="st">&#39;Enrique&#39;</span>,<span class="st">&#39;Francisco&#39;</span>]</span>
<span id="cb138-2"><a href="ch-python.html#cb138-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> name <span class="kw">in</span> NamesList:</span>
<span id="cb138-3"><a href="ch-python.html#cb138-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(name)</span></code></pre></div>
<hr />
<p>In Python you can use a more compact notation for <code>for</code> loops sometimes. This takes a bit of getting used to, but is super slick!</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-694" class="example"><strong>Example A.9  </strong></span>Create a list of the perfect squares from 1 to 9.
</div>
<div class="sourceCode" id="cb139"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb139-1"><a href="ch-python.html#cb139-1" aria-hidden="true" tabindex="-1"></a><span class="co"># create a list of the perfect squares from 1 to 9</span></span>
<span id="cb139-2"><a href="ch-python.html#cb139-2" aria-hidden="true" tabindex="-1"></a>CoolList <span class="op">=</span> [x<span class="op">**</span><span class="dv">2</span> <span class="cf">for</span> x <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,<span class="dv">10</span>)]</span>
<span id="cb139-3"><a href="ch-python.html#cb139-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(CoolList)</span>
<span id="cb139-4"><a href="ch-python.html#cb139-4" aria-hidden="true" tabindex="-1"></a><span class="co"># Then print the sum of this list</span></span>
<span id="cb139-5"><a href="ch-python.html#cb139-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The sum of the first 9 perfect squares is&quot;</span>,<span class="bu">sum</span>(CoolList))</span></code></pre></div>
<hr />
<p><code>for</code> loops can also be used to build recursive sequences as can be seen in the next couple of examples.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-696" class="example"><strong>Example A.10  </strong></span>In the following code we write a for loop that outputs a list of the first 7 iterations of the sequence <span class="math inline">\(x_{n+1}=-0.5x_n+1\)</span> starting with <span class="math inline">\(x_0=3\)</span>. Notice that we’re using the command <code>x.append</code> instead of <span class="math inline">\(x[n+1]\)</span> to append the new term to the list. This allows us to grow the length of the list dynamically as the loop progresses.
</div>
<div class="sourceCode" id="cb140"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb140-1"><a href="ch-python.html#cb140-1" aria-hidden="true" tabindex="-1"></a>x<span class="op">=</span>[<span class="fl">3.0</span>]</span>
<span id="cb140-2"><a href="ch-python.html#cb140-2" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">7</span>):</span>
<span id="cb140-3"><a href="ch-python.html#cb140-3" aria-hidden="true" tabindex="-1"></a>    x.append(<span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x[n] <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb140-4"><a href="ch-python.html#cb140-4" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x) <span class="co"># print the whole list x at each step of the loop</span></span></code></pre></div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-698" class="example"><strong>Example A.11  </strong></span>As an alternative to the code from the previous example we can pre-allocate the memory in an array of zeros. This is done with the clever code <code>x = [0] * 10</code>. Literally multiplying a list by some number, like 10, says to repeat that list 10 times.</p>
Now we’ll build the sequence with pre-allocated memory.
</div>
<div class="sourceCode" id="cb141"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb141-1"><a href="ch-python.html#cb141-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="dv">0</span>] <span class="op">*</span> <span class="dv">7</span></span>
<span id="cb141-2"><a href="ch-python.html#cb141-2" aria-hidden="true" tabindex="-1"></a>x[<span class="dv">0</span>] <span class="op">=</span> <span class="fl">3.0</span></span>
<span id="cb141-3"><a href="ch-python.html#cb141-3" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">6</span>):</span>
<span id="cb141-4"><a href="ch-python.html#cb141-4" aria-hidden="true" tabindex="-1"></a>    x[n<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> <span class="op">-</span><span class="fl">0.5</span><span class="op">*</span>x[n]<span class="op">+</span><span class="dv">1</span></span>
<span id="cb141-5"><a href="ch-python.html#cb141-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x) <span class="co"># This print statement shows x at each iteration</span></span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-700" class="exercise"><strong>Exercise A.8  </strong></span>We want to sum the first 100 perfect cubes. Let’s do this in two ways.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Start off a variable called Total at 0 and write a <code>for</code> loop that adds the next perfect cube to the running total.</p></li>
<li><p>Write a <code>for</code> loop that builds the sequence of the first 100 perfect cubes. After the list has been built find the sum with the sum command.</p></li>
</ol>
<p>The answer is: 25,502,500 so check your work.</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-701" class="exercise"><strong>Exercise A.9  </strong></span>Write a <code>for</code> loop that builds the first 20 terms of the sequence <span class="math inline">\(x_{n+1}=1-x_n^2\)</span> with <span class="math inline">\(x_0=0.1\)</span>. Pre-allocate enough memory in your list and then fill it with the terms of the sequence. Only print the list after all of the computations have been completed.
</div>
<hr />
</div>
<div id="while-loops" class="section level4" number="7.4.5.2">
<h4><span class="header-section-number">A.4.5.2</span> While Loops</h4>
<p>A <code>while</code> loop repeats some task (or sequence of tasks) while a logical condition is true. It stops when the logical condition turns from true to false. The structure in Python is the same as with <code>for</code> loops.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-702" class="example"><strong>Example A.12  </strong></span>Print the numbers 0 through 4 and then the word “done.” We’ll do this by starting a counter variable, <code>i</code>, at 0 and increment it every time we pass through the loop.
</div>
<div class="sourceCode" id="cb142"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb142-1"><a href="ch-python.html#cb142-1" aria-hidden="true" tabindex="-1"></a>i <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb142-2"><a href="ch-python.html#cb142-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> i <span class="op">&lt;</span> <span class="dv">5</span>:</span>
<span id="cb142-3"><a href="ch-python.html#cb142-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(i)</span>
<span id="cb142-4"><a href="ch-python.html#cb142-4" aria-hidden="true" tabindex="-1"></a>    i <span class="op">+=</span> <span class="dv">1</span> <span class="co"># increment the counter</span></span>
<span id="cb142-5"><a href="ch-python.html#cb142-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;done&quot;</span>)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-704" class="example"><strong>Example A.13  </strong></span>Now let’s use a while loop to build the sequence of Fibonacci numbers and stop when the newest number in the sequence is greater than 1000. Notice that we want to keep looping until the condition that the last term is greater than 1000 – this is the perfect task for a <code>while</code> loop, instead of a <code>for</code> loop, since we don’t know how many steps it will take before we start the task
</div>
<div class="sourceCode" id="cb143"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb143-1"><a href="ch-python.html#cb143-1" aria-hidden="true" tabindex="-1"></a>Fib <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">1</span>]</span>
<span id="cb143-2"><a href="ch-python.html#cb143-2" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> Fib[<span class="op">-</span><span class="dv">1</span>] <span class="op">&lt;=</span> <span class="dv">1000</span>:</span>
<span id="cb143-3"><a href="ch-python.html#cb143-3" aria-hidden="true" tabindex="-1"></a>    Fib.append(Fib[<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> Fib[<span class="op">-</span><span class="dv">2</span>])</span>
<span id="cb143-4"><a href="ch-python.html#cb143-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The last few terms in the list are:</span><span class="ch">\n</span><span class="st">&quot;</span>,Fib[<span class="op">-</span><span class="dv">3</span>:])</span></code></pre></div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-706" class="exercise"><strong>Exercise A.10  </strong></span>Write a <code>while</code> loop that sums the terms in the Fibonacci sequence until
the sum is larger than 1000
</div>
<hr />
</div>
<div id="if-statements" class="section level4" number="7.4.5.3">
<h4><span class="header-section-number">A.4.5.3</span> If Statements</h4>
<p>Conditional (<code>if</code>) statements allow you to run a piece of code only under certain conditions. This is handy when you have different tasks to perform under different conditions.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-707" class="example"><strong>Example A.14  </strong></span>Let’s look at a simple example of an <code>if</code> statement in Python.
</div>
<div class="sourceCode" id="cb144"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb144-1"><a href="ch-python.html#cb144-1" aria-hidden="true" tabindex="-1"></a>Name <span class="op">=</span> <span class="st">&quot;Alice&quot;</span></span>
<span id="cb144-2"><a href="ch-python.html#cb144-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Name <span class="op">==</span> <span class="st">&quot;Alice&quot;</span>:</span>
<span id="cb144-3"><a href="ch-python.html#cb144-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Hello, Alice.  Isn&#39;t it a lovely day to learn Python?&quot;</span>)</span>
<span id="cb144-4"><a href="ch-python.html#cb144-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb144-5"><a href="ch-python.html#cb144-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;You&#39;re not Alice.  Where is Alice?&quot;</span>)</span></code></pre></div>
<div class="sourceCode" id="cb145"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb145-1"><a href="ch-python.html#cb145-1" aria-hidden="true" tabindex="-1"></a>Name <span class="op">=</span> <span class="st">&quot;Billy&quot;</span></span>
<span id="cb145-2"><a href="ch-python.html#cb145-2" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> Name <span class="op">==</span> <span class="st">&quot;Alice&quot;</span>:</span>
<span id="cb145-3"><a href="ch-python.html#cb145-3" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;Hello, Alice.  Isn&#39;t it a lovely day to learn Python?&quot;</span>)</span>
<span id="cb145-4"><a href="ch-python.html#cb145-4" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb145-5"><a href="ch-python.html#cb145-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;You&#39;re not Alice.  Where is Alice?&quot;</span>)</span></code></pre></div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-710" class="example"><strong>Example A.15  </strong></span>For another example, if we get a random number between 0 and 1 we could have Python print a different message depending on whether it was above or below 0.5. Run the code below several times and you’ll see different results each time.</p>
Note: We had to import the <code>numpy</code> package to get the random number generator in Python. Don’t worry about that for now. We’ll talk about packages in a moment.
</div>
<div class="sourceCode" id="cb146"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb146-1"><a href="ch-python.html#cb146-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb146-2"><a href="ch-python.html#cb146-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.rand(<span class="dv">1</span>,<span class="dv">1</span>) <span class="co"># get a random 1x1 matrix using numpy</span></span>
<span id="cb146-3"><a href="ch-python.html#cb146-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x[<span class="dv">0</span>,<span class="dv">0</span>] <span class="co"># pull the entry from the first row and first column</span></span>
<span id="cb146-4"><a href="ch-python.html#cb146-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> x <span class="op">&lt;</span> <span class="fl">0.5</span>:</span>
<span id="cb146-5"><a href="ch-python.html#cb146-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x,<span class="st">&quot; is less than a half&quot;</span>)</span>
<span id="cb146-6"><a href="ch-python.html#cb146-6" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb146-7"><a href="ch-python.html#cb146-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x, <span class="st">&quot;is NOT less than a half&quot;</span>)</span></code></pre></div>
<p>(Take note that the output will change every time you run it)</p>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-712" class="example"><strong>Example A.16  </strong></span>In many programming tasks it is handy to have several different choices
between tasks instead of just two choices as in the previous examples.
This is a job for the <code>elif</code> command.</p>
This is the same code as last time except we will make the decision at
0.33 and 0.67
</div>
<div class="sourceCode" id="cb147"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb147-1"><a href="ch-python.html#cb147-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb147-2"><a href="ch-python.html#cb147-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.random.rand(<span class="dv">1</span>,<span class="dv">1</span>) <span class="co"># get a random 1x1 matrix using numpy</span></span>
<span id="cb147-3"><a href="ch-python.html#cb147-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> x[<span class="dv">0</span>,<span class="dv">0</span>] <span class="co"># pull the entry from the first row and first column</span></span>
<span id="cb147-4"><a href="ch-python.html#cb147-4" aria-hidden="true" tabindex="-1"></a><span class="cf">if</span> x <span class="op">&lt;</span> <span class="fl">0.33</span>:</span>
<span id="cb147-5"><a href="ch-python.html#cb147-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x,<span class="st">&quot; &lt; 1/3&quot;</span>)</span>
<span id="cb147-6"><a href="ch-python.html#cb147-6" aria-hidden="true" tabindex="-1"></a><span class="cf">elif</span> x <span class="op">&lt;</span> <span class="fl">0.67</span>:</span>
<span id="cb147-7"><a href="ch-python.html#cb147-7" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(<span class="st">&quot;1/3 &lt;= &quot;</span>,x,<span class="st">&quot;&lt; 2/3&quot;</span>)</span>
<span id="cb147-8"><a href="ch-python.html#cb147-8" aria-hidden="true" tabindex="-1"></a><span class="cf">else</span>:</span>
<span id="cb147-9"><a href="ch-python.html#cb147-9" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x, <span class="st">&quot;&gt;= 2/3&quot;</span>)</span></code></pre></div>
<p>(Take note that the output will change every time you run it)</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-714" class="exercise"><strong>Exercise A.11  </strong></span>Write code to give the Collatz Sequence
<span class="math display">\[x_{n+1} = \left\{ \begin{array}{ll} x_n / 2, &amp; \text{$x_n$ is even} \\ 3 x_n + 1, &amp; \text{otherwise} \end{array} \right.\]</span>
starting with a positive integer of your choosing. The sequence will converge<a href="#fn14" class="footnote-ref" id="fnref14"><sup>14</sup></a> to 1 so your code should stop when the sequence reaches 1.
</div>
<hr />
</div>
</div>
<div id="functions" class="section level3" number="7.4.6">
<h3><span class="header-section-number">A.4.6</span> Functions</h3>
<p>Mathematicians and programmers talk about functions in very similar ways, but they aren’t exactly the same. When we say “function” in a programming sense we are talking about a chunk of code that you can pass parameters and expect an output of some sort. This is not unlike the mathematician’s version, but unlike a mathematical function we can have multiple outputs for a programmatic function. For example, in the mathematical function <span class="math inline">\(f(x) = x^2 + 3\)</span> we pass a real number in as an input and get a real number out as output. In a programming language, on the other hand, you might send in a function and a few real numbers and output a plot of the function along with the definite integral of the function between the real numbers. Notice that there can be multiple inputs and multiple outputs, and the none have to be the same type of object. In this sense, a programmer’s definition of a function is a bit more flexible than that of a mathematician’s.</p>
<p>In Python, to define a function we start with <code>def</code>, followed by the function’s name, any input variables in parenthesis, and a colon. The indented code after the colon is what defines the actions of the function.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-715" class="example"><strong>Example A.17  </strong></span>The following code defines the polynomial <span class="math inline">\(f(x) = x^3 + 3x^2 + 3x + 1\)</span> and then evaluates the function at a point <span class="math inline">\(x=2.3\)</span>.
</div>
<div class="sourceCode" id="cb148"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb148-1"><a href="ch-python.html#cb148-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb148-2"><a href="ch-python.html#cb148-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">1</span>)</span>
<span id="cb148-3"><a href="ch-python.html#cb148-3" aria-hidden="true" tabindex="-1"></a>f(<span class="fl">2.3</span>)</span></code></pre></div>
<hr />
<p>Take careful note of several things in the previous example:</p>
<ul>
<li>To define the function we can not just type it like we would see it one paper. This is not how Python recognizes functions.<br />
</li>
<li>Once we have the function defined we can call upon it just like we would on paper.</li>
<li>We cannot pass symbols into this type of function. See the section on <code>sympy</code> in this chapter if you want to do symbolic computation.</li>
</ul>
<hr />

<div class="exercise">
<span id="exr:prime-gen" class="exercise"><strong>Exercise A.12  </strong></span>Define the function <span class="math inline">\(g(n) = n^2 + n + 41\)</span> as a Python function. Write a loop that gives the output for this function for integers from <span class="math inline">\(n=0\)</span> to <span class="math inline">\(n=39\)</span>. It is curious to note that each of these outputs is a prime number (check this on your own). Will the function produce a prime for <span class="math inline">\(n=40\)</span>? For <span class="math inline">\(n=41\)</span>?
</div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-717" class="example"><strong>Example A.18  </strong></span>One cool thing that you can do with Python functions is call them recursively. That is, you can call the same function from within the function itself. This turns out to be really handy in several mathematical situations.</p>
Now let’s define a function for the factorial. This function is naturally going to be recursive in the sense that it calls on itself!
</div>
<div class="sourceCode" id="cb149"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb149-1"><a href="ch-python.html#cb149-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> Fact(n):</span>
<span id="cb149-2"><a href="ch-python.html#cb149-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> n<span class="op">==</span><span class="dv">0</span>:</span>
<span id="cb149-3"><a href="ch-python.html#cb149-3" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(<span class="dv">1</span>)</span>
<span id="cb149-4"><a href="ch-python.html#cb149-4" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb149-5"><a href="ch-python.html#cb149-5" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>( n<span class="op">*</span>Fact(n<span class="op">-</span><span class="dv">1</span>) ) </span>
<span id="cb149-6"><a href="ch-python.html#cb149-6" aria-hidden="true" tabindex="-1"></a>        <span class="co"># Note: we are calling the function recursively.</span></span></code></pre></div>
<p>When you run this code there will be no output. You have just defined the function so you can use it later. So let’s use it to make a list of the first several factorials. Note the use of a for loop in the following code.</p>
<div class="sourceCode" id="cb150"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb150-1"><a href="ch-python.html#cb150-1" aria-hidden="true" tabindex="-1"></a>FactList <span class="op">=</span> [Fact(n) <span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>)]</span>
<span id="cb150-2"><a href="ch-python.html#cb150-2" aria-hidden="true" tabindex="-1"></a>FactList</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-721" class="example"><strong>Example A.19  </strong></span>For this next example let’s define the sequence
<span class="math display">\[x_{n+1} = \left\{ \begin{array}{ll} 2x_n, &amp; x_n \in [0,0.5] \\ 2x_n - 1, &amp; x_n \in (0.5,1] \end{array} \right.\]</span>
as a function and then build a loop to find the first several iterates of the sequence starting at any real number between 0 and 1.
</div>
<div class="sourceCode" id="cb151"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb151-1"><a href="ch-python.html#cb151-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Define the function</span></span>
<span id="cb151-2"><a href="ch-python.html#cb151-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> MySeq(xn):</span>
<span id="cb151-3"><a href="ch-python.html#cb151-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">if</span> xn <span class="op">&lt;=</span> <span class="fl">0.5</span>:</span>
<span id="cb151-4"><a href="ch-python.html#cb151-4" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(<span class="dv">2</span><span class="op">*</span>xn)</span>
<span id="cb151-5"><a href="ch-python.html#cb151-5" aria-hidden="true" tabindex="-1"></a>    <span class="cf">else</span>:</span>
<span id="cb151-6"><a href="ch-python.html#cb151-6" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span>(<span class="dv">2</span><span class="op">*</span>xn<span class="op">-</span><span class="dv">1</span>)</span>
<span id="cb151-7"><a href="ch-python.html#cb151-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Now build a sequence with this function</span></span>
<span id="cb151-8"><a href="ch-python.html#cb151-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">0.125</span>] <span class="co"># arbitrary starting point</span></span>
<span id="cb151-9"><a href="ch-python.html#cb151-9" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">5</span>): <span class="co"># Let&#39;s only build the first 5 terms</span></span>
<span id="cb151-10"><a href="ch-python.html#cb151-10" aria-hidden="true" tabindex="-1"></a>    x.append(MySeq(x[<span class="op">-</span><span class="dv">1</span>]))</span>
<span id="cb151-11"><a href="ch-python.html#cb151-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code></pre></div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-723" class="example"><strong>Example A.20  </strong></span>A fun way to approximate the square root of two is to start with any positive real number and iterate over the sequence
<span class="math display">\[x_{n+1} = \frac{1}{2} x_n + \frac{1}{x_n}\]</span>
until we are within any tolerance we like of the square root of <span class="math inline">\(2\)</span>. Write code that defines the sequence as a function and then iterates in a while loop until we are within <span class="math inline">\(10^{-8}\)</span> of the square root of 2.</p>
Hint: Import the <code>math</code> package so that you get the square root. More about packages in the next section.
</div>
<div class="sourceCode" id="cb152"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb152-1"><a href="ch-python.html#cb152-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> sqrt</span>
<span id="cb152-2"><a href="ch-python.html#cb152-2" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb152-3"><a href="ch-python.html#cb152-3" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(<span class="fl">0.5</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">1</span><span class="op">/</span>x)</span>
<span id="cb152-4"><a href="ch-python.html#cb152-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="fl">1.1</span> <span class="co"># arbitrary starting point</span></span>
<span id="cb152-5"><a href="ch-python.html#cb152-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;approximation </span><span class="ch">\t\t</span><span class="st"> exact </span><span class="ch">\t\t</span><span class="st"> abs error&quot;</span>)</span>
<span id="cb152-6"><a href="ch-python.html#cb152-6" aria-hidden="true" tabindex="-1"></a><span class="cf">while</span> <span class="bu">abs</span>(x<span class="op">-</span>sqrt(<span class="dv">2</span>)) <span class="op">&gt;</span> <span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="dv">8</span>):</span>
<span id="cb152-7"><a href="ch-python.html#cb152-7" aria-hidden="true" tabindex="-1"></a>    x <span class="op">=</span> f(x)</span>
<span id="cb152-8"><a href="ch-python.html#cb152-8" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(x, sqrt(<span class="dv">2</span>), <span class="bu">abs</span>(x <span class="op">-</span> sqrt(<span class="dv">2</span>)))</span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:babylonian-sqrt" class="exercise"><strong>Exercise A.13  </strong></span>The previous example is a special case of the Babylonian Algorithm for calculating square roots. If you want the square root of <span class="math inline">\(S\)</span> then iterate the sequence <span class="math display">\[x_{n+1} = \frac{1}{2} \left( x_n + \frac{S}{x_n} \right)\]</span> until you are within an appropriate tolerance.</p>
Modify the code given in the previous example to give a list of approximations of the square roots of the natural numbers 2 through 20, each to within <span class="math inline">\(10^{-8}\)</span>. This problem will require that you build a function, write a ‘for’ loop (for the integers 2-20), and write a ‘while’ loop inside your ‘for’ loop to do the iterations.
</div>
<hr />
</div>
<div id="lambda-functions" class="section level3" number="7.4.7">
<h3><span class="header-section-number">A.4.7</span> Lambda Functions</h3>
<p>Using <code>def</code> to define a function as in the previous subsection is really nice when you have a function that is complicated or requires some bit of code to evaluate. However, in the case of mathematical functions we have a convenient alternative: <code>lambda</code> Functions.</p>
<p>The basic idea of a <code>lambda</code> Function is that we just want to state what the variable is and what the rule is for evaluating the function. This is the most like the way that we write mathematical functions. For example, let’s define the mathematical function <span class="math inline">\(f(x) = x^2+3\)</span> in two different ways.</p>
<ul>
<li>As a Python function with <code>def</code>:</li>
</ul>
<div class="sourceCode" id="cb153"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb153-1"><a href="ch-python.html#cb153-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> f(x):</span>
<span id="cb153-2"><a href="ch-python.html#cb153-2" aria-hidden="true" tabindex="-1"></a>    <span class="cf">return</span>(x<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span>)</span></code></pre></div>
<ul>
<li>As a <code>lambda</code> function:</li>
</ul>
<div class="sourceCode" id="cb154"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb154-1"><a href="ch-python.html#cb154-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span></span></code></pre></div>
<p>You can see that in the Lambda Function we are explicitly stating the name of the variable immediately after the word <code>lambda</code>, then we put a colon, and then the function definition.</p>
<p>Now if we want to evaluate the function at a point, say <span class="math inline">\(x=1.5\)</span>, then we can write code just like we would mathematically: <span class="math inline">\(f(1.5)\)</span></p>
<div class="sourceCode" id="cb155"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb155-1"><a href="ch-python.html#cb155-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span><span class="op">+</span><span class="dv">3</span></span>
<span id="cb155-2"><a href="ch-python.html#cb155-2" aria-hidden="true" tabindex="-1"></a>f(<span class="fl">1.5</span>) <span class="co"># evaluate the function at x=1.5</span></span></code></pre></div>
<p>where the result is exactly the floating point number we were interested in.</p>
<p>The distinct mathematical advantage for using <code>lambda</code> functions is that the code for setting up a Lambda Function is about as close as we’re going to get to a mathematically defined function as we would write it on paper, but the code for evaluating a <code>lambda</code> Function is <em>exactly</em> what we would write on paper. Additionally, there is less coding overhead than for defining a function with the command.</p>
<p>We can also define Lambda Functions of several variables. For example, if we want to define the mathematical function <span class="math inline">\(f(x,y) = x^2 + xy + y^3\)</span> we could write the code</p>
<div class="sourceCode" id="cb156"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb156-1"><a href="ch-python.html#cb156-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x, y: x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> x<span class="op">*</span>y <span class="op">+</span> y<span class="op">**</span><span class="dv">3</span></span></code></pre></div>
<p>If we wanted the value <span class="math inline">\(f(2,4)\)</span> we could now write the code <code>f(2,4)</code>.</p>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-730" class="example"><strong>Example A.21  </strong></span>You may recall Euler’s Method from your differential equations training. Euler’s Method will give a list of approximate values of the solution to a first order differential equation at given times.</p>
Consider the differential equation <span class="math inline">\(x&#39; = -0.25x + 2\)</span> with the initial condition <span class="math inline">\(x(0) = 1.1\)</span>. We can define the right-hand side of the differential equation as a <code>lambda</code> Function in our code so that we can call on it over and over again in our Euler’s Method solution. We’ll take 10 Euler steps starting at the proper initial condition. Pay particular attention to how we use the <code>lambda</code> function.
</div>
<div class="sourceCode" id="cb157"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb157-1"><a href="ch-python.html#cb157-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb157-2"><a href="ch-python.html#cb157-2" aria-hidden="true" tabindex="-1"></a>RightSide <span class="op">=</span> <span class="kw">lambda</span> x: <span class="op">-</span><span class="fl">0.25</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">2</span> <span class="co"># define the right-hand side</span></span>
<span id="cb157-3"><a href="ch-python.html#cb157-3" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="fl">0.125</span> <span class="co"># define the delta t in Euler&#39;s method</span></span>
<span id="cb157-4"><a href="ch-python.html#cb157-4" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> [<span class="dv">0</span>] <span class="co"># initial time</span></span>
<span id="cb157-5"><a href="ch-python.html#cb157-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> [<span class="fl">1.1</span>] <span class="co"># initial condition</span></span>
<span id="cb157-6"><a href="ch-python.html#cb157-6" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="dv">10</span>):</span>
<span id="cb157-7"><a href="ch-python.html#cb157-7" aria-hidden="true" tabindex="-1"></a>    t.append(t[n] <span class="op">+</span> dt) <span class="co"># increment the time</span></span>
<span id="cb157-8"><a href="ch-python.html#cb157-8" aria-hidden="true" tabindex="-1"></a>    x.append(y[n] <span class="op">+</span> dt<span class="op">*</span>RightSide(x[n])) <span class="co"># approx soln at next pt</span></span>
<span id="cb157-9"><a href="ch-python.html#cb157-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(t) <span class="co"># print the times</span></span>
<span id="cb157-10"><a href="ch-python.html#cb157-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.<span class="bu">round</span>(x,<span class="dv">2</span>)) </span>
<span id="cb157-11"><a href="ch-python.html#cb157-11" aria-hidden="true" tabindex="-1"></a><span class="co"># round the approx x values to 2 decimal places</span></span></code></pre></div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-732" class="exercise"><strong>Exercise A.14  </strong></span>Go back to Exercise <a href="ch-python.html#exr:prime-gen">A.12</a> and repeat this exercise using a <code>lambda</code> Function instead of a Python function.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-733" class="exercise"><strong>Exercise A.15  </strong></span>Go back to Exercise <a href="ch-python.html#exr:babylonian-sqrt">A.13</a> and repeat this exercise using a <code>lambda</code> function instead of a Python function.
</div>
<hr />
</div>
<div id="packages" class="section level3" number="7.4.8">
<h3><span class="header-section-number">A.4.8</span> Packages</h3>
<p>Unlike mathematical programming languages like MATLAB, Maple, or Mathematica, where every package is already installed and ready to use, Python allows you to only load the packages that you might need for a given task. There are several advantages to this along with a few disadvantages.</p>
<p><strong>Advantages:</strong></p>
<ol style="list-style-type: decimal">
<li><p>You can have the same function doing different things in different scenarios. For example, there could be a symbolic differentiation command and a numerical differentiation command coming from different packages that are used in different ways.</p></li>
<li><p>Housekeeping. It is highly advantageous to have a good understanding of where your functions come from. MATLAB, for example, uses the same name for multiple purposes with no indication of how it might behave depending on the inputs. With Python you can avoid that by only importing the appropriate packages for your current use.</p></li>
<li><p>Your code will be ultimately more readable (more on this later).</p></li>
</ol>
<p><strong>Disadvantages:</strong></p>
<ol style="list-style-type: decimal">
<li><p>It is often challenging to keep track of which function does which task when they have exactly the same name. For example, you could be working with the <code>sin()</code> function numerically from the <code>numpy</code> package or symbolically from the <code>sympy</code> package, and these functions will behave differently in Python - even though they are exactly the same mathematically.</p></li>
<li><p>You need to remember which functions live in which packages so that you can load the right ones. It is helpful to keep a list of commonly used packages and functions at least while you’re getting started.</p></li>
</ol>
<p>Let’s start with the <code>math</code> package.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-734" class="example"><strong>Example A.22  </strong></span>The code below imports the <code>math</code> package into your instance of Python
and calculates the cosine of <span class="math inline">\(\pi/4\)</span>.
</div>
<div class="sourceCode" id="cb158"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb158-1"><a href="ch-python.html#cb158-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb158-2"><a href="ch-python.html#cb158-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> math.cos(math.pi <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb158-3"><a href="ch-python.html#cb158-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code></pre></div>
<p>The answer, unsurprisingly, is the decimal form of <span class="math inline">\(\sqrt{2}/2\)</span>.</p>
<hr />
<p>You might already see a potential disadvantage to Python’s packages: there is now more typing involved! Let’s fix this. When you import a package you could just import all of the functions so they can be used by their proper names.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-736" class="example"><strong>Example A.23  </strong></span>Here we import the entire math package so we can use every one of the functions therein without having to use the <code>math</code> prefix.
</div>
<div class="sourceCode" id="cb159"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb159-1"><a href="ch-python.html#cb159-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> <span class="op">*</span> <span class="co"># read this as: from math import everything</span></span>
<span id="cb159-2"><a href="ch-python.html#cb159-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> cos(pi <span class="op">/</span> <span class="dv">4</span>)</span>
<span id="cb159-3"><a href="ch-python.html#cb159-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code></pre></div>
<p>The end result is exactly the same: the decimal form of <span class="math inline">\(\sqrt{2}/2\)</span>, but now we had less typing to do.</p>
<hr />
<p>Now you can freely use the functions that were imported from the math package. There is a disadvantage to this, however. What if we have two packages that import functions with the same name. For example, in the <code>math</code> package and in the <code>numpy</code> package there is a <code>cos()</code> function. In the next block of code we’ll import both <code>math</code> and <code>numpy</code>, but instead we will import them with shortened names so we can type things a bit faster.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-738" class="example"><strong>Example A.24  </strong></span>Here we import <code>math</code> and <code>numpy</code> under aliases so we can use the shortened aliases and not mix up which functions belong to which packages.
</div>
<div class="sourceCode" id="cb160"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb160-1"><a href="ch-python.html#cb160-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math <span class="im">as</span> ma</span>
<span id="cb160-2"><a href="ch-python.html#cb160-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb160-3"><a href="ch-python.html#cb160-3" aria-hidden="true" tabindex="-1"></a><span class="co"># use the math version of the cosine function</span></span>
<span id="cb160-4"><a href="ch-python.html#cb160-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> ma.cos( ma.pi <span class="op">/</span> <span class="dv">4</span>) </span>
<span id="cb160-5"><a href="ch-python.html#cb160-5" aria-hidden="true" tabindex="-1"></a><span class="co"># use the numpy version of the cosine function</span></span>
<span id="cb160-6"><a href="ch-python.html#cb160-6" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.cos( np.pi <span class="op">/</span> <span class="dv">4</span>) </span>
<span id="cb160-7"><a href="ch-python.html#cb160-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x, y)</span></code></pre></div>
<p>Both <code>x</code> and <code>y</code> in the code give the decimal approximation of <span class="math inline">\(\sqrt{2}/2\)</span>. This is clearly pretty redundant in this really simple case, but you should be able to see where you might want to use this and where you might run into troubles.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-740" class="example"><strong>Example A.25  </strong></span>(<strong>Contents of a Library</strong>) Once you have a package imported you can see what is inside of it using the <code>dir</code> command. The following block of code prints a list of all of the functions inside the <code>math</code> package.
</div>
<div class="sourceCode" id="cb161"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb161-1"><a href="ch-python.html#cb161-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> math</span>
<span id="cb161-2"><a href="ch-python.html#cb161-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="bu">dir</span>(math))</span></code></pre></div>
<hr />
<p>Of course, there will be times when you need help with a function. You can use the <code>help</code> command to view the help documentation for any function. For example, you can run the code <code>help(math.acos)</code> to get help on the arc cosine function from the <code>math</code> package.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-742" class="exercise"><strong>Exercise A.16  </strong></span>Import the math package, figure out how the <code>log</code> function works, and
write code to calculate the logarithm of the number 8.3 in base 10, base
2, base 16, and base <span class="math inline">\(e\)</span> (the natural logarithm).
</div>
<hr />
</div>
</div>
<div id="numerical-python-with-numpy" class="section level2" number="7.5">
<h2><span class="header-section-number">A.5</span> Numerical Python with <code>numpy</code></h2>
<p>The base implementation of Python includes the basic programming language, the tools to write loops, check conditions, build and manipulate lists, and all of the other things that we saw in the previous section. In this section we will explore the package <code>numpy</code> that contains optimized numerical routines for doing numerical computations in scientific computing.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-743" class="example"><strong>Example A.26  </strong></span>To start with let’s look at a really simple example. Say you have a list of real numbers and you want to take the sine every element in the list. If you just try to take the sine of the list you will get an error. Try it yourself.
</div>
<div class="sourceCode" id="cb162"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb162-1"><a href="ch-python.html#cb162-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi, sin</span>
<span id="cb162-2"><a href="ch-python.html#cb162-2" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">6</span>, pi<span class="op">/</span><span class="dv">4</span>, pi<span class="op">/</span><span class="dv">3</span>, pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">4</span>, <span class="dv">5</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span>, pi]</span>
<span id="cb162-3"><a href="ch-python.html#cb162-3" aria-hidden="true" tabindex="-1"></a>sin(MyList)</span></code></pre></div>
<p>You could get around this error using some of the tools from base Python, but none of them are very elegant from a programming perspective.</p>
<div class="sourceCode" id="cb163"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb163-1"><a href="ch-python.html#cb163-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi, sin</span>
<span id="cb163-2"><a href="ch-python.html#cb163-2" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">6</span>, pi<span class="op">/</span><span class="dv">4</span>, pi<span class="op">/</span><span class="dv">3</span>, pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">4</span>, <span class="dv">5</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span>, pi]</span>
<span id="cb163-3"><a href="ch-python.html#cb163-3" aria-hidden="true" tabindex="-1"></a>SineList <span class="op">=</span> [sin(n) <span class="cf">for</span> n <span class="kw">in</span> MyList]</span>
<span id="cb163-4"><a href="ch-python.html#cb163-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SineList)</span></code></pre></div>
<div class="sourceCode" id="cb164"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb164-1"><a href="ch-python.html#cb164-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> math <span class="im">import</span> pi, sin</span>
<span id="cb164-2"><a href="ch-python.html#cb164-2" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">0</span>,pi<span class="op">/</span><span class="dv">6</span>, pi<span class="op">/</span><span class="dv">4</span>, pi<span class="op">/</span><span class="dv">3</span>, pi<span class="op">/</span><span class="dv">2</span>, <span class="dv">2</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">3</span>, <span class="dv">3</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">4</span>, <span class="dv">5</span><span class="op">*</span>pi<span class="op">/</span><span class="dv">6</span>, pi]</span>
<span id="cb164-3"><a href="ch-python.html#cb164-3" aria-hidden="true" tabindex="-1"></a>SineList <span class="op">=</span> [ ]</span>
<span id="cb164-4"><a href="ch-python.html#cb164-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(MyList)):</span>
<span id="cb164-5"><a href="ch-python.html#cb164-5" aria-hidden="true" tabindex="-1"></a>    SineList.append( sin(MyList[n]) )</span>
<span id="cb164-6"><a href="ch-python.html#cb164-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(SineList)</span></code></pre></div>
<p>Perhaps more simply, say we wanted to square every number in a list. Just appending the code <code>**2</code> to the end of the list will fail!</p>
<div class="sourceCode" id="cb165"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb165-1"><a href="ch-python.html#cb165-1" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> [<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>]</span>
<span id="cb165-2"><a href="ch-python.html#cb165-2" aria-hidden="true" tabindex="-1"></a>MyList<span class="op">**</span><span class="dv">2</span> <span class="co"># This will produce an error</span></span></code></pre></div>
<p>If, instead, we define the list as a <code>numpy</code> array instead of a Python list then everything will work mathematically exactly the way that we intend.</p>
<div class="sourceCode" id="cb166"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb166-1"><a href="ch-python.html#cb166-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb166-2"><a href="ch-python.html#cb166-2" aria-hidden="true" tabindex="-1"></a>MyList <span class="op">=</span> np.array([<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>])</span>
<span id="cb166-3"><a href="ch-python.html#cb166-3" aria-hidden="true" tabindex="-1"></a>MyList<span class="op">**</span><span class="dv">2</span> <span class="co"># This will work as expected!  You should stop now and try to take the sine of a full list of numbers that are stored in a `numpy` array.</span></span></code></pre></div>
<hr />
<p>The package <code>numpy</code> is used in many (most) mathematical computations in numerical analysis using Python. It provides algorithms for matrix and vector arithmetic. Furthermore, it is optimized to be able to do these computations in the most efficient possible way (both in terms of memory and in terms of speed).</p>
<p>Typically when we import <code>numpy</code> we use <code>import numpy as np</code>. This is the standard way to name the <code>numpy</code> package. This means that we will have lots of function with the prefix “np” in order to call on the <code>numpy</code> commands. Let’s first see what is inside the package with the code <code>print(dir(np))</code> after importing <code>numpy</code> as <code>np</code>. A brief glimpse through the list reveals a huge wealth of mathematical functions that are optimized to work in the best possible way with the Python language. (We are intentionally not showing the output here since it is quite extensive, run it so you can see.)</p>
<div id="numpy-arrays-array-operations-and-matrix-operations" class="section level3" number="7.5.1">
<h3><span class="header-section-number">A.5.1</span> Numpy Arrays, Array Operations, and Matrix Operations</h3>
<p>In the previous section you worked with Python lists. As we pointed out, the shortcoming of Python lists is that they don’t behave well when we want to apply mathematical functions to the vector as a whole. The "numpy array", <code>np.array</code>, is essentially the same as a Python list with the notable exceptions that</p>
<ul>
<li>In a <code>numpy</code> array every entry is a floating point number</li>
<li>In a <code>numpy</code> array the memory usage is more efficient (mostly since Python is expecting data of all the same type)</li>
<li>With a <code>numpy</code> array there are ready-made functions that can act directly on the array as a matrix or a vector</li>
</ul>
<p>Let’s just look at a few examples using <code>numpy</code>. What we’re going to do is to define a matrix <span class="math inline">\(A\)</span> and vectors <span class="math inline">\(v\)</span> and <span class="math inline">\(w\)</span> as
<span class="math display">\[A = \begin{pmatrix} 1 &amp; 2 \\ 3 &amp; 4 \end{pmatrix}, \quad v = \begin{pmatrix} 5\\6 \end{pmatrix}
\quad \text{and} \quad w = v^T = \begin{pmatrix} 5 &amp; 6 \end{pmatrix}.\]</span>
Then we’ll do the following</p>
<ul>
<li>Get the size and shape of these arrays</li>
<li>Get individual elements, rows, and columns from these arrays</li>
<li>Treat these arrays as with linear algebra to
<ul>
<li>do element-wise multiplication</li>
<li>do matrix a vector products</li>
<li>do scalar multiplication</li>
<li>take the transpose of matrices</li>
<li>take the inverse of matrices</li>
</ul></li>
</ul>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-749" class="example"><strong>Example A.27  </strong></span>(<strong>numpy Matrices</strong>) The first thing to note is that a matrix is a list of lists (each row is a list).
</div>
<div class="sourceCode" id="cb167"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb167-1"><a href="ch-python.html#cb167-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb167-2"><a href="ch-python.html#cb167-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb167-3"><a href="ch-python.html#cb167-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The matrix A is:</span><span class="ch">\n</span><span class="st">&quot;</span>,A)</span>
<span id="cb167-4"><a href="ch-python.html#cb167-4" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([[<span class="dv">5</span>],[<span class="dv">6</span>]]) <span class="co"># this creates a column vector</span></span>
<span id="cb167-5"><a href="ch-python.html#cb167-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The vector v is:</span><span class="ch">\n</span><span class="st">&quot;</span>,v)</span>
<span id="cb167-6"><a href="ch-python.html#cb167-6" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.array([<span class="dv">5</span>,<span class="dv">6</span>]) <span class="co"># this creates a row vector</span></span>
<span id="cb167-7"><a href="ch-python.html#cb167-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The vector w is:</span><span class="ch">\n</span><span class="st">&quot;</span>,w)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-751" class="example"><strong>Example A.28  </strong></span>(<strong>variable.shape</strong>) The <code>variable.shape</code> command can be used to give the shape of a <code>numpy</code> array. Notice that the output is a tuple showing the size <code>(rows, columns)</code>. Also notice that the row vector doesn’t give (1,2) as expected. Instead it just gives (2,).
</div>
<div class="sourceCode" id="cb168"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb168-1"><a href="ch-python.html#cb168-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb168-2"><a href="ch-python.html#cb168-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb168-3"><a href="ch-python.html#cb168-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A.shape) <span class="co"># Shape of the matrix A</span></span>
<span id="cb168-4"><a href="ch-python.html#cb168-4" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([[<span class="dv">5</span>],[<span class="dv">6</span>]])</span>
<span id="cb168-5"><a href="ch-python.html#cb168-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(v.shape) <span class="co"># Shape of the column vector v</span></span>
<span id="cb168-6"><a href="ch-python.html#cb168-6" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.array([<span class="dv">5</span>,<span class="dv">6</span>])</span>
<span id="cb168-7"><a href="ch-python.html#cb168-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(w.shape) <span class="co"># Shape of the row vector w</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-753" class="example"><strong>Example A.29  </strong></span>(<strong>variable.size</strong>) The <code>variable.size</code> command can be used to give the size of a <code>numpy</code> array. The size of a matrix or vector will be the total number of elements in the array. You can think of this as the product of the values in the tuple coming from the shape command.
</div>
<div class="sourceCode" id="cb169"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb169-1"><a href="ch-python.html#cb169-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb169-2"><a href="ch-python.html#cb169-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb169-3"><a href="ch-python.html#cb169-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([[<span class="dv">5</span>],[<span class="dv">6</span>]])</span>
<span id="cb169-4"><a href="ch-python.html#cb169-4" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.array([<span class="dv">5</span>,<span class="dv">6</span>])</span>
<span id="cb169-5"><a href="ch-python.html#cb169-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A.size) <span class="co"># Size (number of elements) of A</span></span>
<span id="cb169-6"><a href="ch-python.html#cb169-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(v.size) <span class="co"># Size (number of elements) of v</span></span>
<span id="cb169-7"><a href="ch-python.html#cb169-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(w.size) <span class="co"># Size (number of elements) of w</span></span></code></pre></div>
<hr />
<p>Reading individual elements from a <code>numpy</code> array is the same, essentially, as reading elements from a Python list. We will use square brackets to get the row and column. Remember that the indexing all starts from 0, not 1!</p>

<div class="example">
<span id="exm:unnamed-chunk-754" class="example"><strong>Example A.30  </strong></span>Let’s read the top left and bottom right entries of the matrix <span class="math inline">\(A\)</span>.
</div>
<div class="sourceCode" id="cb170"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb170-1"><a href="ch-python.html#cb170-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb170-2"><a href="ch-python.html#cb170-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb170-3"><a href="ch-python.html#cb170-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[<span class="dv">0</span>,<span class="dv">0</span>]) <span class="co"># top left</span></span>
<span id="cb170-4"><a href="ch-python.html#cb170-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[<span class="dv">1</span>,<span class="dv">1</span>]) <span class="co"># bottom right</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-756" class="example"><strong>Example A.31  </strong></span>Let’s read the first row from that matrix <span class="math inline">\(A\)</span>.
</div>
<div class="sourceCode" id="cb171"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb171-1"><a href="ch-python.html#cb171-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb171-2"><a href="ch-python.html#cb171-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb171-3"><a href="ch-python.html#cb171-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[<span class="dv">0</span>,:])</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-758" class="example"><strong>Example A.32  </strong></span>Let’s read the second column from the matrix <span class="math inline">\(A\)</span>.
</div>
<div class="sourceCode" id="cb172"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb172-1"><a href="ch-python.html#cb172-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb172-2"><a href="ch-python.html#cb172-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb172-3"><a href="ch-python.html#cb172-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A[:,<span class="dv">1</span>])</span></code></pre></div>
<p>Notice when we read the column it was displayed as a column. Be careful. Reading a column from a matrix will automatically flatten it into an array, not a matrix.</p>
<hr />
<p>If we try to multiply either <span class="math inline">\(A\)</span> and <span class="math inline">\(v\)</span> or <span class="math inline">\(A\)</span> and <span class="math inline">\(A\)</span> we will get some funky results. Unlike programming languages like MATLAB, the default notion of multiplication is NOT matrix multiplication. Instead, the default is element-wise multiplication.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-760" class="example"><strong>Example A.33  </strong></span>If we write the code <code>A*A</code> we do NOT do matrix multiplication. Instead we do element-by-element multiplication. This is a common source of issues when dealing with matrices and linear algebra in Python.
</div>
<div class="sourceCode" id="cb173"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb173-1"><a href="ch-python.html#cb173-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb173-2"><a href="ch-python.html#cb173-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb173-3"><a href="ch-python.html#cb173-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Notice that A*A is NOT the same as A*A with matrix mult.</span></span>
<span id="cb173-4"><a href="ch-python.html#cb173-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A <span class="op">*</span> A) </span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-762" class="example"><strong>Example A.34  </strong></span>If we write <code>A * v</code> Python will do element-wise multiplication across each column since <span class="math inline">\(v\)</span> is a column vector.
</div>
<div class="sourceCode" id="cb174"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb174-1"><a href="ch-python.html#cb174-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb174-2"><a href="ch-python.html#cb174-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb174-3"><a href="ch-python.html#cb174-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.array([[<span class="dv">5</span>],[<span class="dv">6</span>]])</span>
<span id="cb174-4"><a href="ch-python.html#cb174-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A <span class="op">*</span> v) </span>
<span id="cb174-5"><a href="ch-python.html#cb174-5" aria-hidden="true" tabindex="-1"></a><span class="co"># A * v will do element wise multiplication on each column</span></span></code></pre></div>
<hr />
<p>If, however, we recast these arrays as matrices we can get them to behave as we would expect from Linear Algebra. It is up to you to check that these products are indeed correct from the definitions of matrix multiplication from Linear Algebra.</p>

<div class="example">
<span id="exm:unnamed-chunk-764" class="example"><strong>Example A.35  </strong></span>Recasting the numpy arrays as matrices allows you to use multiplication as we would expect from linear algebra.
</div>
<div class="sourceCode" id="cb175"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb175-1"><a href="ch-python.html#cb175-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb175-2"><a href="ch-python.html#cb175-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.matrix([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb175-3"><a href="ch-python.html#cb175-3" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> np.matrix([[<span class="dv">5</span>],[<span class="dv">6</span>]])</span>
<span id="cb175-4"><a href="ch-python.html#cb175-4" aria-hidden="true" tabindex="-1"></a>w <span class="op">=</span> np.matrix([<span class="dv">5</span>,<span class="dv">6</span>])</span>
<span id="cb175-5"><a href="ch-python.html#cb175-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The product A*A is:</span><span class="ch">\n</span><span class="st">&quot;</span>,A<span class="op">*</span>A)</span>
<span id="cb175-6"><a href="ch-python.html#cb175-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The product A*v is:</span><span class="ch">\n</span><span class="st">&quot;</span>,A<span class="op">*</span>v)</span>
<span id="cb175-7"><a href="ch-python.html#cb175-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;The product w*A is:</span><span class="ch">\n</span><span class="st">&quot;</span>,w<span class="op">*</span>A)</span></code></pre></div>
<hr />
<p>It remains to show some of the other basic linear algebra operations:
inverses, determinants, the trace, and the transpose.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-766" class="example"><strong>Example A.36  </strong></span>(<strong>Matrix Transpose</strong>) Taking the transpose of a matrix (swapping the rows and columns) is done with the <code>matrix.T</code> command. This is just like other array commands we have seen in Python (like <code>.append</code>, <code>.remove</code>, <code>.shape</code>, etc.).
</div>
<div class="sourceCode" id="cb176"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb176-1"><a href="ch-python.html#cb176-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb176-2"><a href="ch-python.html#cb176-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.matrix([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb176-3"><a href="ch-python.html#cb176-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A.T) <span class="co"># The transpose is relatively simple</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-768" class="example"><strong>Example A.37  </strong></span>(<strong>Matrix Inverse</strong>) The inverse of a square matrix is done with <code>A.I</code>.
</div>
<div class="sourceCode" id="cb177"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb177-1"><a href="ch-python.html#cb177-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb177-2"><a href="ch-python.html#cb177-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.matrix([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb177-3"><a href="ch-python.html#cb177-3" aria-hidden="true" tabindex="-1"></a>Ainv <span class="op">=</span> A.I <span class="co"># Taking the inverse is also pretty simple</span></span>
<span id="cb177-4"><a href="ch-python.html#cb177-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(Ainv)</span>
<span id="cb177-5"><a href="ch-python.html#cb177-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A <span class="op">*</span> Ainv) <span class="co"># check that we get the identity matrix back</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-770" class="example"><strong>Example A.38  </strong></span>(<strong>Matrix Determinant</strong>) The determinant command is hiding under the <code>linalg</code> subpackage inside <code>numpy</code>. Therefore we need to call it as such.
</div>
<div class="sourceCode" id="cb178"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb178-1"><a href="ch-python.html#cb178-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb178-2"><a href="ch-python.html#cb178-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.matrix([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb178-3"><a href="ch-python.html#cb178-3" aria-hidden="true" tabindex="-1"></a><span class="co"># The determinant is inside the numpy.linalg package</span></span>
<span id="cb178-4"><a href="ch-python.html#cb178-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(np.linalg.det(A)) </span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-772" class="example"><strong>Example A.39  </strong></span>(<strong>Trace of a Matrix</strong>) The trace is done with <code>matrix.trace()</code>
</div>
<div class="sourceCode" id="cb179"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb179-1"><a href="ch-python.html#cb179-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb179-2"><a href="ch-python.html#cb179-2" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.matrix([[<span class="dv">1</span>,<span class="dv">2</span>],[<span class="dv">3</span>,<span class="dv">4</span>]])</span>
<span id="cb179-3"><a href="ch-python.html#cb179-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A.trace()) <span class="co"># The trace is pretty darn easy too</span></span></code></pre></div>
<p>Oddly enough, the trace returns a matrix, not a scalar Therefore you’ll
have to read the first entry (index <code>[0,0]</code>) from the answer to just get
the trace.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-774" class="exercise"><strong>Exercise A.17  </strong></span>Now that we can do some basic linear algebra with <code>numpy</code> it is your turn. Define the matrix <span class="math inline">\(B\)</span> and the vector <span class="math inline">\(u\)</span> as<br />
<span class="math display">\[B = \begin{pmatrix} 1 &amp; 4 &amp; 8 \\ 2 &amp; 3 &amp; -1 \\ 0 &amp; 9 &amp; -3 \end{pmatrix} \quad \text{and} \quad u = \begin{pmatrix} 6 \\ 3 \\ -7 \end{pmatrix}.\]</span></p>
<p>Then find</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(Bu\)</span></li>
<li><span class="math inline">\(B^2\)</span> (in the traditional linear algebra sense)</li>
<li>The size and shape of <span class="math inline">\(B\)</span></li>
<li><span class="math inline">\(B^T u\)</span></li>
<li>The element-by-element product of <span class="math inline">\(B\)</span> with itself</li>
<li>The dot product of <span class="math inline">\(u\)</span> with the first row of <span class="math inline">\(B\)</span></li>
</ol>
</div>
<hr />
</div>
<div id="arange-linspace-zeros-ones-and-meshgrid" class="section level3" number="7.5.2">
<h3><span class="header-section-number">A.5.2</span> <code>arange, linspace, zeros, ones</code>, and <code>meshgrid</code></h3>
<p>There are a few built-in ways to build arrays in <code>numpy</code> that save a bit
of time in many scientific computing settings.</p>
<ul>
<li><code>arange</code> (array range) builds an array of floating point numbers with the arguments <code>start, stop,</code> and <code>step</code>. Note that you may not actually get to the <code>stop</code> point if the distance <code>stop-start</code> is not evenly divisible by the ‘step.’</li>
<li><code>linspace</code> (linearly spaced points) builds an array of floating point numbers starting at one point, ending at the next point, and have exactly the number of points specified with equal spacing in between: <code>start, stop, number of points</code>. In a linear space you are always guaranteed to hit the stop point exactly, but you don’t have direct control over the step size.</li>
<li>The <code>zeros</code> and <code>ones</code> commands createarrays of zeros or ones.</li>
<li><code>meshgrid</code> builds two arrays that when paired make up the ordered pairs for a 2D (or higher D) mesh grid of points. This is the same as the <code>meshgrid</code> command in MATLAB.</li>
</ul>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-775" class="example"><strong>Example A.40  </strong></span>The <code>np.arange</code> command is great for building sequences.
</div>
<div class="sourceCode" id="cb180"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb180-1"><a href="ch-python.html#cb180-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb180-2"><a href="ch-python.html#cb180-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="fl">0.6</span>,<span class="fl">0.1</span>)</span>
<span id="cb180-3"><a href="ch-python.html#cb180-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(x)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-777" class="example"><strong>Example A.41  </strong></span>The <code>np.linspace</code> command builds a list with equal (linear) spacing between the starting and ending values.
</div>
<div class="sourceCode" id="cb181"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb181-1"><a href="ch-python.html#cb181-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb181-2"><a href="ch-python.html#cb181-2" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">11</span>)</span>
<span id="cb181-3"><a href="ch-python.html#cb181-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(y)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-779" class="example"><strong>Example A.42  </strong></span>The <code>np.zeros</code> command builds an array of zeros. This is handy for pre-allocating memory.
</div>
<div class="sourceCode" id="cb182"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb182-1"><a href="ch-python.html#cb182-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb182-2"><a href="ch-python.html#cb182-2" aria-hidden="true" tabindex="-1"></a>z <span class="op">=</span> np.zeros((<span class="dv">3</span>,<span class="dv">5</span>)) <span class="co"># create a 3x5 matrix of zeros</span></span>
<span id="cb182-3"><a href="ch-python.html#cb182-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(z)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-781" class="example"><strong>Example A.43  </strong></span>The <code>np.ones</code> command builds an array of ones.
</div>
<div class="sourceCode" id="cb183"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb183-1"><a href="ch-python.html#cb183-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb183-2"><a href="ch-python.html#cb183-2" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> np.ones((<span class="dv">3</span>,<span class="dv">5</span>)) <span class="co"># create a 3x5 matrix of ones</span></span>
<span id="cb183-3"><a href="ch-python.html#cb183-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(u)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-783" class="example"><strong>Example A.44  </strong></span>The <code>np.meshgrid</code> command creates a mesh grid. This is handy for building 2D (or higher dimensional) arrays of data for multi-variable functions. Notice that the output is defined as a tuple.
</div>
<div class="sourceCode" id="cb184"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb184-1"><a href="ch-python.html#cb184-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb184-2"><a href="ch-python.html#cb184-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> np.meshgrid( np.linspace(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">6</span>) , np.linspace(<span class="dv">0</span>,<span class="dv">5</span>,<span class="dv">6</span>) )</span>
<span id="cb184-3"><a href="ch-python.html#cb184-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;x = &quot;</span>, x)</span>
<span id="cb184-4"><a href="ch-python.html#cb184-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;y = &quot;</span>, y)</span></code></pre></div>
<p>The thing to notice with the <code>np.meshgrid()</code> command is that when you lay the two matrices on top of each other, the matching entries give every ordered pair in the domain.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-785" class="exercise"><strong>Exercise A.18  </strong></span>Now time to practice with some of these <code>numpy</code> commands.</p>
<ol style="list-style-type: lower-alpha">
<li>Create a <code>numpy</code> array of the numbers 1 through 10 and square every entry in the list without using a loop.</li>
<li>Create a <span class="math inline">\(10 \times 10\)</span> identity matrix and change the top right corner to a 5. Hint: <code>np.identity()</code></li>
<li>Find the matrix-vector product of the answer to part (a) (as a column) and the answer to part (b).</li>
<li>Change the bottom row of your matrix from part (b) to all 3’s, then change the third column to all 7’s, and then find the <span class="math inline">\(5^{th}\)</span> power of this matrix.</li>
</ol>
</div>
<hr />
</div>
</div>
<div id="plotting-with-matplotlib" class="section level2" number="7.6">
<h2><span class="header-section-number">A.6</span> Plotting with <code>matplotlib</code></h2>
<p>A key part of scientific computing is plotting your results or your data. The tool in Python best-suited to this task is the package <code>matplotlib</code>. As with all of the other packages in Python, it is best to learn just the basics first and then to dig deeper later. One advantage to using <code>matplotlib</code> in Python is that it is modeled off of MATLAB’s plotting tools. People coming from a MATLAB background should feel pretty comfortable here, but there are some differences to be aware of.</p>
<p>Note: The reader should note that we will NOT be plotting symbolically defined functions in this section. The <code>plot</code> command that we will be using is reserved for numerically defined plots (i.e. plots of data points), not functions that are symbolically defined. If you have a symbolically defined function and need a plot, then pick a domain, build some <span class="math inline">\(x\)</span> data, use the function to build the corresponding <span class="math inline">\(y\)</span> data, and use the plotting tools discussed here. If you need a plot of a symbolic function and for some reason these steps are too much to ask, then look to the section of this Appendix on <code>sympy</code>.</p>
<div id="basics-with-plt.plot" class="section level3" number="7.6.1">
<h3><span class="header-section-number">A.6.1</span> Basics with <code>plt.plot()</code></h3>
<p>We are going to start right away with an example. In this example, however, we’ll walk through each of the code chunks one-by-one so that we understand how to set up a proper plot. Something to keep in mind. The author strongly encourages students and readers to use Jupyter Notebooks for their Python coding. As such, there are some tricks for getting the plots to render that only apply to Jupyter Notebooks. If you are using Google Colab then you may not need some of these little tricks.</p>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-786" class="example"><strong>Example A.45  </strong></span>(<strong>Plotting with matplotlib</strong>) In the first example we want to simply plot the sine function on the domain <span class="math inline">\(x \in [0,2\pi]\)</span>, color it green, put a grid on it, and give a meaningful legend and axis labels. To do so we first need to take care of a couple of housekeeping items.</p>
<ul>
<li>Import <code>numpy</code> so we can take advantage of some good numerical routines.</li>
<li>Import <code>matplotlib</code>’s <code>pyplot</code> module. The standard way to pull it is in is with the nickname <code>plt</code> (just like with <code>numpy</code> when we import it as <code>np</code>).</li>
</ul>
</div>
<div class="sourceCode" id="cb185"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb185-1"><a href="ch-python.html#cb185-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np </span>
<span id="cb185-2"><a href="ch-python.html#cb185-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span></code></pre></div>
<p>In Jupyter Notebooks the plots will not show up unless you tell the notebook to put them “inline.” Usually we will use the following command to get the plots to show up. You do not need to do this in Google Colab. The percent sign is called a <em>magic</em> command in Jupyter Notebooks. This is not a Python command, but it is a command for controlling the Jupyter IDE specifically.</p>
<div class="sourceCode" id="cb186"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb186-1"><a href="ch-python.html#cb186-1" aria-hidden="true" tabindex="-1"></a><span class="op">%</span>matplotlib inline</span></code></pre></div>
<p>Now we’ll build a <code>numpy</code> array of <span class="math inline">\(x\)</span> values (using the <code>np.linspace</code> command) and a <code>numpy</code> array of <span class="math inline">\(y\)</span> values for the sine function.</p>
<div class="sourceCode" id="cb187"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb187-1"><a href="ch-python.html#cb187-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 100 equally spaced points from 0 to 2pi</span></span>
<span id="cb187-2"><a href="ch-python.html#cb187-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi, <span class="dv">100</span>) </span>
<span id="cb187-3"><a href="ch-python.html#cb187-3" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> np.sin(x)</span></code></pre></div>
<ul>
<li>Finally, build the plot with <code>plt.plot()</code>. The syntax is: <code>plt.plot(x, y, ’color’, ...)</code> where you have several options that you can pass (more on that later).</li>
<li>Notice that we send the plot legend in directly to the plot command. This is optional and could set the legend up separately if we like.</li>
<li>Then we’ll add the grid with <code>plt.grid()</code></li>
<li>Then we’ll add the legend to the plot</li>
<li>Finally we’ll add the axis labels</li>
<li>We end the plotting code with <code>plt.show()</code> to tell Python to finally show the plot. This line of code tells Python that you’re done building that plot.</li>
</ul>
<div class="sourceCode" id="cb188"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb188-1"><a href="ch-python.html#cb188-1" aria-hidden="true" tabindex="-1"></a>plt.plot(x,y, <span class="st">&#39;green&#39;</span>, label<span class="op">=</span><span class="st">&#39;The Sine Function&#39;</span>)</span>
<span id="cb188-2"><a href="ch-python.html#cb188-2" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb188-3"><a href="ch-python.html#cb188-3" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb188-4"><a href="ch-python.html#cb188-4" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&quot;x axis&quot;</span>)</span>
<span id="cb188-5"><a href="ch-python.html#cb188-5" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&quot;y axis&quot;</span>)</span>
<span id="cb188-6"><a href="ch-python.html#cb188-6" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-791"></span>
<img src="images/Ch07_SineFunction.png" alt="The sine function" width="75%" />
<p class="caption">
Figure A.1: The sine function
</p>
</div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-792" class="example"><strong>Example A.46  </strong></span>Now let’s do a second example, but this time we want to show four different plots on top of each other. When you start a figure, <code>matplotlib</code> is expecting all of those plots to be layered on top of each other.(Note:For MATLAB users, this means that you do not need the <code>hold on</code> command since it is automatically “on.”)</p>
In this example we will plot
<span class="math display">\[y_0 = \sin(2\pi x) \quad y_1 = \cos(2 \pi x) \quad y_2 = y_0 + y_1 \quad \text{and} \quad y_3 = y_0 - y_1\]</span>
on the domain <span class="math inline">\(x \in [0,1]\)</span> with 100 equally spaced points. We’ll give each of the plots a different line style, built a legend, put a grid on the plot, and give axis labels.
</div>
<div class="sourceCode" id="cb189"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb189-1"><a href="ch-python.html#cb189-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb189-2"><a href="ch-python.html#cb189-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb189-3"><a href="ch-python.html#cb189-3" aria-hidden="true" tabindex="-1"></a><span class="co"># %matplotlib inline # you may need this in Jupyter Notebooks</span></span>
<span id="cb189-4"><a href="ch-python.html#cb189-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-5"><a href="ch-python.html#cb189-5" aria-hidden="true" tabindex="-1"></a><span class="co"># build the x and y values</span></span>
<span id="cb189-6"><a href="ch-python.html#cb189-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb189-7"><a href="ch-python.html#cb189-7" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>x)</span>
<span id="cb189-8"><a href="ch-python.html#cb189-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.cos(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>x)</span>
<span id="cb189-9"><a href="ch-python.html#cb189-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> y0 <span class="op">+</span> y1</span>
<span id="cb189-10"><a href="ch-python.html#cb189-10" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> y0 <span class="op">-</span> y1</span>
<span id="cb189-11"><a href="ch-python.html#cb189-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-12"><a href="ch-python.html#cb189-12" aria-hidden="true" tabindex="-1"></a><span class="co"># plot each of the functions </span></span>
<span id="cb189-13"><a href="ch-python.html#cb189-13" aria-hidden="true" tabindex="-1"></a><span class="co"># (notice that they will be on the same axes)</span></span>
<span id="cb189-14"><a href="ch-python.html#cb189-14" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y0, <span class="st">&#39;b-.&#39;</span>, label<span class="op">=</span><span class="vs">r&quot;$y_0 = \sin(2\pi x)$&quot;</span>)</span>
<span id="cb189-15"><a href="ch-python.html#cb189-15" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y1, <span class="st">&#39;r--&#39;</span>, label<span class="op">=</span><span class="vs">r&quot;$y_1 = \cos(2\pi x)$&quot;</span>)</span>
<span id="cb189-16"><a href="ch-python.html#cb189-16" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y2, <span class="st">&#39;g:&#39;</span>, label<span class="op">=</span><span class="vs">r&quot;$y_2 = y_0 + y_1$&quot;</span>)</span>
<span id="cb189-17"><a href="ch-python.html#cb189-17" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y3, <span class="st">&#39;k-&#39;</span>, label<span class="op">=</span><span class="vs">r&quot;$y_3 = y_0 - y_1$&quot;</span>)</span>
<span id="cb189-18"><a href="ch-python.html#cb189-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb189-19"><a href="ch-python.html#cb189-19" aria-hidden="true" tabindex="-1"></a><span class="co"># put in a grid, legend, title, and axis labels</span></span>
<span id="cb189-20"><a href="ch-python.html#cb189-20" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb189-21"><a href="ch-python.html#cb189-21" aria-hidden="true" tabindex="-1"></a>plt.legend()</span>
<span id="cb189-22"><a href="ch-python.html#cb189-22" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Awesome Title&quot;</span>)</span>
<span id="cb189-23"><a href="ch-python.html#cb189-23" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;x axis label&#39;</span>)</span>
<span id="cb189-24"><a href="ch-python.html#cb189-24" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;y axis label&#39;</span>)</span>
<span id="cb189-25"><a href="ch-python.html#cb189-25" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-794"></span>
<img src="images/Ch07_SeveralSines.png" alt="Plots of the sine, cosine, and sums and differences." width="75%" />
<p class="caption">
Figure A.2: Plots of the sine, cosine, and sums and differences.
</p>
</div>
<p>Notice that the legend was placed automatically. There are ways to control the placement of the legend if you wish, but for now just let Python and <code>matplotlib</code> have control over the placement.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-795" class="example"><strong>Example A.47  </strong></span>Now let’s create the same plot with slightly different code. The <code>plot</code> command can take several <span class="math inline">\((x, y)\)</span> pairs in the same line of code. This can really shrink the amount of coding that you have to do when plotting several functions on top of each other.
</div>
<div class="sourceCode" id="cb190"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb190-1"><a href="ch-python.html#cb190-1" aria-hidden="true" tabindex="-1"></a><span class="co"># The next line of code does all of the plotting of all </span></span>
<span id="cb190-2"><a href="ch-python.html#cb190-2" aria-hidden="true" tabindex="-1"></a><span class="co"># of the functions.  Notice the order: x, y, color and </span></span>
<span id="cb190-3"><a href="ch-python.html#cb190-3" aria-hidden="true" tabindex="-1"></a><span class="co"># line style, repeat</span></span>
<span id="cb190-4"><a href="ch-python.html#cb190-4" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb190-5"><a href="ch-python.html#cb190-5" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb190-6"><a href="ch-python.html#cb190-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb190-7"><a href="ch-python.html#cb190-7" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>x)</span>
<span id="cb190-8"><a href="ch-python.html#cb190-8" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.cos(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>x)</span>
<span id="cb190-9"><a href="ch-python.html#cb190-9" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> y0 <span class="op">+</span> y1</span>
<span id="cb190-10"><a href="ch-python.html#cb190-10" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> y0 <span class="op">-</span> y1</span>
<span id="cb190-11"><a href="ch-python.html#cb190-11" aria-hidden="true" tabindex="-1"></a>plt.plot(x, y0, <span class="st">&#39;b-.&#39;</span>, x, y1, <span class="st">&#39;r--&#39;</span>, x, y2, <span class="st">&#39;g:&#39;</span>, x, y3, <span class="st">&#39;k-&#39;</span>)</span>
<span id="cb190-12"><a href="ch-python.html#cb190-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb190-13"><a href="ch-python.html#cb190-13" aria-hidden="true" tabindex="-1"></a>plt.grid()</span>
<span id="cb190-14"><a href="ch-python.html#cb190-14" aria-hidden="true" tabindex="-1"></a>plt.legend([<span class="vs">r&quot;$y_0 = \sin(2\pi x)$&quot;</span>,<span class="vs">r&quot;$y_1 = \cos(2\pi x)$&quot;</span>,<span class="op">\</span></span>
<span id="cb190-15"><a href="ch-python.html#cb190-15" aria-hidden="true" tabindex="-1"></a>            <span class="vs">r&quot;$y_2 = y_0 + y_1$&quot;</span>,<span class="vs">r&quot;$y_3 = y_0 - y_1$&quot;</span>])</span>
<span id="cb190-16"><a href="ch-python.html#cb190-16" aria-hidden="true" tabindex="-1"></a>plt.title(<span class="st">&quot;Awesome Title&quot;</span>)</span>
<span id="cb190-17"><a href="ch-python.html#cb190-17" aria-hidden="true" tabindex="-1"></a>plt.xlabel(<span class="st">&#39;x axis label&#39;</span>)</span>
<span id="cb190-18"><a href="ch-python.html#cb190-18" aria-hidden="true" tabindex="-1"></a>plt.ylabel(<span class="st">&#39;y axis label&#39;</span>)</span>
<span id="cb190-19"><a href="ch-python.html#cb190-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-797"></span>
<img src="images/Ch07_SeveralSines2.png" alt="A second plot of the sine, cosine, and sums and differences." width="75%" />
<p class="caption">
Figure A.3: A second plot of the sine, cosine, and sums and differences.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-798" class="exercise"><strong>Exercise A.19  </strong></span>Plot the functions <span class="math inline">\(f(x) = x^2\)</span>, <span class="math inline">\(g(x) = x^3\)</span>, and <span class="math inline">\(h(x) = x^4\)</span> on the same axes. Use the domain <span class="math inline">\(x \in [0,1]\)</span> and the range <span class="math inline">\(y \in [0,1]\)</span>. Put a grid, a legend, a title, and appropriate labels on the axes.
</div>
<hr />
</div>
<div id="subplots" class="section level3" number="7.6.2">
<h3><span class="header-section-number">A.6.2</span> Subplots</h3>
<p>It is often very handy to place plots side-by-side or as some array of plots. The <code>subplots</code> command allows us that control. The main idea is that we are setting up a matrix of blank plots and then populating the axes with the plots that we want.</p>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-799" class="example"><strong>Example A.48  </strong></span>Let’s repeat the previous exercise, but this time we will put each of the plots in its own subplot. There are a few extra coding quirks that come along with building subplots so we’ll highlight each block of code separately.</p>
<ul>
<li>First we set up the plot area with <code>plt.subplots()</code>. The first two inputs to the <code>subplots</code> command are the number of rows and the number of columns in your plot array. For the first example we will do 2 rows of plots with 2 columns – so there are four plots total. The last input for the <code>subplots</code> command is the size of the figure (this is really just so that it shows up well in Jupyter Notebooks – spend some time playing with the figure size to get it to look right).</li>
<li>Then we build each plot individually telling <code>matplotlib</code> which axes to use for each of the things in the plots.</li>
<li>Notice the small differences in how we set the titles and labels</li>
<li>In this example we are setting the <span class="math inline">\(y\)</span>-axis to the interval <span class="math inline">\([-2,2]\)</span> for consistency across all of the plots.</li>
</ul>
</div>
<div class="sourceCode" id="cb191"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb191-1"><a href="ch-python.html#cb191-1" aria-hidden="true" tabindex="-1"></a><span class="co"># set up the blank matrix of plots</span></span>
<span id="cb191-2"><a href="ch-python.html#cb191-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb191-3"><a href="ch-python.html#cb191-3" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb191-4"><a href="ch-python.html#cb191-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb191-5"><a href="ch-python.html#cb191-5" aria-hidden="true" tabindex="-1"></a>y0 <span class="op">=</span> np.sin(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>x)</span>
<span id="cb191-6"><a href="ch-python.html#cb191-6" aria-hidden="true" tabindex="-1"></a>y1 <span class="op">=</span> np.cos(<span class="dv">2</span><span class="op">*</span>np.pi<span class="op">*</span>x)</span>
<span id="cb191-7"><a href="ch-python.html#cb191-7" aria-hidden="true" tabindex="-1"></a>y2 <span class="op">=</span> y0 <span class="op">+</span> y1</span>
<span id="cb191-8"><a href="ch-python.html#cb191-8" aria-hidden="true" tabindex="-1"></a>y3 <span class="op">=</span> y0 <span class="op">-</span> y1</span>
<span id="cb191-9"><a href="ch-python.html#cb191-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-10"><a href="ch-python.html#cb191-10" aria-hidden="true" tabindex="-1"></a>fig, axes <span class="op">=</span> plt.subplots(nrows <span class="op">=</span> <span class="dv">2</span>, ncols <span class="op">=</span> <span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb191-11"><a href="ch-python.html#cb191-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-12"><a href="ch-python.html#cb191-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the first plot</span></span>
<span id="cb191-13"><a href="ch-python.html#cb191-13" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].plot(x, y0, <span class="st">&#39;b-.&#39;</span>)</span>
<span id="cb191-14"><a href="ch-python.html#cb191-14" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].grid()</span>
<span id="cb191-15"><a href="ch-python.html#cb191-15" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_title(<span class="vs">r&quot;$y_0 = \sin(2\pi x)$&quot;</span>)</span>
<span id="cb191-16"><a href="ch-python.html#cb191-16" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb191-17"><a href="ch-python.html#cb191-17" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb191-18"><a href="ch-python.html#cb191-18" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">0</span>].set_ylabel(<span class="st">&quot;y&quot;</span>)</span>
<span id="cb191-19"><a href="ch-python.html#cb191-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-20"><a href="ch-python.html#cb191-20" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the second plot</span></span>
<span id="cb191-21"><a href="ch-python.html#cb191-21" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].plot(x, y1, <span class="st">&#39;r--&#39;</span>)</span>
<span id="cb191-22"><a href="ch-python.html#cb191-22" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].grid()</span>
<span id="cb191-23"><a href="ch-python.html#cb191-23" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_title(<span class="vs">r&quot;$y_1 = \cos(2\pi x)$&quot;</span>)</span>
<span id="cb191-24"><a href="ch-python.html#cb191-24" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_ylim(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb191-25"><a href="ch-python.html#cb191-25" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb191-26"><a href="ch-python.html#cb191-26" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">0</span>,<span class="dv">1</span>].set_ylabel(<span class="st">&quot;y&quot;</span>)</span>
<span id="cb191-27"><a href="ch-python.html#cb191-27" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-28"><a href="ch-python.html#cb191-28" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the first plot</span></span>
<span id="cb191-29"><a href="ch-python.html#cb191-29" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].plot(x, y2, <span class="st">&#39;g:&#39;</span>)</span>
<span id="cb191-30"><a href="ch-python.html#cb191-30" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].grid()</span>
<span id="cb191-31"><a href="ch-python.html#cb191-31" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_title(<span class="vs">r&quot;$y_2 = y_0 + y_1$&quot;</span>)</span>
<span id="cb191-32"><a href="ch-python.html#cb191-32" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_ylim(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb191-33"><a href="ch-python.html#cb191-33" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb191-34"><a href="ch-python.html#cb191-34" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">0</span>].set_ylabel(<span class="st">&quot;y&quot;</span>)</span>
<span id="cb191-35"><a href="ch-python.html#cb191-35" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-36"><a href="ch-python.html#cb191-36" aria-hidden="true" tabindex="-1"></a><span class="co"># Build the first plot</span></span>
<span id="cb191-37"><a href="ch-python.html#cb191-37" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].plot(x, y3, <span class="st">&#39;k-&#39;</span>)</span>
<span id="cb191-38"><a href="ch-python.html#cb191-38" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].grid()</span>
<span id="cb191-39"><a href="ch-python.html#cb191-39" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_title(<span class="vs">r&quot;$y_3 = y_0 - y_1$&quot;</span>)</span>
<span id="cb191-40"><a href="ch-python.html#cb191-40" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_ylim(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb191-41"><a href="ch-python.html#cb191-41" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb191-42"><a href="ch-python.html#cb191-42" aria-hidden="true" tabindex="-1"></a>axes[<span class="dv">1</span>,<span class="dv">1</span>].set_ylabel(<span class="st">&quot;y&quot;</span>)</span>
<span id="cb191-43"><a href="ch-python.html#cb191-43" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb191-44"><a href="ch-python.html#cb191-44" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()</span>
<span id="cb191-45"><a href="ch-python.html#cb191-45" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p>The <code>fig.tight_layout()</code> command makes the plot labels a bit more readable in this instance (again, something you can play with).</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-801"></span>
<img src="images/Ch07_Subplots.png" alt="An example of subplots" width="75%" />
<p class="caption">
Figure A.4: An example of subplots
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-802" class="exercise"><strong>Exercise A.20  </strong></span>Put the functions <span class="math inline">\(f(x) = x^2\)</span>, <span class="math inline">\(g(x) = x^3\)</span> and <span class="math inline">\(h(x) = x^4\)</span> in a subplot environment with 1 row and 3 columns of plots. Use the unit interval as the domain and range for all three plot, but sure that each plot has a grid, appropriate labels, an appropriate title, and the overall figure has a title.
</div>
<hr />
</div>
<div id="logarithmic-scaling-with-semilogy-semilogx-and-loglog" class="section level3" number="7.6.3">
<h3><span class="header-section-number">A.6.3</span> Logarithmic Scaling with <code>semilogy</code>, <code>semilogx</code>, and <code>loglog</code></h3>
<p>It is occasionally useful to scale an axis logarithmically. This arises most often when we’re examining an exponential function, or some other function, that is close to zero for much of the domain. Scaling logarithmically allows us to see how small the function is getting in orders of magnitude instead of as a raw real number. We’ll use this often in numerical methods.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-803" class="example"><strong>Example A.49  </strong></span>In this example we’ll plot the function <span class="math inline">\(y = 10^{-0.01x}\)</span> on a regular (linear) scale and on a logarithmic scale on the <span class="math inline">\(y\)</span> axis. Use the interval <span class="math inline">\([0,500]\)</span>.
</div>
<div class="sourceCode" id="cb192"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb192-1"><a href="ch-python.html#cb192-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb192-2"><a href="ch-python.html#cb192-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb192-3"><a href="ch-python.html#cb192-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb192-4"><a href="ch-python.html#cb192-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="fl">0.01</span><span class="op">*</span>x)</span>
<span id="cb192-5"><a href="ch-python.html#cb192-5" aria-hidden="true" tabindex="-1"></a>fig, axis <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb192-6"><a href="ch-python.html#cb192-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-7"><a href="ch-python.html#cb192-7" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].plot(x,y, <span class="st">&#39;r&#39;</span>)</span>
<span id="cb192-8"><a href="ch-python.html#cb192-8" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].grid()</span>
<span id="cb192-9"><a href="ch-python.html#cb192-9" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_title(<span class="st">&quot;Linearly scaled y axis&quot;</span>)</span>
<span id="cb192-10"><a href="ch-python.html#cb192-10" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb192-11"><a href="ch-python.html#cb192-11" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_ylabel(<span class="st">&quot;y&quot;</span>)</span>
<span id="cb192-12"><a href="ch-python.html#cb192-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb192-13"><a href="ch-python.html#cb192-13" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].semilogy(x,y, <span class="st">&#39;k--&#39;</span>)</span>
<span id="cb192-14"><a href="ch-python.html#cb192-14" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].grid()</span>
<span id="cb192-15"><a href="ch-python.html#cb192-15" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_title(<span class="st">&quot;Logarithmically scaled y axis&quot;</span>)</span>
<span id="cb192-16"><a href="ch-python.html#cb192-16" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb192-17"><a href="ch-python.html#cb192-17" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_ylabel(<span class="st">&quot;Log(y)&quot;</span>)</span>
<span id="cb192-18"><a href="ch-python.html#cb192-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<p>It should be noted that the same result can be achieved using the <code>yscale</code> command along with the <code>plot</code> command instead of using the <code>semilogy</code> command. Pay careful attention to the subtle changes in the following code.</p>
<div class="sourceCode" id="cb193"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb193-1"><a href="ch-python.html#cb193-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb193-2"><a href="ch-python.html#cb193-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb193-3"><a href="ch-python.html#cb193-3" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">500</span>,<span class="dv">1000</span>)</span>
<span id="cb193-4"><a href="ch-python.html#cb193-4" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> <span class="dv">10</span><span class="op">**</span>(<span class="op">-</span><span class="fl">0.01</span><span class="op">*</span>x)</span>
<span id="cb193-5"><a href="ch-python.html#cb193-5" aria-hidden="true" tabindex="-1"></a>fig, axis <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>, figsize <span class="op">=</span> (<span class="dv">10</span>,<span class="dv">5</span>))</span>
<span id="cb193-6"><a href="ch-python.html#cb193-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-7"><a href="ch-python.html#cb193-7" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].plot(x,y, <span class="st">&#39;r&#39;</span>)</span>
<span id="cb193-8"><a href="ch-python.html#cb193-8" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].grid()</span>
<span id="cb193-9"><a href="ch-python.html#cb193-9" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_title(<span class="st">&quot;Linearly scaled y axis&quot;</span>)</span>
<span id="cb193-10"><a href="ch-python.html#cb193-10" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb193-11"><a href="ch-python.html#cb193-11" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">0</span>].set_ylabel(<span class="st">&quot;y&quot;</span>)</span>
<span id="cb193-12"><a href="ch-python.html#cb193-12" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb193-13"><a href="ch-python.html#cb193-13" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].plot(x,y, <span class="st">&#39;k--&#39;</span>) <span class="co"># &lt;----- Notice the change here</span></span>
<span id="cb193-14"><a href="ch-python.html#cb193-14" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_yscale(<span class="st">&quot;log&quot;</span>) <span class="co"># &lt;----- And we added this line</span></span>
<span id="cb193-15"><a href="ch-python.html#cb193-15" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].grid()</span>
<span id="cb193-16"><a href="ch-python.html#cb193-16" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_title(<span class="st">&quot;Logarithmically scaled y axis&quot;</span>)</span>
<span id="cb193-17"><a href="ch-python.html#cb193-17" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_xlabel(<span class="st">&quot;x&quot;</span>)</span>
<span id="cb193-18"><a href="ch-python.html#cb193-18" aria-hidden="true" tabindex="-1"></a>axis[<span class="dv">1</span>].set_ylabel(<span class="st">&quot;Log(y)&quot;</span>)</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-806"></span>
<img src="images/Ch07_LogScale.png" alt="An example of using logarithmic scaling." width="75%" />
<p class="caption">
Figure A.5: An example of using logarithmic scaling.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-807" class="exercise"><strong>Exercise A.21  </strong></span>Plot the function <span class="math inline">\(f(x) = x^3\)</span> for <span class="math inline">\(x \in [0,1]\)</span> on linearly scaled axes, logarithmic axis in the <span class="math inline">\(y\)</span> direction, logarithmically scaled axes in the <span class="math inline">\(x\)</span> direction, and a log-log plot with logarithmic scaling on both axes. Use <code>subplots</code> to put your plots side-by-side. Give appropriate labels, titles, etc.
</div>
<hr />
</div>
</div>
<div id="symbolic-python-with-sympy" class="section level2" number="7.7">
<h2><span class="header-section-number">A.7</span> Symbolic Python with <code>sympy</code></h2>
<p>In this section we will learn the tools necessary to do symbolic mathematics in Python. The relevant package is <code>sympy</code> (symbolic Python) and it works much like Mathematica, Maple, or MATLAB’s symbolic toolbox. That being said, Mathematica and Maple are designed to do symbolic computation in the fastest and best possible ways, so in some sense, <code>sympy</code> is a little step-sibling to these much bigger pieces of software. Remember: Python is free, and this is a book on numerical analysis – we will not be doing much symbolic work in this particular class, but these tools do occasionally come in handy.</p>
<p>Let’s import <code>sympy</code> in the usual way. We will use the nickname <code>sp</code> (just like we used <code>np</code> for <code>numpy</code>). This is not a standard nickname in the Python literature, but it will suffice for our purposes.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-808" class="exercise"><strong>Exercise A.22  </strong></span>Load <code>sympy</code> and use the <code>dir()</code> command to see what functions are inside the <code>sympy</code> library.
</div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-809" class="example"><strong>Example A.50  </strong></span>If you include the command <code>sp.init_printing()</code> after you load <code>sympy</code> you will get some nice LaTeX style output in your Jupyter Notebooks.
</div>
<hr />
<div id="symbolic-variables-with-symbols" class="section level3" number="7.7.1">
<h3><span class="header-section-number">A.7.1</span> Symbolic Variables with <code>symbols</code></h3>
<p>When you are working with symbolic variables you have to tell Python that that’s what you’re doing. In other words, we actually have to type-cast the variables when we name them. Otherwise Python won’t know what to do with them – we need to explicitly tell it that we are working with symbols!</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-810" class="example"><strong>Example A.51  </strong></span>Let’s define the variable <span class="math inline">\(x\)</span> as a symbolic variable. Then we’ll define a few symbolic expressions that use <span class="math inline">\(x\)</span> as a variable.
</div>
<div class="sourceCode" id="cb194"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb194-1"><a href="ch-python.html#cb194-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb194-2"><a href="ch-python.html#cb194-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>) <span class="co"># note the capitalization</span></span></code></pre></div>
<p>Now we’ll define the function <span class="math inline">\(f(x) = (x+2)^3\)</span> and spend the next few
examples playing with it.</p>
<div class="sourceCode" id="cb195"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb195-1"><a href="ch-python.html#cb195-1" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span> <span class="co"># A symbolic function</span></span>
<span id="cb195-2"><a href="ch-python.html#cb195-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(f)</span></code></pre></div>
<p>Notice that the output of these lines of code is not necessarily very nicely formatted as a symbolic expression. What we would really want to see is <span class="math inline">\(\displaystyle (x+2)^3\)</span>. If you include the code <code>sp.init_printing()</code> after you import the <code>sympy</code> library then you should get nice LaTeX style formatting in your answers.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-813" class="example"><strong>Example A.52  </strong></span>Be careful that you are using symbolically defined function along with your symbols. For example, see the code below:
</div>
<div class="sourceCode" id="cb196"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb196-1"><a href="ch-python.html#cb196-1" aria-hidden="true" tabindex="-1"></a><span class="co"># this line gives an error since it doesn&#39;t know </span></span>
<span id="cb196-2"><a href="ch-python.html#cb196-2" aria-hidden="true" tabindex="-1"></a><span class="co"># which &quot;sine&quot; to use.</span></span>
<span id="cb196-3"><a href="ch-python.html#cb196-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sin(x) </span></code></pre></div>
<div class="sourceCode" id="cb197"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb197-1"><a href="ch-python.html#cb197-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb197-2"><a href="ch-python.html#cb197-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb197-3"><a href="ch-python.html#cb197-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sp.sin(x) <span class="co"># this one works</span></span>
<span id="cb197-4"><a href="ch-python.html#cb197-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(g)</span></code></pre></div>
<hr />
</div>
<div id="symbolic-algebra" class="section level3" number="7.7.2">
<h3><span class="header-section-number">A.7.2</span> Symbolic Algebra</h3>
<p>One of the primary purposes of doing symbolic programming is to do symbolic algebra (the other is typically symbolic calculus). In this section we’ll look at a few of the common algebraic exercises that can be handled with <code>sympy</code>.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-816" class="example"><strong>Example A.53  </strong></span>(<strong>symbolic expand</strong>) Expand the function <span class="math inline">\(f(x) = (x+2)^3\)</span>. In other words, multiply this out fully so that it is a sum or difference of monomials instead of the cube of a binomial.
</div>
<div class="sourceCode" id="cb198"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb198-1"><a href="ch-python.html#cb198-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb198-2"><a href="ch-python.html#cb198-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb198-3"><a href="ch-python.html#cb198-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb198-4"><a href="ch-python.html#cb198-4" aria-hidden="true" tabindex="-1"></a>sp.expand(f) <span class="co"># do the multiplication to expand the polynomial</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-818" class="example"><strong>Example A.54  </strong></span>(<strong>symbolic factoring</strong>) We will factor the polynomial <span class="math inline">\(h(x) = x^2 + 4x + 3\)</span>.
</div>
<div class="sourceCode" id="cb199"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb199-1"><a href="ch-python.html#cb199-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb199-2"><a href="ch-python.html#cb199-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb199-3"><a href="ch-python.html#cb199-3" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb199-4"><a href="ch-python.html#cb199-4" aria-hidden="true" tabindex="-1"></a>sp.factor(h) <span class="co"># factor this polynomial</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-820" class="example"><strong>Example A.55  </strong></span>(<strong>Trigonometric Simplification</strong>) The <code>sympy</code> package knows how to work with trigonometric identities. In this example we show how <code>sympy</code> expands <span class="math inline">\(\sin(a+b)\)</span>.
</div>
<div class="sourceCode" id="cb200"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb200-1"><a href="ch-python.html#cb200-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb200-2"><a href="ch-python.html#cb200-2" aria-hidden="true" tabindex="-1"></a>a, b <span class="op">=</span> sp.symbols(<span class="st">&#39;a b&#39;</span>)</span>
<span id="cb200-3"><a href="ch-python.html#cb200-3" aria-hidden="true" tabindex="-1"></a>j <span class="op">=</span> sp.sin(a<span class="op">+</span>b)</span>
<span id="cb200-4"><a href="ch-python.html#cb200-4" aria-hidden="true" tabindex="-1"></a>sp.expand(j, trig<span class="op">=</span><span class="va">True</span>) <span class="co"># Trig identities are built in!</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-822" class="example"><strong>Example A.56  </strong></span>(<strong>Symbolic Simplification</strong>) In this example we will simplify the function <span class="math inline">\(g(x) = x^3 + 5x^3 + 12x^2 +1\)</span>.
</div>
<div class="sourceCode" id="cb201"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb201-1"><a href="ch-python.html#cb201-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb201-2"><a href="ch-python.html#cb201-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb201-3"><a href="ch-python.html#cb201-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">5</span><span class="op">*</span>x<span class="op">**</span><span class="dv">3</span> <span class="op">+</span> <span class="dv">12</span><span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">1</span></span>
<span id="cb201-4"><a href="ch-python.html#cb201-4" aria-hidden="true" tabindex="-1"></a>sp.simplify(g) <span class="co"># Simplify some algebraic expression</span></span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-824" class="example"><strong>Example A.57  </strong></span>In this example we’ll simplify an expression that involves trigonometry.
</div>
<div class="sourceCode" id="cb202"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb202-1"><a href="ch-python.html#cb202-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb202-2"><a href="ch-python.html#cb202-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb202-3"><a href="ch-python.html#cb202-3" aria-hidden="true" tabindex="-1"></a>sp.simplify( sp.sin(x) <span class="op">/</span> sp.cos(x)) <span class="co"># simplify a trig expression.</span></span></code></pre></div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-826" class="example"><strong>Example A.58  </strong></span>(<strong>Symbolic Equation Solving</strong>) The primary goal of many algebra problems is to solve an equation. We will dedicate more time to algebraic equation solving later in this section, but this example gives a simple example of how it works in <code>sympy</code>.</p>
We want to solve the equation <span class="math inline">\(x^2 + 4x + 3 = 0\)</span> for <span class="math inline">\(x\)</span>.
</div>
<div class="sourceCode" id="cb203"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb203-1"><a href="ch-python.html#cb203-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb203-2"><a href="ch-python.html#cb203-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb203-3"><a href="ch-python.html#cb203-3" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="dv">4</span><span class="op">*</span>x <span class="op">+</span> <span class="dv">3</span></span>
<span id="cb203-4"><a href="ch-python.html#cb203-4" aria-hidden="true" tabindex="-1"></a>sp.solve(h,x)</span></code></pre></div>
<p>As expected, the roots of the function <span class="math inline">\(h(x)\)</span> are <span class="math inline">\(x=-3\)</span> and <span class="math inline">\(x=1\)</span> since <span class="math inline">\(h(x)\)</span> factors into <span class="math inline">\(h(x) = (x+3)(x-1)\)</span>.</p>
<hr />
</div>
<div id="symbolic-function-evaluation" class="section level3" number="7.7.3">
<h3><span class="header-section-number">A.7.3</span> Symbolic Function Evaluation</h3>
<p>In <code>sympy</code> we cannot simply just evaluate functions as we would on paper. Let’s say we have the function <span class="math inline">\(f(x)= (x+2)^3\)</span> and we want to find <span class="math inline">\(f(5)\)</span>. We would say that we “substitute 5 into f for x,” and that is exactly what we have to tell Python. Unfortunately we cannot just write <code>f(5)</code> since that would mean that <code>f</code> is a Python function and we are sending the number 5 into that function. This is an unfortunate double-use of the word “function,” but stop and think about it for a second: When we write <code>f = (x+2)**3</code> we are just telling Python that <code>f</code> is a symbolic expression in terms of the symbol <code>x</code>, but we did not use <code>def</code> to define it as a function as we did for all other function.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-828" class="example"><strong>Example A.59  </strong></span>The following code is what the mathematicians in us would like to do:
</div>
<div class="sourceCode" id="cb204"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb204-1"><a href="ch-python.html#cb204-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb204-2"><a href="ch-python.html#cb204-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb204-3"><a href="ch-python.html#cb204-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb204-4"><a href="ch-python.html#cb204-4" aria-hidden="true" tabindex="-1"></a>f(<span class="dv">5</span>) <span class="co"># This gives an error!</span></span></code></pre></div>
<p>… but this is how it should be done:</p>
<div class="sourceCode" id="cb205"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb205-1"><a href="ch-python.html#cb205-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb205-2"><a href="ch-python.html#cb205-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb205-3"><a href="ch-python.html#cb205-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb205-4"><a href="ch-python.html#cb205-4" aria-hidden="true" tabindex="-1"></a>f.subs(x,<span class="dv">5</span>) <span class="co"># This actually substitutes 5 for x in f</span></span></code></pre></div>
<hr />
</div>
<div id="symbolic-calculus" class="section level3" number="7.7.4">
<h3><span class="header-section-number">A.7.4</span> Symbolic Calculus</h3>
<p>The <code>sympy</code> package has routines to take symbolic derivatives, antiderivatives, limits, and Taylor series just like other computer algebra systems.</p>
<div id="derivatives" class="section level4" number="7.7.4.1">
<h4><span class="header-section-number">A.7.4.1</span> Derivatives</h4>
<p>The <code>diff</code> command in <code>sympy</code> does differentiation: <code>sp.diff(function, variable, [order])</code>.</p>
<p>Take careful note that <code>diff</code> is defined both in <code>sympy</code> and in <code>numpy</code>. That means that there are symbolic and numerical routines for taking derivatives in Python …and we need to tell our instance of Python which one we’re working with every time we use it.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-831" class="example"><strong>Example A.60  </strong></span>(<strong>Symbolic Differentiation</strong>) In this example we’ll differentiate the function <span class="math inline">\(f(x) = (x+2)^3\)</span>.
</div>
<div class="sourceCode" id="cb206"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb206-1"><a href="ch-python.html#cb206-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp </span>
<span id="cb206-2"><a href="ch-python.html#cb206-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>) <span class="co"># Define the symbol x</span></span>
<span id="cb206-3"><a href="ch-python.html#cb206-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span> <span class="co"># Define a symbolic function f(x) = (x+2)^3</span></span>
<span id="cb206-4"><a href="ch-python.html#cb206-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> sp.diff(f,x) <span class="co"># Take the derivative of f and call it &quot;df&quot;</span></span>
<span id="cb206-5"><a href="ch-python.html#cb206-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f(x) = &quot;</span>, f)</span>
<span id="cb206-6"><a href="ch-python.html#cb206-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f&#39;(x) = &quot;</span>,df)</span>
<span id="cb206-7"><a href="ch-python.html#cb206-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f&#39;(x) = &quot;</span>, sp.expand(df))</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-833" class="example"><strong>Example A.61  </strong></span>Now let’s get the first, second, third, and fourth derivatives of the
function <code>f</code>.
</div>
<div class="sourceCode" id="cb207"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb207-1"><a href="ch-python.html#cb207-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp </span>
<span id="cb207-2"><a href="ch-python.html#cb207-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>) <span class="co"># Define the symbol x</span></span>
<span id="cb207-3"><a href="ch-python.html#cb207-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span> <span class="co"># Define a symbolic function f(x) = (x+2)^3</span></span>
<span id="cb207-4"><a href="ch-python.html#cb207-4" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> sp.diff(f,x,<span class="dv">1</span>) <span class="co"># first derivative</span></span>
<span id="cb207-5"><a href="ch-python.html#cb207-5" aria-hidden="true" tabindex="-1"></a>ddf <span class="op">=</span> sp.diff(f,x,<span class="dv">2</span>) <span class="co"># second deriative</span></span>
<span id="cb207-6"><a href="ch-python.html#cb207-6" aria-hidden="true" tabindex="-1"></a>dddf <span class="op">=</span> sp.diff(f,x,<span class="dv">3</span>) <span class="co"># third deriative</span></span>
<span id="cb207-7"><a href="ch-python.html#cb207-7" aria-hidden="true" tabindex="-1"></a>ddddf <span class="op">=</span> sp.diff(f,x,<span class="dv">4</span>) <span class="co"># fourth deriative</span></span>
<span id="cb207-8"><a href="ch-python.html#cb207-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f&#39;(x) = &quot;</span>,df)</span>
<span id="cb207-9"><a href="ch-python.html#cb207-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f&#39;&#39;(x) = &quot;</span>,sp.simplify(ddf))</span>
<span id="cb207-10"><a href="ch-python.html#cb207-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f&#39;&#39;&#39;(x) = &quot;</span>,sp.simplify(dddf))</span>
<span id="cb207-11"><a href="ch-python.html#cb207-11" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f&#39;&#39;&#39;&#39;(x) = &quot;</span>,sp.simplify(ddddf))</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-835" class="example"><strong>Example A.62  </strong></span>Now let’s do some partial derivatives. The <code>diff</code> command is still the right tool. You just have to tell it which variable you’re working with.
</div>
<div class="sourceCode" id="cb208"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb208-1"><a href="ch-python.html#cb208-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb208-2"><a href="ch-python.html#cb208-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> sp.symbols(<span class="st">&#39;x y&#39;</span>) <span class="co"># Define the symbols</span></span>
<span id="cb208-3"><a href="ch-python.html#cb208-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> sp.sin(x<span class="op">*</span>y) <span class="op">+</span> sp.cos(x<span class="op">**</span><span class="dv">2</span>) <span class="co"># Define the function</span></span>
<span id="cb208-4"><a href="ch-python.html#cb208-4" aria-hidden="true" tabindex="-1"></a>fx <span class="op">=</span> sp.diff(f,x)</span>
<span id="cb208-5"><a href="ch-python.html#cb208-5" aria-hidden="true" tabindex="-1"></a>fy <span class="op">=</span> sp.diff(f,y)</span>
<span id="cb208-6"><a href="ch-python.html#cb208-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f(x,y) = &quot;</span>, f)</span>
<span id="cb208-7"><a href="ch-python.html#cb208-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f_x(x,y) = &quot;</span>, fx)</span>
<span id="cb208-8"><a href="ch-python.html#cb208-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;f_y(x,y) = &quot;</span>, fy)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-837" class="example"><strong>Example A.63  </strong></span>It is worth noting that when you have a symbolically defined function you can ask <code>sympy</code> to give you the LaTeX code for the symbolic function so you can use it when you write about it.
</div>
<div class="sourceCode" id="cb209"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb209-1"><a href="ch-python.html#cb209-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb209-2"><a href="ch-python.html#cb209-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> sp.symbols(<span class="st">&#39;x y&#39;</span>) <span class="co"># Define the symbols</span></span>
<span id="cb209-3"><a href="ch-python.html#cb209-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> sp.sin(x<span class="op">*</span>y) <span class="op">+</span> sp.cos(x<span class="op">**</span><span class="dv">2</span>) <span class="co"># Define the function</span></span>
<span id="cb209-4"><a href="ch-python.html#cb209-4" aria-hidden="true" tabindex="-1"></a>sp.latex(f)</span></code></pre></div>
<hr />
</div>
<div id="integrals" class="section level4" number="7.7.4.2">
<h4><span class="header-section-number">A.7.4.2</span> Integrals</h4>
<p>For integration, the <code>sp.integrate</code> tool is the command for the job: <code>sp.integrate(function, variable)</code> will find an antiderivative and <code>sp.integrate(function, (variable, lower, upper))</code> will evaluate a definite integral.</p>
<p>The <code>integrate</code> command in <code>sympy</code> accepts a symbolically defined function along with the variable of integration and optional bounds. If the bounds aren’t given then the command finds the antiderivative. Otherwise it finds the definite integral.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-839" class="example"><strong>Example A.64  </strong></span>Find the antiderivative of the function <span class="math inline">\(f(x) = (x+2)^3\)</span>.
</div>
<div class="sourceCode" id="cb210"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb210-1"><a href="ch-python.html#cb210-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp </span>
<span id="cb210-2"><a href="ch-python.html#cb210-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb210-3"><a href="ch-python.html#cb210-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb210-4"><a href="ch-python.html#cb210-4" aria-hidden="true" tabindex="-1"></a>F <span class="op">=</span> sp.integrate(f,x)</span>
<span id="cb210-5"><a href="ch-python.html#cb210-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(F)</span></code></pre></div>
<p>The output of these lines of code is the expression <span class="math inline">\(\frac{x^{4}}{4} + 2 x^{3} + 6 x^{2} + 8 x\)</span> which is indeed the antiderivative.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-841" class="example"><strong>Example A.65  </strong></span>Consider the multivariable antiderivative
<span class="math display">\[\int \sin(xy) + \cos(x) dx.\]</span>
The <code>sympy</code> package deals with the second variable just as it should.
</div>
<div class="sourceCode" id="cb211"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb211-1"><a href="ch-python.html#cb211-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp </span>
<span id="cb211-2"><a href="ch-python.html#cb211-2" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> sp.symbols(<span class="st">&#39;x y&#39;</span>)</span>
<span id="cb211-3"><a href="ch-python.html#cb211-3" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> sp.sin(x<span class="op">*</span>y) <span class="op">+</span> sp.cos(x)</span>
<span id="cb211-4"><a href="ch-python.html#cb211-4" aria-hidden="true" tabindex="-1"></a>G <span class="op">=</span> sp.integrate(g,x) </span>
<span id="cb211-5"><a href="ch-python.html#cb211-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(G)</span></code></pre></div>
<p>It is apparent that <code>sympy</code> was sensitive to the fact that there was some trouble at <span class="math inline">\(y=0\)</span> and took care of it with a piece wise function.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-843" class="example"><strong>Example A.66  </strong></span>Consider the integral <span class="math display">\[\int_0^\pi \sin(x) dx.\]</span> Notice that the variable and the bounds are sent to the <code>integrate</code> command as a tuple. Furthermore, notice that we had to send the symbolic version of <span class="math inline">\(\pi\)</span> instead of any other version (e.g. <code>numpy</code>).
</div>
<div class="sourceCode" id="cb212"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb212-1"><a href="ch-python.html#cb212-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb212-2"><a href="ch-python.html#cb212-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb212-3"><a href="ch-python.html#cb212-3" aria-hidden="true" tabindex="-1"></a>sp.integrate( sp.sin(x), (x,<span class="dv">0</span>,sp.pi))</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-845" class="example"><strong>Example A.67  </strong></span>This is a fun one. Let’s do the definite integral
<span class="math display">\[\int_{-\infty}^\infty e^{-x^2} dx.\]</span>
We have to use the “infinity” symbol from <code>sympy</code>. It is two lower-case O’s next to each other: <code>oo</code>. It kind of looks like and infinity I suppose.
</div>
<div class="sourceCode" id="cb213"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb213-1"><a href="ch-python.html#cb213-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb213-2"><a href="ch-python.html#cb213-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb213-3"><a href="ch-python.html#cb213-3" aria-hidden="true" tabindex="-1"></a>sp.integrate( sp.exp(<span class="op">-</span>x<span class="op">**</span><span class="dv">2</span>) , (x, <span class="op">-</span>sp.oo, sp.oo))</span></code></pre></div>
<hr />
</div>
<div id="limits" class="section level4" number="7.7.4.3">
<h4><span class="header-section-number">A.7.4.3</span> Limits</h4>
<p>The <code>limit</code> command in <code>sympy</code> takes symbolic limits: <code>sp.limit(function, variable, value, [direction])</code></p>
<p>The direction (left or right) is optional and if you leave it off then the limit is considered from both directions.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-847" class="example"><strong>Example A.68  </strong></span>Let’s take the limit <span class="math display">\[\lim_{x \to 0} \frac{\sin(x)}{x}.\]</span>
</div>
<div class="sourceCode" id="cb214"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb214-1"><a href="ch-python.html#cb214-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb214-2"><a href="ch-python.html#cb214-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb214-3"><a href="ch-python.html#cb214-3" aria-hidden="true" tabindex="-1"></a>sp.limit( sp.sin(x)<span class="op">/</span>x, x, <span class="dv">0</span>)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-849" class="example"><strong>Example A.69  </strong></span>Let’s do the difference quotient
<span class="math display">\[\lim_{h \to 0} \frac{ f(x+h) - f(x)}{h}\]</span>
for the function <span class="math inline">\(f(x) = (x+2)^3\)</span>. Taking the limit should give the derivative so we’ll check that the <code>diff</code> command gives us the same thing using <code>==</code> …warning!
</div>
<div class="sourceCode" id="cb215"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb215-1"><a href="ch-python.html#cb215-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb215-2"><a href="ch-python.html#cb215-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb215-3"><a href="ch-python.html#cb215-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb215-4"><a href="ch-python.html#cb215-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(sp.diff(f,x))</span>
<span id="cb215-5"><a href="ch-python.html#cb215-5" aria-hidden="true" tabindex="-1"></a>h <span class="op">=</span> sp.Symbol(<span class="st">&#39;h&#39;</span>)</span>
<span id="cb215-6"><a href="ch-python.html#cb215-6" aria-hidden="true" tabindex="-1"></a>df <span class="op">=</span> sp.limit( (f.subs(x,x<span class="op">+</span>h) <span class="op">-</span> f) <span class="op">/</span> h , h , <span class="dv">0</span> )</span>
<span id="cb215-7"><a href="ch-python.html#cb215-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df)</span>
<span id="cb215-8"><a href="ch-python.html#cb215-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df <span class="op">==</span> sp.diff(f,x)) </span>
<span id="cb215-9"><a href="ch-python.html#cb215-9" aria-hidden="true" tabindex="-1"></a><span class="co"># notice that these are not &quot;symbolically&quot; equal</span></span>
<span id="cb215-10"><a href="ch-python.html#cb215-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(df <span class="op">==</span> sp.expand(sp.diff(f,x))) <span class="co"># but these are</span></span></code></pre></div>
<p>Notice that when we check to see if two symbolic functions are equal they must be in the same exact symbolic form. Otherwise <code>sympy</code> won’t recognize them as actually being equal even though they are mathematically equivalent.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-851" class="exercise"><strong>Exercise A.23  </strong></span>Define the function <span class="math inline">\(f(x) = 3x^2 + x\sin(x^2)\)</span> symbolically and then do the following:</p>
<ol style="list-style-type: lower-alpha">
<li>Evaluate the function at <span class="math inline">\(x=2\)</span> and get symbolic and numerical answers.</li>
<li>Take the first and second derivative</li>
<li>Take the antiderivative</li>
<li>Find the definite integral from 0 to 1</li>
<li>Find the limit as <span class="math inline">\(x\)</span> goes to 3</li>
</ol>
</div>
<hr />
</div>
<div id="taylor-series" class="section level4" number="7.7.4.4">
<h4><span class="header-section-number">A.7.4.4</span> Taylor Series</h4>
<p>The <code>sympy</code> package has a tool for expanding Taylor Series of symbolic functions: <code>sp.series( function, variable, [center], [num terms])</code>.</p>
<p>The center defaults to <span class="math inline">\(0\)</span> and the number of terms defaults to <span class="math inline">\(5\)</span>.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-852" class="example"><strong>Example A.70  </strong></span>Find the Taylor series for <span class="math inline">\(f(x) = e^x\)</span> centered at <span class="math inline">\(x=0\)</span> and centered at <span class="math inline">\(x=1\)</span>.
</div>
<div class="sourceCode" id="cb216"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb216-1"><a href="ch-python.html#cb216-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb216-2"><a href="ch-python.html#cb216-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb216-3"><a href="ch-python.html#cb216-3" aria-hidden="true" tabindex="-1"></a>sp.series( sp.exp(x),x)</span></code></pre></div>
<div class="sourceCode" id="cb217"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb217-1"><a href="ch-python.html#cb217-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb217-2"><a href="ch-python.html#cb217-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb217-3"><a href="ch-python.html#cb217-3" aria-hidden="true" tabindex="-1"></a>sp.series( sp.exp(x), x, <span class="dv">1</span>, <span class="dv">3</span>) <span class="co"># expand at x=1 (3 terms)</span></span></code></pre></div>
<p>Finally, if we want more terms then we can send the number of desired
terms to the <code>series</code> command.</p>
<div class="sourceCode" id="cb218"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb218-1"><a href="ch-python.html#cb218-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb218-2"><a href="ch-python.html#cb218-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb218-3"><a href="ch-python.html#cb218-3" aria-hidden="true" tabindex="-1"></a>sp.series( sp.exp(x), x, <span class="dv">0</span>, <span class="dv">3</span>) <span class="co"># expand at x=0 and give 3 terms</span></span></code></pre></div>
<hr />
</div>
</div>
<div id="solving-equations-symbolically" class="section level3" number="7.7.5">
<h3><span class="header-section-number">A.7.5</span> Solving Equations Symbolically</h3>
<p>One of the big reasons to use a symbolic toolboxes such as <code>sympy</code> is to solve algebraic equations exactly. This isn’t always going to be possible, but when it is we get some nice results. The <code>solve</code> command in <code>sympy</code> is the tool for the job: <code>sp.solve( equation, variable )</code></p>
<p>The equation doesn’t actually need to be the whole equation. For any equation-solving problem we can always re-frame it so that we are solving <span class="math inline">\(f(x) = 0\)</span> by subtracting the right-hand side of the equation to the left-hand side. Hence we can leave the equal sign and the zero off and <code>sympy</code> understands what we’re doing.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-856" class="example"><strong>Example A.71  </strong></span>Let’s solve the equation <span class="math inline">\(x^2 - 2 = 0\)</span> for <span class="math inline">\(x\)</span>. We know that the roots are <span class="math inline">\(\pm \sqrt{2}\)</span> so this should be pretty trivial for a symbolic solver.
</div>
<div class="sourceCode" id="cb219"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb219-1"><a href="ch-python.html#cb219-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb219-2"><a href="ch-python.html#cb219-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb219-3"><a href="ch-python.html#cb219-3" aria-hidden="true" tabindex="-1"></a>sp.solve( x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>, x)</span></code></pre></div>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-858" class="example"><strong>Example A.72  </strong></span>Now let’s solve the equation <span class="math inline">\(x^4 - x^2 - 1= 0\)</span> for <span class="math inline">\(x\)</span>. You might recognize this as a quadratic equation in disguise so you can definitely do it by hand ... if you want to. (You could also recognize that this equation is related to the golden ratio!)
</div>
<div class="sourceCode" id="cb220"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb220-1"><a href="ch-python.html#cb220-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb220-2"><a href="ch-python.html#cb220-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb220-3"><a href="ch-python.html#cb220-3" aria-hidden="true" tabindex="-1"></a>sp.solve( x<span class="op">**</span><span class="dv">4</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>, x)</span></code></pre></div>
<p>Run the code yourself to see the output. In nicer LaTeX style formatting, the answer is
<span class="math display">\[\left[ - i \sqrt{- \frac{1}{2} + \frac{\sqrt{5}}{2}}, \  i \sqrt{- \frac{1}{2} + \frac{\sqrt{5}}{2}}, \  - \sqrt{\frac{1}{2} + \frac{\sqrt{5}}{2}}, \  \sqrt{\frac{1}{2} + \frac{\sqrt{5}}{2}}\right]\]</span>
Notice that <code>sympy</code> has no problem dealing with the complex roots.</p>
<hr />
<p>In the previous example the answers may be a bit hard to read due to their symbolic form. This is particularly true for far more complicated equation solving problems. The next example shows how you can loop through the solutions and then print them in decimal form so they are a bit more readable.</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-860" class="example"><strong>Example A.73  </strong></span>We will again solve the equation <span class="math inline">\(x^4 - x^2 - 1= 0\)</span> for <span class="math inline">\(x\)</span>, but this time we will output the answers as floating point decimals. We are using the <code>N</code> command to convert from symbolic to numerical.
</div>
<div class="sourceCode" id="cb221"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb221-1"><a href="ch-python.html#cb221-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb221-2"><a href="ch-python.html#cb221-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb221-3"><a href="ch-python.html#cb221-3" aria-hidden="true" tabindex="-1"></a>soln <span class="op">=</span> sp.solve( x<span class="op">**</span><span class="dv">4</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">1</span>, x)</span>
<span id="cb221-4"><a href="ch-python.html#cb221-4" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> j <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>, <span class="bu">len</span>(soln)):</span>
<span id="cb221-5"><a href="ch-python.html#cb221-5" aria-hidden="true" tabindex="-1"></a>    <span class="bu">print</span>(sp.N(soln[j]))</span></code></pre></div>
<p>The <code>N</code> command gives a numerical approximation for a symbolic expression (this is taken straight from Mathematica!).</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-862" class="exercise"><strong>Exercise A.24  </strong></span>Give the exact and floating point solutions to the equation <span class="math inline">\(x^4 - x^2 - x + 5 = 0\)</span>.
</div>
<hr />
<p>When you want to solve a symbolic equation numerically you can use the <code>nsolve</code> command. This will do something like Newton’s method in the background. You need to give it a starting point where it can look for you the solution to your equation: <code>sp.nsolve( equation, variable, intial guess )</code></p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-863" class="example"><strong>Example A.74  </strong></span>Let’s solve the equation <span class="math inline">\(x^3 - x^2 - 2\)</span> for <span class="math inline">\(x\)</span> both symbolically and numerically. The numerical solution with <code>nsolve</code> will search for the solution near <span class="math inline">\(x=1\)</span>.
</div>
<div class="sourceCode" id="cb222"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb222-1"><a href="ch-python.html#cb222-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb222-2"><a href="ch-python.html#cb222-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb222-3"><a href="ch-python.html#cb222-3" aria-hidden="true" tabindex="-1"></a>ExactSoln <span class="op">=</span> sp.solve(x<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>, x) <span class="co"># symbolic solution</span></span>
<span id="cb222-4"><a href="ch-python.html#cb222-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(ExactSoln)</span></code></pre></div>
<p>Run the code yourself to see the exact solution. In nicer LaTeX style formatting the answer is:
<span class="math display">\[\begin{aligned}
\left[ \frac{1}{3} + \left(- \frac{1}{2} - \frac{\sqrt{3} i}{2}\right)
    \sqrt[3]{\frac{\sqrt{87}}{9} + \frac{28}{27}} + \frac{1}{9 \left(- \frac{1}{2} -
    \frac{\sqrt{3} i}{2}\right) \sqrt[3]{\frac{\sqrt{87}}{9} + \frac{28}{27}}}, \right. \\
    \frac{1}{3} + \frac{1}{9 \left(- \frac{1}{2} + \frac{\sqrt{3} i}{2}\right)
    \sqrt[3]{\frac{\sqrt{87}}{9} + \frac{28}{27}}} + \left(- \frac{1}{2} + \frac{\sqrt{3}
i}{2}\right) \sqrt[3]{\frac{\sqrt{87}}{9} + \frac{28}{27}}, \\
\left. \frac{1}{9 \sqrt[3]{\frac{\sqrt{87}}{9} + \frac{28}{27}}} + \frac{1}{3} + \sqrt[3]{\frac{\sqrt{87}}{9} + \frac{28}{27}}\right]\end{aligned}\]</span>
which is rather challenging to read. We can give all of the floating point approximations with the following code.</p>
<div class="sourceCode" id="cb223"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb223-1"><a href="ch-python.html#cb223-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb223-2"><a href="ch-python.html#cb223-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb223-3"><a href="ch-python.html#cb223-3" aria-hidden="true" tabindex="-1"></a>ExactSoln <span class="op">=</span> sp.solve(x<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>, x) <span class="co"># symbolic solution</span></span>
<span id="cb223-4"><a href="ch-python.html#cb223-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;First Solution: &quot;</span>,sp.N(ExactSoln[<span class="dv">0</span>]))</span>
<span id="cb223-5"><a href="ch-python.html#cb223-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Second Solution: &quot;</span>,sp.N(ExactSoln[<span class="dv">1</span>]))</span>
<span id="cb223-6"><a href="ch-python.html#cb223-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;Third Solution: &quot;</span>,sp.N(ExactSoln[<span class="dv">2</span>]))</span></code></pre></div>
<p>If we were only looking for the floating point real solution near <span class="math inline">\(x=1\)</span> then we could just use <code>nsolve</code>.</p>
<div class="sourceCode" id="cb224"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb224-1"><a href="ch-python.html#cb224-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb224-2"><a href="ch-python.html#cb224-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb224-3"><a href="ch-python.html#cb224-3" aria-hidden="true" tabindex="-1"></a>NumericalSoln <span class="op">=</span> sp.nsolve(x<span class="op">**</span><span class="dv">3</span> <span class="op">-</span> x<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">2</span>, x, <span class="dv">1</span>) <span class="co"># solution near x=1</span></span>
<span id="cb224-4"><a href="ch-python.html#cb224-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(NumericalSoln)</span></code></pre></div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-867" class="exercise"><strong>Exercise A.25  </strong></span>Solve the equation <span class="math display">\[x^3 \ln(x) = 7\]</span> and give your answer both symbolically and numerically.
</div>
<hr />
</div>
<div id="symbolic-plotting" class="section level3" number="7.7.6">
<h3><span class="header-section-number">A.7.6</span> Symbolic Plotting</h3>
<p>In this final section we will show how to make plots of symbolically defined functions. Be careful here. There are times when you want to plot a symbolically defined function and there are times when you want to plot data: <code>sp.plot( function, (variable, left, right) )</code></p>
<p>It is easy to get confused since they both use the <code>plot</code> function in their own packages (<code>sympy</code> and <code>matplotlib</code> respectively).</p>
<p>Note: For MATLAB users, the <code>sympy.plot</code> command is similar to MATLAB’s <code>ezplot</code> command or <code>fplot</code> command.</p>
<p>In numerical analysis we do not often need to make plots of symbolically defined functions. There is more that could be said about <code>sympy</code>’s plotting routine, but since it won’t be used often in this text it doesn’t seem necessary to give those details here. When you need to make a plot just make a careful consideration as to whether you need a
symbolic plot (with <code>sympy</code>) or a plot of data points (with <code>matplotlib</code>).</p>
<hr />

<div class="example">
<span id="exm:unnamed-chunk-868" class="example"><strong>Example A.75  </strong></span>Let’s get a quick plot of the function <span class="math inline">\(f(x) = (x+2)^3\)</span> on the domain <span class="math inline">\(x \in [-5,2]\)</span>.
</div>
<div class="sourceCode" id="cb225"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb225-1"><a href="ch-python.html#cb225-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb225-2"><a href="ch-python.html#cb225-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb225-3"><a href="ch-python.html#cb225-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb225-4"><a href="ch-python.html#cb225-4" aria-hidden="true" tabindex="-1"></a>sp.plot(f,(x,<span class="op">-</span><span class="dv">5</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-870"></span>
<img src="images/Ch07_SymbolicFigure1.png" alt="A plot of a symbolically defined function." width="75%" />
<p class="caption">
Figure A.6: A plot of a symbolically defined function.
</p>
</div>
<hr />

<div class="example">
<p><span id="exm:unnamed-chunk-871" class="example"><strong>Example A.76  </strong></span>Multiple plots can be done at the same time with the <code>sympy.plot</code> command.</p>
Plot <span class="math inline">\(f(x) = (x+2)^3\)</span> and <span class="math inline">\(g(x) = 20\cos(x)\)</span> on the same axes on the domain <span class="math inline">\(x \in [-5,2]\)</span>.
</div>
<div class="sourceCode" id="cb226"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb226-1"><a href="ch-python.html#cb226-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> sympy <span class="im">as</span> sp</span>
<span id="cb226-2"><a href="ch-python.html#cb226-2" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> sp.Symbol(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb226-3"><a href="ch-python.html#cb226-3" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> (x<span class="op">+</span><span class="dv">2</span>)<span class="op">**</span><span class="dv">3</span></span>
<span id="cb226-4"><a href="ch-python.html#cb226-4" aria-hidden="true" tabindex="-1"></a>g <span class="op">=</span> <span class="dv">20</span><span class="op">*</span>sp.cos(x)</span>
<span id="cb226-5"><a href="ch-python.html#cb226-5" aria-hidden="true" tabindex="-1"></a>sp.plot(f, g, (x,<span class="op">-</span><span class="dv">5</span>,<span class="dv">2</span>))</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-873"></span>
<img src="images/Ch07_SymbolicFigure2.png" alt="A second plot of symbolically defined functions." width="75%" />
<p class="caption">
Figure A.7: A second plot of symbolically defined functions.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-874" class="exercise"><strong>Exercise A.26  </strong></span>Make a symbolic plot of the function <span class="math inline">\(f(x) = x^3 \ln(x) - 7\)</span> on the domain <span class="math inline">\([0,3]\)</span>.
</div>

</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="14">
<li id="fn14"><p>Actually, it is still an open mathematical question that <em>every</em> integer seed will converge to 1. The Collatz sequence has been checked for many millions of initial seeds and they all converge to 1, but there is no mathematical proof that it will always happen.<a href="ch-python.html#fnref14" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-pdes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-writing.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"toc_depth": 5
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
