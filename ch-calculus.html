<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>3 Calculus | Numerical Methods</title>
  <meta name="description" content="Inquiry Based Numerical Methods" />
  <meta name="generator" content="bookdown 0.19 and GitBook 2.6.7" />

  <meta property="og:title" content="3 Calculus | Numerical Methods" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Inquiry Based Numerical Methods" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="3 Calculus | Numerical Methods" />
  
  <meta name="twitter:description" content="Inquiry Based Numerical Methods" />
  

<meta name="author" content="Eric Sullivan" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-algebra.html"/>
<link rel="next" href="ch-linearalgebra.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<script src="libs/elevate-section-attrs-2.0/elevate-section-attrs.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />











<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front Matter</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#creative-commons"><i class="fa fa-check"></i>Creative Commons</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#to-the-student"><i class="fa fa-check"></i>To The Student</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-inquiry-based-approach"><i class="fa fa-check"></i>The Inquiry-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#to-the-instructor"><i class="fa fa-check"></i>To the Instructor</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-inquiry-based-approach-1"><i class="fa fa-check"></i>The Inquiry-Based Approach</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-projects"><i class="fa fa-check"></i>The Projects</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#coding"><i class="fa fa-check"></i>Coding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pacing"><i class="fa fa-check"></i>Pacing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-considerations"><i class="fa fa-check"></i>Other Considerations:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> Preliminary Topics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#what-is-numerical-analysis"><i class="fa fa-check"></i><b>1.1</b> What Is Numerical Analysis?</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#arithmetic-in-base-2"><i class="fa fa-check"></i><b>1.2</b> Arithmetic in Base 2</a></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#floating-point-arithmetic"><i class="fa fa-check"></i><b>1.3</b> Floating Point Arithmetic</a></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec:Taylor"><i class="fa fa-check"></i><b>1.4</b> Approximating Functions</a></li>
<li class="chapter" data-level="1.5" data-path="ch-intro.html"><a href="ch-intro.html#approximation-error-with-taylor-series"><i class="fa fa-check"></i><b>1.5</b> Approximation Error with Taylor Series</a></li>
<li class="chapter" data-level="1.6" data-path="ch-intro.html"><a href="ch-intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="ch-intro.html"><a href="ch-intro.html#coding-exercises"><i class="fa fa-check"></i><b>1.6.1</b> Coding Exercises</a></li>
<li class="chapter" data-level="1.6.2" data-path="ch-intro.html"><a href="ch-intro.html#applying-what-youve-learned"><i class="fa fa-check"></i><b>1.6.2</b> Applying What You’ve Learned</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-algebra.html"><a href="ch-algebra.html"><i class="fa fa-check"></i><b>2</b> Algebra</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intro-to-numerical-root-finding"><i class="fa fa-check"></i><b>2.1</b> Intro to Numerical Root Finding</a></li>
<li class="chapter" data-level="2.2" data-path="ch-algebra.html"><a href="ch-algebra.html#the-bisection-method"><i class="fa fa-check"></i><b>2.2</b> The Bisection Method</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation"><i class="fa fa-check"></i><b>2.2.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis"><i class="fa fa-check"></i><b>2.2.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-algebra.html"><a href="ch-algebra.html#the-regula-falsi-method"><i class="fa fa-check"></i><b>2.3</b> The Regula Falsi Method</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-1"><i class="fa fa-check"></i><b>2.3.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.3.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-algebra.html"><a href="ch-algebra.html#newtons-method"><i class="fa fa-check"></i><b>2.4</b> Newton’s Method</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-2"><i class="fa fa-check"></i><b>2.4.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-2"><i class="fa fa-check"></i><b>2.4.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch-algebra.html"><a href="ch-algebra.html#the-secant-method"><i class="fa fa-check"></i><b>2.5</b> The Secant Method</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-3"><i class="fa fa-check"></i><b>2.5.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.5.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-3"><i class="fa fa-check"></i><b>2.5.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-algebra.html"><a href="ch-algebra.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ch-algebra.html"><a href="ch-algebra.html#algorithm-summaries"><i class="fa fa-check"></i><b>2.6.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="2.6.2" data-path="ch-algebra.html"><a href="ch-algebra.html#applying-what-youve-learned-1"><i class="fa fa-check"></i><b>2.6.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="ch-algebra.html"><a href="ch-algebra.html#projects"><i class="fa fa-check"></i><b>2.7</b> Projects</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="ch-algebra.html"><a href="ch-algebra.html#basins-of-attraction"><i class="fa fa-check"></i><b>2.7.1</b> Basins of Attraction</a></li>
<li class="chapter" data-level="2.7.2" data-path="ch-algebra.html"><a href="ch-algebra.html#artillery"><i class="fa fa-check"></i><b>2.7.2</b> Artillery</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-calculus.html"><a href="ch-calculus.html"><i class="fa fa-check"></i><b>3</b> Calculus</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-calculus.html"><a href="ch-calculus.html#intro-to-numerical-calculus"><i class="fa fa-check"></i><b>3.1</b> Intro to Numerical Calculus</a></li>
<li class="chapter" data-level="3.2" data-path="ch-calculus.html"><a href="ch-calculus.html#differentiation"><i class="fa fa-check"></i><b>3.2</b> Differentiation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-calculus.html"><a href="ch-calculus.html#the-first-derivative"><i class="fa fa-check"></i><b>3.2.1</b> The First Derivative</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-calculus.html"><a href="ch-calculus.html#error-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Error Analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-calculus.html"><a href="ch-calculus.html#efficient-coding"><i class="fa fa-check"></i><b>3.2.3</b> Efficient Coding</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-calculus.html"><a href="ch-calculus.html#a-better-first-derivative"><i class="fa fa-check"></i><b>3.2.4</b> A Better First Derivative</a></li>
<li class="chapter" data-level="3.2.5" data-path="ch-calculus.html"><a href="ch-calculus.html#the-second-derivative"><i class="fa fa-check"></i><b>3.2.5</b> The Second Derivative</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-calculus.html"><a href="ch-calculus.html#integration"><i class="fa fa-check"></i><b>3.3</b> Integration</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch-calculus.html"><a href="ch-calculus.html#riemann-sums"><i class="fa fa-check"></i><b>3.3.1</b> Riemann Sums</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch-calculus.html"><a href="ch-calculus.html#trapezoidal-rule"><i class="fa fa-check"></i><b>3.3.2</b> Trapezoidal Rule</a></li>
<li class="chapter" data-level="3.3.3" data-path="ch-calculus.html"><a href="ch-calculus.html#simpsons-rule"><i class="fa fa-check"></i><b>3.3.3</b> Simpsons Rule</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ch-calculus.html"><a href="ch-calculus.html#optimization"><i class="fa fa-check"></i><b>3.4</b> Optimization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch-calculus.html"><a href="ch-calculus.html#single-variable-optimization"><i class="fa fa-check"></i><b>3.4.1</b> Single Variable Optimization</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-calculus.html"><a href="ch-calculus.html#multivariable-optimization"><i class="fa fa-check"></i><b>3.4.2</b> Multivariable Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ch-calculus.html"><a href="ch-calculus.html#calculus-with-numpy-and-scipy"><i class="fa fa-check"></i><b>3.5</b> Calculus with <code>numpy</code> and <code>scipy</code></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch-calculus.html"><a href="ch-calculus.html#differentiation-1"><i class="fa fa-check"></i><b>3.5.1</b> Differentiation</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-calculus.html"><a href="ch-calculus.html#integration-1"><i class="fa fa-check"></i><b>3.5.2</b> Integration</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-calculus.html"><a href="ch-calculus.html#optimization-1"><i class="fa fa-check"></i><b>3.5.3</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch-calculus.html"><a href="ch-calculus.html#least-squares-curve-fitting"><i class="fa fa-check"></i><b>3.6</b> Least Squares Curve Fitting</a></li>
<li class="chapter" data-level="3.7" data-path="ch-calculus.html"><a href="ch-calculus.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="ch-calculus.html"><a href="ch-calculus.html#algorithm-summaries-1"><i class="fa fa-check"></i><b>3.7.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="3.7.2" data-path="ch-calculus.html"><a href="ch-calculus.html#applying-what-youve-learned-2"><i class="fa fa-check"></i><b>3.7.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="ch-calculus.html"><a href="ch-calculus.html#projects-1"><i class="fa fa-check"></i><b>3.8</b> Projects</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="ch-calculus.html"><a href="ch-calculus.html#galaxy-integration"><i class="fa fa-check"></i><b>3.8.1</b> Galaxy Integration</a></li>
<li class="chapter" data-level="3.8.2" data-path="ch-calculus.html"><a href="ch-calculus.html#higher-order-integration"><i class="fa fa-check"></i><b>3.8.2</b> Higher Order Integration</a></li>
<li class="chapter" data-level="3.8.3" data-path="ch-calculus.html"><a href="ch-calculus.html#dam-integration"><i class="fa fa-check"></i><b>3.8.3</b> Dam Integration</a></li>
<li class="chapter" data-level="3.8.4" data-path="ch-calculus.html"><a href="ch-calculus.html#edge-detection-in-images"><i class="fa fa-check"></i><b>3.8.4</b> Edge Detection in Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html"><i class="fa fa-check"></i><b>4</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#intro-to-numerical-linear-algebra"><i class="fa fa-check"></i><b>4.1</b> Intro to Numerical Linear Algebra</a></li>
<li class="chapter" data-level="4.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#vectors-and-matrices-in-python"><i class="fa fa-check"></i><b>4.2</b> Vectors and Matrices in Python</a></li>
<li class="chapter" data-level="4.3" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#matrix-and-vector-operations"><i class="fa fa-check"></i><b>4.3</b> Matrix and Vector Operations</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-dot-product"><i class="fa fa-check"></i><b>4.3.1</b> The Dot Product</a></li>
<li class="chapter" data-level="4.3.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#matrix-multiplication"><i class="fa fa-check"></i><b>4.3.2</b> Matrix Multiplication</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-lu-factorization"><i class="fa fa-check"></i><b>4.4</b> The LU Factorization</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#a-recap-of-row-reduction"><i class="fa fa-check"></i><b>4.4.1</b> A Recap of Row Reduction</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-lu-decomposition"><i class="fa fa-check"></i><b>4.4.2</b> The LU Decomposition</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#solving-triangular-systems"><i class="fa fa-check"></i><b>4.4.3</b> Solving Triangular Systems</a></li>
<li class="chapter" data-level="4.4.4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#solving-systems-with-lu"><i class="fa fa-check"></i><b>4.4.4</b> Solving Systems with LU</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-qr-factorization"><i class="fa fa-check"></i><b>4.5</b> The QR Factorization</a></li>
<li class="chapter" data-level="4.6" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#over-determined-systems-and-curve-fitting"><i class="fa fa-check"></i><b>4.6</b> Over Determined Systems and Curve Fitting</a></li>
<li class="chapter" data-level="4.7" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-eigenvalue-eigenvector-problem"><i class="fa fa-check"></i><b>4.7</b> The Eigenvalue-Eigenvector Problem</a></li>
<li class="chapter" data-level="4.8" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#exercises-3"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#algorithm-summaries-2"><i class="fa fa-check"></i><b>4.8.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="4.8.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#applying-what-youve-learned-3"><i class="fa fa-check"></i><b>4.8.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#projects-2"><i class="fa fa-check"></i><b>4.9</b> Projects</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-google-page-rank-algorithm"><i class="fa fa-check"></i><b>4.9.1</b> The Google Page Rank Algorithm</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-odes.html"><a href="ch-odes.html"><i class="fa fa-check"></i><b>5</b> Ordinary Differential Equations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-odes.html"><a href="ch-odes.html#intro-to-numerical-odes"><i class="fa fa-check"></i><b>5.1</b> Intro to Numerical ODEs</a></li>
<li class="chapter" data-level="5.2" data-path="ch-odes.html"><a href="ch-odes.html#recalling-the-basics-of-odes"><i class="fa fa-check"></i><b>5.2</b> Recalling the Basics of ODEs</a></li>
<li class="chapter" data-level="5.3" data-path="ch-odes.html"><a href="ch-odes.html#eulers-method"><i class="fa fa-check"></i><b>5.3</b> Euler’s Method</a></li>
<li class="chapter" data-level="5.4" data-path="ch-odes.html"><a href="ch-odes.html#the-midpoint-method"><i class="fa fa-check"></i><b>5.4</b> The Midpoint Method</a></li>
<li class="chapter" data-level="5.5" data-path="ch-odes.html"><a href="ch-odes.html#the-runge-kutta-4-method"><i class="fa fa-check"></i><b>5.5</b> The Runge-Kutta 4 Method</a></li>
<li class="chapter" data-level="5.6" data-path="ch-odes.html"><a href="ch-odes.html#animating-ode-solutions"><i class="fa fa-check"></i><b>5.6</b> Animating ODE Solutions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ch-odes.html"><a href="ch-odes.html#ipywidgets.interactive"><i class="fa fa-check"></i><b>5.6.1</b> <code>ipywidgets.interactive</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="ch-odes.html"><a href="ch-odes.html#matplotlib.animation"><i class="fa fa-check"></i><b>5.6.2</b> <code>matplotlib.animation</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ch-odes.html"><a href="ch-odes.html#the-backwards-euler-method"><i class="fa fa-check"></i><b>5.7</b> The Backwards Euler Method</a></li>
<li class="chapter" data-level="5.8" data-path="ch-odes.html"><a href="ch-odes.html#fitting-ode-models-to-data"><i class="fa fa-check"></i><b>5.8</b> Fitting ODE Models to Data</a></li>
<li class="chapter" data-level="5.9" data-path="ch-odes.html"><a href="ch-odes.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="ch-odes.html"><a href="ch-odes.html#algorithm-summaries-3"><i class="fa fa-check"></i><b>5.9.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="5.9.2" data-path="ch-odes.html"><a href="ch-odes.html#applying-what-youve-learned-4"><i class="fa fa-check"></i><b>5.9.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="ch-odes.html"><a href="ch-odes.html#projects-3"><i class="fa fa-check"></i><b>5.10</b> Projects</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="ch-odes.html"><a href="ch-odes.html#the-covid-19-pandemic"><i class="fa fa-check"></i><b>5.10.1</b> The COVID-19 Pandemic</a></li>
<li class="chapter" data-level="5.10.2" data-path="ch-odes.html"><a href="ch-odes.html#pain-management"><i class="fa fa-check"></i><b>5.10.2</b> Pain Management</a></li>
<li class="chapter" data-level="5.10.3" data-path="ch-odes.html"><a href="ch-odes.html#the-h1n1-virus"><i class="fa fa-check"></i><b>5.10.3</b> The H1N1 Virus</a></li>
<li class="chapter" data-level="5.10.4" data-path="ch-odes.html"><a href="ch-odes.html#the-artillery-problem"><i class="fa fa-check"></i><b>5.10.4</b> The Artillery Problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-pdes.html"><a href="ch-pdes.html"><i class="fa fa-check"></i><b>6</b> Partial Differential Equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-pdes.html"><a href="ch-pdes.html#intro-to-pdes"><i class="fa fa-check"></i><b>6.1</b> Intro to PDEs</a></li>
<li class="chapter" data-level="6.2" data-path="ch-pdes.html"><a href="ch-pdes.html#solutions-to-pdes"><i class="fa fa-check"></i><b>6.2</b> Solutions to PDEs</a></li>
<li class="chapter" data-level="6.3" data-path="ch-pdes.html"><a href="ch-pdes.html#boundary-conditions"><i class="fa fa-check"></i><b>6.3</b> Boundary Conditions</a></li>
<li class="chapter" data-level="6.4" data-path="ch-pdes.html"><a href="ch-pdes.html#the-heat-equation"><i class="fa fa-check"></i><b>6.4</b> The Heat Equation</a></li>
<li class="chapter" data-level="6.5" data-path="ch-pdes.html"><a href="ch-pdes.html#stability-of-the-heat-equation-solution"><i class="fa fa-check"></i><b>6.5</b> Stability of the Heat Equation Solution</a></li>
<li class="chapter" data-level="6.6" data-path="ch-pdes.html"><a href="ch-pdes.html#the-wave-equation"><i class="fa fa-check"></i><b>6.6</b> The Wave Equation</a></li>
<li class="chapter" data-level="6.7" data-path="ch-pdes.html"><a href="ch-pdes.html#traveling-waves"><i class="fa fa-check"></i><b>6.7</b> Traveling Waves</a></li>
<li class="chapter" data-level="6.8" data-path="ch-pdes.html"><a href="ch-pdes.html#the-laplace-and-poisson-equations"><i class="fa fa-check"></i><b>6.8</b> The Laplace and Poisson Equations</a></li>
<li class="chapter" data-level="6.9" data-path="ch-pdes.html"><a href="ch-pdes.html#exercises-5"><i class="fa fa-check"></i><b>6.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="ch-pdes.html"><a href="ch-pdes.html#algorithm-summaries-4"><i class="fa fa-check"></i><b>6.9.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="6.9.2" data-path="ch-pdes.html"><a href="ch-pdes.html#applying-what-youve-learned-5"><i class="fa fa-check"></i><b>6.9.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="ch-pdes.html"><a href="ch-pdes.html#projects-4"><i class="fa fa-check"></i><b>6.10</b> Projects</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="ch-pdes.html"><a href="ch-pdes.html#hunting-and-diffusion"><i class="fa fa-check"></i><b>6.10.1</b> Hunting and Diffusion</a></li>
<li class="chapter" data-level="6.10.2" data-path="ch-pdes.html"><a href="ch-pdes.html#heating-adobe-houses"><i class="fa fa-check"></i><b>6.10.2</b> Heating Adobe Houses</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="ch-python.html"><a href="ch-python.html"><i class="fa fa-check"></i><b>A</b> Introduction to Python</a>
<ul>
<li class="chapter" data-level="A.1" data-path="ch-python.html"><a href="ch-python.html#why-python"><i class="fa fa-check"></i><b>A.1</b> Why Python?</a></li>
<li class="chapter" data-level="A.2" data-path="ch-python.html"><a href="ch-python.html#getting-started"><i class="fa fa-check"></i><b>A.2</b> Getting Started</a></li>
<li class="chapter" data-level="A.3" data-path="ch-python.html"><a href="ch-python.html#hello-world"><i class="fa fa-check"></i><b>A.3</b> Hello, World!</a></li>
<li class="chapter" data-level="A.4" data-path="ch-python.html"><a href="ch-python.html#python-programming-basics"><i class="fa fa-check"></i><b>A.4</b> Python Programming Basics</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="ch-python.html"><a href="ch-python.html#variables"><i class="fa fa-check"></i><b>A.4.1</b> Variables</a></li>
<li class="chapter" data-level="A.4.2" data-path="ch-python.html"><a href="ch-python.html#indexing-and-lists"><i class="fa fa-check"></i><b>A.4.2</b> Indexing and Lists</a></li>
<li class="chapter" data-level="A.4.3" data-path="ch-python.html"><a href="ch-python.html#list-operations"><i class="fa fa-check"></i><b>A.4.3</b> List Operations</a></li>
<li class="chapter" data-level="A.4.4" data-path="ch-python.html"><a href="ch-python.html#tuples"><i class="fa fa-check"></i><b>A.4.4</b> Tuples</a></li>
<li class="chapter" data-level="A.4.5" data-path="ch-python.html"><a href="ch-python.html#control-flow-loops-and-if-statements"><i class="fa fa-check"></i><b>A.4.5</b> Control Flow: Loops and If Statements</a></li>
<li class="chapter" data-level="A.4.6" data-path="ch-python.html"><a href="ch-python.html#functions"><i class="fa fa-check"></i><b>A.4.6</b> Functions</a></li>
<li class="chapter" data-level="A.4.7" data-path="ch-python.html"><a href="ch-python.html#lambda-functions"><i class="fa fa-check"></i><b>A.4.7</b> Lambda Functions</a></li>
<li class="chapter" data-level="A.4.8" data-path="ch-python.html"><a href="ch-python.html#packages"><i class="fa fa-check"></i><b>A.4.8</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="ch-python.html"><a href="ch-python.html#numerical-python-with-numpy"><i class="fa fa-check"></i><b>A.5</b> Numerical Python with <code>numpy</code></a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="ch-python.html"><a href="ch-python.html#numpy-arrays-array-operations-and-matrix-operations"><i class="fa fa-check"></i><b>A.5.1</b> Numpy Arrays, Array Operations, and Matrix Operations</a></li>
<li class="chapter" data-level="A.5.2" data-path="ch-python.html"><a href="ch-python.html#arange-linspace-zeros-ones-and-meshgrid"><i class="fa fa-check"></i><b>A.5.2</b> <code>arange, linspace, zeros, ones</code>, and <code>meshgrid</code></a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="ch-python.html"><a href="ch-python.html#plotting-with-matplotlib"><i class="fa fa-check"></i><b>A.6</b> Plotting with <code>matplotlib</code></a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="ch-python.html"><a href="ch-python.html#basics-with-plt.plot"><i class="fa fa-check"></i><b>A.6.1</b> Basics with <code>plt.plot()</code></a></li>
<li class="chapter" data-level="A.6.2" data-path="ch-python.html"><a href="ch-python.html#subplots"><i class="fa fa-check"></i><b>A.6.2</b> Subplots</a></li>
<li class="chapter" data-level="A.6.3" data-path="ch-python.html"><a href="ch-python.html#logarithmic-scaling-with-semilogy-semilogx-and-loglog"><i class="fa fa-check"></i><b>A.6.3</b> Logarithmic Scaling with <code>semilogy</code>, <code>semilogx</code>, and <code>loglog</code></a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="ch-python.html"><a href="ch-python.html#symbolic-python-with-sympy"><i class="fa fa-check"></i><b>A.7</b> Symbolic Python with <code>sympy</code></a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="ch-python.html"><a href="ch-python.html#symbolic-variables-with-symbols"><i class="fa fa-check"></i><b>A.7.1</b> Symbolic Variables with <code>symbols</code></a></li>
<li class="chapter" data-level="A.7.2" data-path="ch-python.html"><a href="ch-python.html#symbolic-algebra"><i class="fa fa-check"></i><b>A.7.2</b> Symbolic Algebra</a></li>
<li class="chapter" data-level="A.7.3" data-path="ch-python.html"><a href="ch-python.html#symbolic-function-evaluation"><i class="fa fa-check"></i><b>A.7.3</b> Symbolic Function Evaluation</a></li>
<li class="chapter" data-level="A.7.4" data-path="ch-python.html"><a href="ch-python.html#symbolic-calculus"><i class="fa fa-check"></i><b>A.7.4</b> Symbolic Calculus</a></li>
<li class="chapter" data-level="A.7.5" data-path="ch-python.html"><a href="ch-python.html#solving-equations-symbolically"><i class="fa fa-check"></i><b>A.7.5</b> Solving Equations Symbolically</a></li>
<li class="chapter" data-level="A.7.6" data-path="ch-python.html"><a href="ch-python.html#symbolic-plotting"><i class="fa fa-check"></i><b>A.7.6</b> Symbolic Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="ch-writing.html"><a href="ch-writing.html"><i class="fa fa-check"></i><b>B</b> Mathematical Writing</a>
<ul>
<li class="chapter" data-level="B.1" data-path="ch-writing.html"><a href="ch-writing.html#the-paper"><i class="fa fa-check"></i><b>B.1</b> The Paper</a></li>
<li class="chapter" data-level="B.2" data-path="ch-writing.html"><a href="ch-writing.html#figures-and-tables"><i class="fa fa-check"></i><b>B.2</b> Figures and Tables</a></li>
<li class="chapter" data-level="B.3" data-path="ch-writing.html"><a href="ch-writing.html#writing-style"><i class="fa fa-check"></i><b>B.3</b> Writing Style</a></li>
<li class="chapter" data-level="B.4" data-path="ch-writing.html"><a href="ch-writing.html#tips-for-writing-clear-math"><i class="fa fa-check"></i><b>B.4</b> Tips For Writing Clear Math</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="ch-writing.html"><a href="ch-writing.html#audience"><i class="fa fa-check"></i><b>B.4.1</b> Audience</a></li>
<li class="chapter" data-level="B.4.2" data-path="ch-writing.html"><a href="ch-writing.html#how-to-make-mathematics-readable-10-things-to-do"><i class="fa fa-check"></i><b>B.4.2</b> How To Make Mathematics Readable – 10 Things To Do</a></li>
<li class="chapter" data-level="B.4.3" data-path="ch-writing.html"><a href="ch-writing.html#some-writing-tips"><i class="fa fa-check"></i><b>B.4.3</b> Some Writing Tips</a></li>
<li class="chapter" data-level="B.4.4" data-path="ch-writing.html"><a href="ch-writing.html#mathematical-vocabulary"><i class="fa fa-check"></i><b>B.4.4</b> Mathematical Vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="ch-writing.html"><a href="ch-writing.html#sensitivity-analysis"><i class="fa fa-check"></i><b>B.5</b> Sensitivity Analysis</a>
<ul>
<li class="chapter" data-level="B.5.1" data-path="ch-writing.html"><a href="ch-writing.html#example-of-sensitivity-analysis"><i class="fa fa-check"></i><b>B.5.1</b> Example of Sensitivity Analysis</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="C" data-path="ch-extras.html"><a href="ch-extras.html"><i class="fa fa-check"></i><b>C</b> Optional Material</a>
<ul>
<li class="chapter" data-level="C.1" data-path="ch-extras.html"><a href="ch-extras.html#interpolation"><i class="fa fa-check"></i><b>C.1</b> Interpolation</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="ch-extras.html"><a href="ch-extras.html#vandermonde-interpolation"><i class="fa fa-check"></i><b>C.1.1</b> Vandermonde Interpolation</a></li>
<li class="chapter" data-level="C.1.2" data-path="ch-extras.html"><a href="ch-extras.html#lagrange-interpolation"><i class="fa fa-check"></i><b>C.1.2</b> Lagrange Interpolation</a></li>
<li class="chapter" data-level="C.1.3" data-path="ch-extras.html"><a href="ch-extras.html#chebyshev-points"><i class="fa fa-check"></i><b>C.1.3</b> Chebyshev Points</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="ch-extras.html"><a href="ch-extras.html#sec:mv_newton"><i class="fa fa-check"></i><b>C.2</b> Multi-Dimensional Newton’s Method</a></li>
<li class="chapter" data-level="C.3" data-path="ch-extras.html"><a href="ch-extras.html#the-method-of-lines"><i class="fa fa-check"></i><b>C.3</b> The Method Of Lines</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Numerical Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch:calculus" class="section level1" number="3">
<h1><span class="header-section-number">3</span> Calculus</h1>
<div id="intro-to-numerical-calculus" class="section level2" number="3.1">
<h2><span class="header-section-number">3.1</span> Intro to Numerical Calculus</h2>
<blockquote>
<p><em>The calculus was the first achievement of modern mathematics and it is difficult to overestimate its importance.</em><br />
–<a href="https://en.wikipedia.org/wiki/John_von_Neumann">Hungarian-American Mathematician John von Neumann</a></p>
</blockquote>
<p>In this chapter we build some of the common techniques for approximating
the two primary computations in calculus: taking derivatives and
evaluating definite integrals. Beyond differentiation and integration one of the major applications of differential calculus was optimization. The last several sections of this chapter focus on numerical routines for approximating the solutions to optimization problems. To see an introduction video for this chapter go to <a href="https://youtu.be/58zrgdf1cdY">https://youtu.be/58zrgdf1cdY</a>.</p>
<p>Recall the typical techniques from differential calculus: the power rule, the chain rule, the product rule, the quotient rule, the differentiation rules for exponentials, inverses, and trig functions, implicit differentiation, etc. With these rules, and enough time and patience, we can find a derivative of any algebraically defined function. The truth of the matter is that not all functions are given to us algebraically, and even the ones that are given algebraically are sometimes really cumbersome.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-132" class="exercise"><strong>Exercise 3.1  </strong></span>A water quality engineering team wants to find the rate at which the
volume of waste water is changing in their containment pond throughout
the year. They presently only have data on the specific geometric shape
of the containment pond as well as the depth of the waste water each day
for the past year. Propose several methods for approximating the first
derivative of the volume of the waste water pond.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-133" class="exercise"><strong>Exercise 3.2  </strong></span>When a police officer fires a radar gun at a moving car it uses a laser
to measure the distance from the officer to the car:</p>
<ul>
<li><p>The speed of light is constant.</p></li>
<li><p>The time between when the laser is fired and when the light
reflected off of the car is received can be measured very
accurately.</p></li>
<li><p>Using the formula <span class="math inline">\(\text{distance} = \text{rate} \cdot \text{time}\)</span>,
the time for the laser pulse to be sent and received can then be
converted to a distance.</p></li>
</ul>
How does the radar gun then use that information to calculate the speed
of the moving car?
</div>
<hr />
<p>Integration, on the other hand, is a more difficult situation. You may
recall some of the techniques of integral calculus such as the power
rule, <span class="math inline">\(u\)</span>-substitution, and integration by parts. However, these tools
are not enough to find an antiderviative for any given function.
Furthermore, not every function can be written algebraically.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-134" class="exercise"><strong>Exercise 3.3  </strong></span>In statistics the function known as <em>the normal distribution</em> (the bell
curve) is defined as <span class="math display">\[N(x) = \frac{1}{\sqrt{2\pi}} e^{-x^2/2}.\]</span> One of
the primary computations of introductory statistics is to find the area
under a portion of this curve since this area gives the probability of
some event
<span class="math display">\[P(a &lt; x &lt; b) = \int_a^b \frac{1}{\sqrt{2\pi}} e^{-x^2/2} dx.\]</span> The
trouble is that there is no known antiderivative of this function.
Propose a method for approximating this area.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-135" class="exercise"><strong>Exercise 3.4  </strong></span>Give a list of five functions for which an exact algebraic derivative is
relatively easy but an exact antiderivative is either very hard or maybe
impossible. Be prepared to compare with your peers.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-136" class="exercise"><strong>Exercise 3.5  </strong></span>A dam operator has control of the rate at which water is flowing out of
a hydroelectric dam. He has records for the approximate flow rate
through the dam over the course of a day. Propose a way for the operator
to use his data to determine the total amount of water that has passed
through the dam during that day.
</div>
<hr />
<p>What you’ve seen here are just a few examples of why you might need to
use numerical calculus instead of the classical routines that you
learned earlier in your mathematical career. Another typical need for
numerical derivatives and integrals arises when we approximate the
solutions to differential equations in the later chapters of this book.</p>
<p>Throughout this chapter we will make heavy use of Taylor’s Theorem to
build approximations of derivatives and integrals. If you find yourself
still a bit shaky on Taylor’s Theorem it would probably be wise to go
back to Section <a href="ch-intro.html#sec:Taylor">1.4</a> and do a quick review.</p>
<p>At the end of the chapter
we’ll examine a numerical technique for solving optimization problems
without explicitly finding derivatives. Then we’ll look at a common use
of numerical calculus for fitting curves to data.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="differentiation" class="section level2" number="3.2">
<h2><span class="header-section-number">3.2</span> Differentiation</h2>
<div id="the-first-derivative" class="section level3" number="3.2.1">
<h3><span class="header-section-number">3.2.1</span> The First Derivative</h3>

<div class="exercise">
<p><span id="exr:unnamed-chunk-137" class="exercise"><strong>Exercise 3.6  </strong></span>Recall from your first-semester Calculus class that the derivative of a
function <span class="math inline">\(f(x)\)</span> is defined as
<span class="math display">\[f&#39;(x) = \lim_{\Delta x \to 0} \frac{f(x+\Delta x) - f(x)}{\Delta x}\]</span>
A Calculus student proposes that it would just be much easier if we
dropped the limit and instead just always choose <span class="math inline">\(\Delta x\)</span> to be some
small number, like <span class="math inline">\(0.001\)</span> or <span class="math inline">\(10^{-6}\)</span>. Discuss the following questions:</p>
<ol style="list-style-type: lower-alpha">
<li><p>When might the Calculus student’s proposal actually work pretty well
in place of calculating an actual derivative?</p></li>
<li><p>When might the Calculus student’s proposal fail in terms of approximating the derivative?</p></li>
</ol>
</div>
<hr />
<p>In this section we’ll build several approximation of first and second
derivatives. The primary idea for each of these approximations is:</p>
<ul>
<li>Partition the interval <span class="math inline">\([a,b]\)</span> into <span class="math inline">\(N\)</span> sub intervals</li>
<li>Define the distance between two points in the partition as <span class="math inline">\(h\)</span>.<br />
</li>
<li>Approximate the derivative at any point <span class="math inline">\(x\)</span> in the interval <span class="math inline">\([a,b]\)</span> by using linear combinations of <span class="math inline">\(f(x-h)\)</span>, <span class="math inline">\(f(x)\)</span>, <span class="math inline">\(f(x+h)\)</span>, and/or other points in the partition.</li>
</ul>
<p>Partitioning the interval into discrete points turns the continuous
problem of finding a derivative at every real point in <span class="math inline">\([a,b]\)</span> into a
discrete problem where we calculate the approximate derivative at
finitely many points in <span class="math inline">\([a,b]\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:differentiation-partition"></span>
<img src="images/Ch03_IntervalPartition.png" alt="A partition of the interval $[a,b]$." width="75%" />
<p class="caption">
Figure 3.1: A partition of the interval <span class="math inline">\([a,b]\)</span>.
</p>
</div>
<p>Figure <a href="ch-calculus.html#fig:differentiation-partition">3.1</a> shows a depiction of the
partition as well as making clear that <span class="math inline">\(h\)</span> is the separation between
each of the points in the partition. Note that in general the points in
the partition do not need to be equally spaced, but that is the simplest
place to start.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-138" class="exercise"><strong>Exercise 3.7  </strong></span>Let’s take a close look at partitions before moving on to more details about numerical differentiation.</p>
<ol style="list-style-type: lower-alpha">
<li>If we partition the interval <span class="math inline">\([0,1]\)</span> into <span class="math inline">\(3\)</span> equal sub intervals each with length <span class="math inline">\(h\)</span> then:
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(h = \underline{\hspace{1in}}\)</span></li>
<li><span class="math inline">\([0,1] = [0,\underline{\hspace{0.25in}}] \cup [\underline{\hspace{0.25in}},\underline{\hspace{0.25in}}] \cup [\underline{\hspace{0.25in}},1]\)</span></li>
<li>There are four total points that define the partition. They are <span class="math inline">\(0, ??, ??, 1\)</span>.</li>
</ol></li>
<li>If we partition the interval <span class="math inline">\([3,7]\)</span> into <span class="math inline">\(5\)</span> equal sub intervals each with length <span class="math inline">\(h\)</span> then:
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(h = \underline{\hspace{1in}}\)</span></li>
<li><span class="math inline">\([3,7] = [3,\underline{\hspace{0.25in}}] \cup [\underline{\hspace{0.25in}},\underline{\hspace{0.25in}}] \cup [\underline{\hspace{0.25in}},\underline{\hspace{0.25in}}] \cup [\underline{\hspace{0.25in}},\underline{\hspace{0.25in}}] \cup [\underline{\hspace{0.25in}},7]\)</span></li>
<li>There are 6 total points that define the partition. They are <span class="math inline">\(0, ??, ??, ??, ??, 7\)</span>.</li>
</ol></li>
<li>More generally, if a closed interval <span class="math inline">\([a,b]\)</span> contains <span class="math inline">\(N\)</span> equal sub intervals where
<span class="math display">\[ [a,b] = \underbrace{[a,a+h] \cup [a+h, a+2h] \cup \cdots \cup [b-2h,b-h] \cup [b-h,b]}_{\text{$N$ total sub intervals}} \]</span>
then the length of each sub interval, <span class="math inline">\(h\)</span>, is given by the formula
<span class="math display">\[ h = \frac{?? - ??}{??}. \]</span></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-139" class="exercise"><strong>Exercise 3.8  </strong></span>In Python’s <code>numpy</code> library there is a nice tool called <code>np.linspace()</code> that partitions an interval in exactly the way that we want. The command takes the form <code>np.linspace(a, b, n)</code> where the interval is <span class="math inline">\([a,b]\)</span> and <span class="math inline">\(n\)</span> the number of points used to create the partition. For example, <code>np.linspace(0,1,5)</code> will produce the list of numbers <code>0, 0.25, 0.5, 0.75, 1</code>. Notice that there are 5 total points, the first point is <span class="math inline">\(a\)</span>, the last point is <span class="math inline">\(b\)</span>, and there are <span class="math inline">\(n-1\)</span> total sub intervals in the partition. Hence, if we want to partition the interval <span class="math inline">\([0,1]\)</span> into 20 equal sub intervals then we would use the command <code>np.linspace(0,1,21)</code> which would result in a list of numbers starting with <code>0, 0.05, 0.1, 0.15,</code> etc. What command would you use to partition the interval <span class="math inline">\([5,10]\)</span> into <span class="math inline">\(100\)</span> equal sub intervals?
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-140" class="exercise"><strong>Exercise 3.9  </strong></span>Consider the Python command <code>np.linspace(0,1,50)</code>.</p>
<ol style="list-style-type: lower-alpha">
<li>What interval does this command partition?</li>
<li>How many points are going to be returned?</li>
<li>How many equal length subintervals will we have in the resulting partition?</li>
<li>What is the length of each of the subintervals in the resulting partition?</li>
</ol>
</div>
<hr />
<p>Now let’s get back to the discussion of numerical differentiation. If we recall that the definition of the first derivative of a function is
<span class="math display">\[ \begin{aligned}
    \frac{df}{dx} = \lim_{h \to 0} \frac{f(x+h) - f(x)}{h}.
    \label{eqn:derivative_defintiion}\end{aligned}\]</span>
our first approximation for the first derivative is naturally
<span class="math display">\[ \begin{aligned}
    \frac{df}{dx} \approx \frac{f(x+h) - f(x)}{h}.
    \label{eqn:derivative_first_approx}\end{aligned}\]</span>
In this approximation of the derivative we have simply removed the
limit and instead approximated the derivative as the slope. It should be
clear that this approximation is only good if <span class="math inline">\(h\)</span> is <em>small</em>. In Figure <a href="ch-calculus.html#fig:forward-difference">3.2</a> we see a graphical depiction of what we’re doing to approximate the derivative. The slope of the tangent line (<span class="math inline">\(\Delta y / \Delta x\)</span>) is what we’re after, and a way to approximate it is to calculate the slope of the secant line formed by looking <span class="math inline">\(h\)</span> units forward from the point <span class="math inline">\(x\)</span>.</p>
<div class="figure" style="text-align: center"><span id="fig:forward-difference"></span>
<img src="images/Ch03_ForwardDifferenceDiagram.png" alt="The forward difference differentiation scheme for the first derivative." width="75%" />
<p class="caption">
Figure 3.2: The forward difference differentiation scheme for the first derivative.
</p>
</div>
<p>While this is the simplest and most obvious approximation for the first derivative there is a much more elegant technique, using Taylor series, for arriving at this approximation. Furthermore, the Taylor series technique suggests an infinite family of other techniques.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-141" class="exercise"><strong>Exercise 3.10  </strong></span>From Taylor’s
Theorem we know that for an infinitely differentiable function <span class="math inline">\(f(x)\)</span>,
<span class="math display">\[f(x) = f(x_0) + \frac{f&#39;(x_0)}{1!} (x-x_0)^1 + \frac{f&#39;&#39;(x_0)}{2!}(x-x_0)^2 +
        \frac{f^{(3)}(x_0)}{3!}(x-x_0)^3 + \cdots.\]</span>
What do we get if we replace every “<span class="math inline">\(x\)</span>” in the Taylor Series with “<span class="math inline">\(x+h\)</span>” and replace every “<span class="math inline">\(x_0\)</span>” in the Taylor Series with “<span class="math inline">\(x\)</span>”? In other
words, in Figure <a href="ch-calculus.html#fig:differentiation-partition">3.1</a> we want to center the Taylor
series at <span class="math inline">\(x\)</span> and evaluate the resulting series at the point <span class="math inline">\(x+h\)</span>.
<span class="math display">\[f(x+h) = \underline{\hspace{3in}}\]</span>
</div>
<hr />

<div class="exercise">
<span id="exr:num-diff-first-order" class="exercise"><strong>Exercise 3.11  </strong></span>Solve the result from the previous problem for <span class="math inline">\(f&#39;(x)\)</span> to create an approximation for <span class="math inline">\(f&#39;(x)\)</span> using
<span class="math inline">\(f(x+h)\)</span>, <span class="math inline">\(f(x)\)</span>, and some higher order terms. (fill in the blanks and
the question marks)
<span class="math display">\[f&#39;(x) = \frac{f(x+h) - ???}{??} + \underline{\hspace{2in}}\]</span>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-142" class="exercise"><strong>Exercise 3.12  </strong></span>In the formula that you developed in Exercise <a href="ch-calculus.html#exr:num-diff-first-order">3.11</a>, if we were to drop everything after the fraction (called the <em>remainder</em>) we know that we would be introducing error into our derivative computation. If <span class="math inline">\(h\)</span> is taken to be very small then the first term in the remainder is the largest and everything else in the remainder can be ignored (since all subsequent terms should be extremely small … pause and ponder this fact). Therefore, the amount of error we make in the derivative computation by dropping the remainder depends on the power of <span class="math inline">\(h\)</span> in that first term in the remainder.</p>
What is the power of <span class="math inline">\(h\)</span> in the first term of the remainder from Exercise <a href="ch-calculus.html#exr:num-diff-first-order">3.11</a>?
</div>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-143" class="definition"><strong>Definition 3.1  (Order of a Numerical Differentiation Scheme)  </strong></span>The <strong>order</strong> of a numerical derivative is the power of the step size in
the first term of the remainder of the rearranged Taylor Series. For example, a first order method will have “<span class="math inline">\(h^1\)</span>” in the first term of the remainder. A second order method will have “<span class="math inline">\(h^2\)</span>” in the first term of the remainder. Etc.</p>
The error that you make by dropping the remainder is proportional to the power of <span class="math inline">\(h\)</span> in the first term of the remainder. Hence, the <strong>order</strong> of a numerical differentiation scheme tells you how to quantify the amount of error that you are making by using that approximation scheme.
</div>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-144" class="definition"><strong>Definition 3.2  (Big O Notation)  </strong></span>We say that the error in a differentiation scheme is <span class="math inline">\(\mathcal{O}(h)\)</span> (read: “big O of <span class="math inline">\(h\)</span>”),
if and only if there is a positive constant <span class="math inline">\(M\)</span> such that
<span class="math display">\[ |Error| \le M \cdot h.\]</span>
This is equivalent to saying that a differentiation method is “first order”. In other words, if the error in a numerical differentiation scheme is proportional to the length of the subinterval in the partition of the interval (see Figure <a href="ch-calculus.html#fig:differentiation-partition">3.1</a>) then we call that scheme “first order” and say that the error is <span class="math inline">\(\mathcal{O}(h)\)</span>.</p>
More generally, we say that the error in a differentiation scheme is <span class="math inline">\(\mathcal{O}(h^k)\)</span> (read: “big O of <span class="math inline">\(h^k\)</span>”) if and only if there is a positive constant <span class="math inline">\(M\)</span> such that
<span class="math display">\[ |Error| \leq M \cdot h^k. \]</span>
This is equivalent to saying that a differentiation scheme is “<span class="math inline">\(k^{th}\)</span> order”. This means that the error in using the scheme is proportional to <span class="math inline">\(h^k\)</span>.
</div>
<hr />

<div class="theorem">
<p><span id="thm:first-order-first-deriv" class="theorem"><strong>Theorem 3.1  </strong></span>In problem <a href="ch-calculus.html#exr:num-diff-first-order">3.11</a> we derived a first order approximation of the first derivative:
<span class="math display">\[ f&#39;(x) = \frac{f(x+h) - f(x)}{h} + \mathcal{O}(h).\]</span>
In this formula, <span class="math inline">\(h = \Delta x\)</span> is the step size.</p>
If we approximate the first derivative of a differentiable function <span class="math inline">\(f(x)\)</span> at the point <span class="math inline">\(x\)</span> with the formula
<span class="math display">\[ f&#39;(x) \approx \frac{f(x+h)-f(x)}{h} \]</span>
then we know that the error in this approximation is proprotional to <span class="math inline">\(h\)</span> since the approximation scheme is <span class="math inline">\(\mathcal{O}(h)\)</span>.
</div>
<hr />
</div>
<div id="error-analysis" class="section level3" number="3.2.2">
<h3><span class="header-section-number">3.2.2</span> Error Analysis</h3>

<div class="exercise">
<p><span id="exr:deriv-error-analysis-ex" class="exercise"><strong>Exercise 3.13  </strong></span>Consider the function
<span class="math inline">\(f(x) = \sin(x) (1- x)\)</span>. The goal of this problem is to make sense of
the discussion of the “order” of the derivative approximation. You may
want to pause first and reread the previous couple of pages.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find <span class="math inline">\(f&#39;(x)\)</span> by hand.</p></li>
<li><p>Use your answer to part (a) to verify that <span class="math inline">\(f&#39;(1) = -\sin(1) \approx  -0.8414709848\)</span>.</p></li>
<li><p>To approximate the first derivative at <span class="math inline">\(x=1\)</span> numerically with our first order approximation formula from Theorem <a href="ch-calculus.html#thm:first-order-first-deriv">3.1</a> we calculate
<span class="math display">\[ f&#39;(1) \approx \frac{f(1+h) - f(1)}{h}.\]</span>
We want to see how the error in the approximation behaves as <span class="math inline">\(h\)</span> is made smaller and smaller. Fill in the table below with the derivative approximation and the absolute error associated with each given <span class="math inline">\(h\)</span>. You may want to use a spreadsheet to organize your data (be sure that you’re working in radians!).</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(h\)</span></th>
<th align="center">Approx. of <span class="math inline">\(f&#39;(1)\)</span></th>
<th align="center">Exact value of <span class="math inline">\(f&#39;(1)\)</span></th>
<th align="center">Abs. % Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-1} = 0.5\)</span></td>
<td align="center"><span class="math inline">\(\frac{f(1+0.5)-f(1)}{0.5} \approx -0.99749\)</span></td>
<td align="center"><span class="math inline">\(-\sin(1) \approx -0.841471\)</span></td>
<td align="center"><span class="math inline">\(18.54181\%\)</span></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-2} = 0.25\)</span></td>
<td align="center"><span class="math inline">\(\frac{f(1+0.25)-f(1)}{0.25} \approx -0.94898\)</span></td>
<td align="center"><span class="math inline">\(-\sin(1) \approx -0.841471\)</span></td>
<td align="center"><span class="math inline">\(12.77687\%\)</span></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-3} = 0.125\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-4}=0.0625\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-5}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-6}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-7}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-8}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-9}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-10}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table></li>
<li><p>There was nothing really special in part (c) about powers of 2. Use
your spreadsheet to build similar tables for the following sequences
of <span class="math inline">\(h\)</span>: <span class="math display">\[\begin{aligned}
           h &amp;= 3^{-1}, \, 3^{-2}, \, 3^{-3}, \, \ldots  \\
           h &amp;= 5^{-1}, \, 5^{-2}, \, 5^{-3}, \, \ldots  \\
           h &amp;= 10^{-1}, \, 10^{-2}, \, 10^{-3}, \, \ldots \\
           h &amp;= \pi^{-1}, \, \pi^{-2}, \, \pi^{-3}, \, \ldots \\
        \end{aligned}\]</span></p></li>
<li><p>Observation: If you calculate a numerical derivative with a forward
difference and then calculate the absolute percent error with a
fixed value of <span class="math inline">\(h\)</span>, then what do you expect to happen to the
absolute error if you divide the value of <span class="math inline">\(h\)</span> by some positive
contant <span class="math inline">\(M\)</span>?</p></li>
<li><p>What does your answer to part (e) have to do with the approximation
order of the numerical derivative method that you used?</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-145" class="exercise"><strong>Exercise 3.14  </strong></span>The following incomplete block of Python code will help to streamline the previous problem so that you don’t need to do the computation with a spreadsheet.</p>
<ol style="list-style-type: lower-alpha">
<li>Comment every existing line with a thorough description.</li>
<li>Fill in the blanks in the code to perform the spreadsheet computations from the previous problem.</li>
<li>Run the code for several forms of <span class="math inline">\(h\)</span></li>
<li>Do you still observe the same result that you observed in part (e) of the previous problem?</li>
<li>We know that for <span class="math inline">\(h \to 0\)</span> the derivative approximation should mathematically tend toward the exact derivative. Modify the code slightly to see if this is the case. Explain what you see.</li>
</ol>
</div>
<div class="sourceCode" id="cb5"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb5-1"><a href="ch-calculus.html#cb5-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb5-2"><a href="ch-calculus.html#cb5-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb5-3"><a href="ch-calculus.html#cb5-3"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(x) <span class="op">*</span> (<span class="dv">1</span><span class="op">-</span>x) <span class="co"># what does this line do?</span></span>
<span id="cb5-4"><a href="ch-calculus.html#cb5-4"></a>exact <span class="op">=</span> <span class="op">-</span>np.sin(<span class="dv">1</span>) <span class="co"># what does this line do?</span></span>
<span id="cb5-5"><a href="ch-calculus.html#cb5-5"></a>H <span class="op">=</span> <span class="fl">2.0</span><span class="op">**</span>(<span class="op">-</span>np.arange(<span class="dv">1</span>,<span class="dv">10</span>)) <span class="co"># what does this line do?</span></span>
<span id="cb5-6"><a href="ch-calculus.html#cb5-6"></a>AbsPctError <span class="op">=</span> [] <span class="co"># start off with a blank list of errors</span></span>
<span id="cb5-7"><a href="ch-calculus.html#cb5-7"></a><span class="cf">for</span> h <span class="kw">in</span> H:</span>
<span id="cb5-8"><a href="ch-calculus.html#cb5-8"></a>    approx <span class="op">=</span> <span class="co"># FINISH THIS LINE OF CODE</span></span>
<span id="cb5-9"><a href="ch-calculus.html#cb5-9"></a>    AbsPctError.append( np.<span class="bu">abs</span>( (approx <span class="op">-</span> exact)<span class="op">/</span>exact ) )</span>
<span id="cb5-10"><a href="ch-calculus.html#cb5-10"></a>    <span class="bu">print</span>(<span class="st">&quot;h=&quot;</span>,h,<span class="st">&quot;</span><span class="ch">\t</span><span class="st"> Absolute Pct Error=&quot;</span>, AbsPctError[<span class="op">-</span><span class="dv">1</span>])</span>
<span id="cb5-11"><a href="ch-calculus.html#cb5-11"></a>plt.loglog(H,AbsPctError,<span class="st">&#39;b-*&#39;</span>) <span class="co"># Why are we build a loglog plot?</span></span>
<span id="cb5-12"><a href="ch-calculus.html#cb5-12"></a>plt.grid()</span>
<span id="cb5-13"><a href="ch-calculus.html#cb5-13"></a>plt.show()</span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-147" class="exercise"><strong>Exercise 3.15  </strong></span>Assume that <span class="math inline">\(f(x)\)</span> is some differentiable function and that we have
calculated the value of <span class="math inline">\(f&#39;(c)\)</span> using the forward difference formula
<span class="math display">\[f&#39;(c) \approx \frac{f(c+h) - f(c)}{h}.\]</span> Using what you learned from
the previous problem to fill in the following table.</p>
<table>
<thead>
<tr class="header">
<th>My <span class="math inline">\(h\)</span></th>
<th>Absolute Percent Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(0.2\)</span></td>
<td><span class="math inline">\(2.83\%\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.1\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.05\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.02\)</span></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-148" class="exercise"><strong>Exercise 3.16  </strong></span>Explain the phrase: <em>The first derivative approximation</em> <span class="math inline">\(f&#39;(x) \approx \frac{f(x+h)-f(x)}{h}\)</span> <em>is first order.</em>
</div>
<hr />
</div>
<div id="efficient-coding" class="section level3" number="3.2.3">
<h3><span class="header-section-number">3.2.3</span> Efficient Coding</h3>
<p>Now that we have a handle on how the first order approximation scheme for the first derivative works and how the errors will propagate, let’s build some code that will take in a function and output the approximate first derivative on an entire interval instead of just at a single point.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-149" class="exercise"><strong>Exercise 3.17  </strong></span>We want to build a Python function that accepts:</p>
<ul>
<li>a mathematical function,</li>
<li>the bounds of an interval,</li>
<li>and the number of subintervals.</li>
</ul>
<p>The function will return a first order approximation of the first derivative at every point in the interval except at the right-hand side. For example, we could send the function <span class="math inline">\(f(x) = \sin(x)\)</span>, the interval <span class="math inline">\([0,2\pi]\)</span>, and tell it to split the interval into 100 subintervals. We would then get back a value of the derivative <span class="math inline">\(f&#39;(x)\)</span> at all of the points except at <span class="math inline">\(x=2\pi\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>First of all, why can’t we compute a derivative at the last point?</li>
<li>Next, fill in the blanks in the partially complete code below. Every line needs to have a comment explaining exactly what it does.</li>
</ol>
</div>
<div class="sourceCode" id="cb6"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb6-1"><a href="ch-calculus.html#cb6-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb6-2"><a href="ch-calculus.html#cb6-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb6-3"><a href="ch-calculus.html#cb6-3"></a><span class="kw">def</span> FirstDeriv(f,a,b,N):</span>
<span id="cb6-4"><a href="ch-calculus.html#cb6-4"></a>    x <span class="op">=</span> np.linspace(a,b,N<span class="op">+</span><span class="dv">1</span>) <span class="co"># What does this line of code do? </span></span>
<span id="cb6-5"><a href="ch-calculus.html#cb6-5"></a>    <span class="co"># What&#39;s up with the N+1 in the previous line?</span></span>
<span id="cb6-6"><a href="ch-calculus.html#cb6-6"></a>    h <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>] <span class="co"># What does this line of code do?</span></span>
<span id="cb6-7"><a href="ch-calculus.html#cb6-7"></a>    df <span class="op">=</span> [] <span class="co"># What does this line of code do?</span></span>
<span id="cb6-8"><a href="ch-calculus.html#cb6-8"></a>    <span class="cf">for</span> j <span class="kw">in</span> np.arange(<span class="bu">len</span>(x)<span class="op">-</span><span class="dv">1</span>): <span class="co"># What does this line of code do?  </span></span>
<span id="cb6-9"><a href="ch-calculus.html#cb6-9"></a>        <span class="co"># What&#39;s up with the -1 in the definition of the loop?</span></span>
<span id="cb6-10"><a href="ch-calculus.html#cb6-10"></a>        <span class="co"># </span></span>
<span id="cb6-11"><a href="ch-calculus.html#cb6-11"></a>        <span class="co"># Now we want to build the approximation </span></span>
<span id="cb6-12"><a href="ch-calculus.html#cb6-12"></a>        <span class="co"># (f(x+h) - f(x)) / h.</span></span>
<span id="cb6-13"><a href="ch-calculus.html#cb6-13"></a>        <span class="co"># Obviously &quot;x+h&quot; is just the next item in the list of </span></span>
<span id="cb6-14"><a href="ch-calculus.html#cb6-14"></a>        <span class="co"># x values so when we do f(x+h) mathematically we should </span></span>
<span id="cb6-15"><a href="ch-calculus.html#cb6-15"></a>        <span class="co"># write f( x[j+1] ) in Python (explain this).  </span></span>
<span id="cb6-16"><a href="ch-calculus.html#cb6-16"></a>        <span class="co"># Fill in the question marks below</span></span>
<span id="cb6-17"><a href="ch-calculus.html#cb6-17"></a>        df.append( (f( ??? ) <span class="op">-</span> f( ??? )) <span class="op">/</span> h )</span>
<span id="cb6-18"><a href="ch-calculus.html#cb6-18"></a>    <span class="cf">return</span> df</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Now we want to call upon this function to build the first order approximation of the first derivative for some function. We’ll use the function <span class="math inline">\(f(x) = \sin(x)\)</span> on the interval <span class="math inline">\([0,2\pi]\)</span> with 100 sub intervals (since we know what the answer should be). Complete the code below to call upon your <code>FirstDeriv()</code> function and to plot <span class="math inline">\(f(x)\)</span>, <span class="math inline">\(f&#39;(x)\)</span>, and the approximation of <span class="math inline">\(f&#39;(x)\)</span>.</li>
</ol>
<div class="sourceCode" id="cb7"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb7-1"><a href="ch-calculus.html#cb7-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(x)</span>
<span id="cb7-2"><a href="ch-calculus.html#cb7-2"></a>exact_df <span class="op">=</span> <span class="kw">lambda</span> x: np.cos(x)</span>
<span id="cb7-3"><a href="ch-calculus.html#cb7-3"></a>a <span class="op">=</span> ???</span>
<span id="cb7-4"><a href="ch-calculus.html#cb7-4"></a>b <span class="op">=</span> ???</span>
<span id="cb7-5"><a href="ch-calculus.html#cb7-5"></a>N <span class="op">=</span> <span class="dv">100</span> <span class="co"># What is this?</span></span>
<span id="cb7-6"><a href="ch-calculus.html#cb7-6"></a>x <span class="op">=</span> np.linspace(a,b,N<span class="op">+</span><span class="dv">1</span>) </span>
<span id="cb7-7"><a href="ch-calculus.html#cb7-7"></a><span class="co"># What does the prevoius line do?  </span></span>
<span id="cb7-8"><a href="ch-calculus.html#cb7-8"></a><span class="co"># What&#39;s up with the N+1?</span></span>
<span id="cb7-9"><a href="ch-calculus.html#cb7-9"></a></span>
<span id="cb7-10"><a href="ch-calculus.html#cb7-10"></a>df <span class="op">=</span> FirstDeriv(f,a,b,N) <span class="co"># What does this line do?</span></span>
<span id="cb7-11"><a href="ch-calculus.html#cb7-11"></a></span>
<span id="cb7-12"><a href="ch-calculus.html#cb7-12"></a><span class="co"># In the next line we plot three curves: </span></span>
<span id="cb7-13"><a href="ch-calculus.html#cb7-13"></a><span class="co"># 1) the function f(x) = sin(x)</span></span>
<span id="cb7-14"><a href="ch-calculus.html#cb7-14"></a><span class="co"># 2) the function f&#39;(x) = cos(x)</span></span>
<span id="cb7-15"><a href="ch-calculus.html#cb7-15"></a><span class="co"># 3) the approximation of f&#39;(x)</span></span>
<span id="cb7-16"><a href="ch-calculus.html#cb7-16"></a><span class="co"># However, we do something funny with the x in the last plot. Why?</span></span>
<span id="cb7-17"><a href="ch-calculus.html#cb7-17"></a>plt.plot(x,f(x),<span class="st">&#39;b&#39;</span>,x,exact_df(x),<span class="st">&#39;r--&#39;</span>,x[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>], df, <span class="st">&#39;k-.&#39;</span>)</span>
<span id="cb7-18"><a href="ch-calculus.html#cb7-18"></a>plt.grid()</span>
<span id="cb7-19"><a href="ch-calculus.html#cb7-19"></a>plt.legend([<span class="st">&#39;f(x) = sin(x)&#39;</span>,</span>
<span id="cb7-20"><a href="ch-calculus.html#cb7-20"></a>            <span class="st">&#39;exact first deriv&#39;</span>,</span>
<span id="cb7-21"><a href="ch-calculus.html#cb7-21"></a>            <span class="st">&#39;approx first deriv&#39;</span>])</span>
<span id="cb7-22"><a href="ch-calculus.html#cb7-22"></a>plt.show()</span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Implement your completed code and then test it in several ways:
<ol style="list-style-type: lower-roman">
<li>Test your code on functions where you know the derivative. Be sure that you get the plots that you expect.</li>
<li>Test your code with a very large number of sub intervals, <span class="math inline">\(N\)</span>. What do you observe?</li>
<li>Test your code with small number of sub intervals, <span class="math inline">\(N\)</span>. What do you observe?</li>
</ol></li>
</ol>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-152" class="exercise"><strong>Exercise 3.18  </strong></span>Now let’s build the first derivative function in a much <em>smarter</em> way – using <code>numpy</code> lists in Python. Instead of looping over all of the elements we can take advantage of the fact that every thing is stored in lists. Hence we can just do list operations and do all of the subtractions and divisions at once without a loop.
</div>
<ol style="list-style-type: lower-alpha">
<li>From your previous code, comment out the following lines.</li>
</ol>
<div class="sourceCode" id="cb8"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb8-1"><a href="ch-calculus.html#cb8-1"></a><span class="co">#     df = []</span></span>
<span id="cb8-2"><a href="ch-calculus.html#cb8-2"></a><span class="co">#     for j in np.arange(len(x)-1):</span></span>
<span id="cb8-3"><a href="ch-calculus.html#cb8-3"></a><span class="co">#         df.append( (f(x[j+1]) - f(x[j])) / h )</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>From the line of code <code>x = np.linspace(a,b,N+1)</code> we build a list of <span class="math inline">\(N+1\)</span> values of <span class="math inline">\(x\)</span> starting at <span class="math inline">\(a\)</span> and ending at <span class="math inline">\(b\)</span>. In the following questions remember that Python indexes all lists starting at 0. Also remember that you can call on the last element of a list using an index of <code>-1</code>. Finally, remember that if you do <code>x[p:q]</code> in Python you will get a list of <code>x</code> values starting at index <code>p</code> and ending at index <code>q-1</code>.
<ol style="list-style-type: lower-roman">
<li>What will we get if we evaluate the code <code>x[1:]</code>?</li>
<li>What will we get if we evaluate the code <code>f(x[1:])</code>?</li>
<li>What will we get if we evaluate the code <code>x[0:-1]</code>?<br />
</li>
<li>What will we get if we evaluate the code <code>f(x[0:-1])</code>?</li>
<li>What will we give if we evaluate the code <code>f(x[1:]) - f(x[0:-1])</code>?</li>
<li>What will we give if we evaluate the code <code>( f(x[1:]) - f(x[0:-1]) ) / h</code>?</li>
</ol></li>
<li>Replace the lines that you commented out in part (a) of this exercise with the appropriate single line of code that builds all of the approximations for the first derivative all at once without the need for a loop. What you did in part (b) should help. Your simplified first order first derivative function should look like the code below.</li>
</ol>
<div class="sourceCode" id="cb9"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb9-1"><a href="ch-calculus.html#cb9-1"></a><span class="kw">def</span> FirstDeriv(f,a,b,N):</span>
<span id="cb9-2"><a href="ch-calculus.html#cb9-2"></a>    x <span class="op">=</span> np.linspace(a,b,N<span class="op">+</span><span class="dv">1</span>)</span>
<span id="cb9-3"><a href="ch-calculus.html#cb9-3"></a>    h <span class="op">=</span> x[<span class="dv">1</span>] <span class="op">-</span> x[<span class="dv">0</span>]</span>
<span id="cb9-4"><a href="ch-calculus.html#cb9-4"></a>    df <span class="op">=</span> <span class="co"># your line of code goes here?  </span></span>
<span id="cb9-5"><a href="ch-calculus.html#cb9-5"></a>    <span class="cf">return</span> df</span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-155" class="exercise"><strong>Exercise 3.19  </strong></span>Write code that finds a first order approximation for the first
derivative of <span class="math inline">\(f(x) = \sin(x) - x\sin(x)\)</span> on the interval
<span class="math inline">\(x \in (0,15)\)</span>. Your script should output two plots (side-by-side).</p>
<ol style="list-style-type: lower-alpha">
<li>The left-hand plot should show the function in blue and the approximate first
derivative as a red dashed curve. Sample code for this problem is given below.</li>
</ol>
</div>
<div class="sourceCode" id="cb10"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb10-1"><a href="ch-calculus.html#cb10-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb10-2"><a href="ch-calculus.html#cb10-2"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb10-3"><a href="ch-calculus.html#cb10-3"></a></span>
<span id="cb10-4"><a href="ch-calculus.html#cb10-4"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(x) <span class="op">-</span> x<span class="op">*</span>np.sin(x)</span>
<span id="cb10-5"><a href="ch-calculus.html#cb10-5"></a>a <span class="op">=</span> <span class="dv">0</span></span>
<span id="cb10-6"><a href="ch-calculus.html#cb10-6"></a>b <span class="op">=</span> <span class="dv">15</span></span>
<span id="cb10-7"><a href="ch-calculus.html#cb10-7"></a>N <span class="op">=</span> <span class="co"># make this an appropriately sized number of subintervals</span></span>
<span id="cb10-8"><a href="ch-calculus.html#cb10-8"></a>x <span class="op">=</span> np.linspace(a,b,N<span class="op">+</span><span class="dv">1</span>) <span class="co"># what does this line do?</span></span>
<span id="cb10-9"><a href="ch-calculus.html#cb10-9"></a>y <span class="op">=</span> f(x) <span class="co"># what does this line do?</span></span>
<span id="cb10-10"><a href="ch-calculus.html#cb10-10"></a>df <span class="op">=</span> FirstDerivFirstOrder(f,a,b,N) <span class="co"># what does this line do?</span></span>
<span id="cb10-11"><a href="ch-calculus.html#cb10-11"></a></span>
<span id="cb10-12"><a href="ch-calculus.html#cb10-12"></a>fig, ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>,<span class="dv">2</span>) <span class="co"># what does this line do?</span></span>
<span id="cb10-13"><a href="ch-calculus.html#cb10-13"></a>ax[<span class="dv">0</span>].plot(x,y,<span class="st">&#39;b&#39;</span>,x[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>],df,<span class="st">&#39;r--&#39;</span>) <span class="co"># what does this line do?</span></span>
<span id="cb10-14"><a href="ch-calculus.html#cb10-14"></a>ax[<span class="dv">0</span>].grid()</span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>The right-hand plot should show the absolute error between the exact
derivative and the numerical derivative. You should use a
logarithmic <span class="math inline">\(y\)</span> axis for this plot.</li>
</ol>
<div class="sourceCode" id="cb11"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb11-1"><a href="ch-calculus.html#cb11-1"></a>exact <span class="op">=</span> <span class="kw">lambda</span> x: <span class="co"># write a function for the exact derivative</span></span>
<span id="cb11-2"><a href="ch-calculus.html#cb11-2"></a><span class="co"># There is a lot going on the next line of code ... explain it.</span></span>
<span id="cb11-3"><a href="ch-calculus.html#cb11-3"></a>ax[<span class="dv">1</span>].semilogy(x[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>],<span class="bu">abs</span>(exact(x[<span class="dv">0</span>:<span class="op">-</span><span class="dv">1</span>]) <span class="op">-</span> df))</span>
<span id="cb11-4"><a href="ch-calculus.html#cb11-4"></a>ax[<span class="dv">1</span>].grid()</span></code></pre></div>
<ol start="3" style="list-style-type: lower-alpha">
<li>Play with the number of sub intervals, <span class="math inline">\(N\)</span>, and demonstrate the fact that we are using a first order method to approximate the first derivative.</li>
</ol>
<hr />
</div>
<div id="a-better-first-derivative" class="section level3" number="3.2.4">
<h3><span class="header-section-number">3.2.4</span> A Better First Derivative</h3>
<p>Next we’ll build a more accurate numerical first derivative scheme. The derivation technique is the same: play a little algebra game with the Taylor series and see if you can get the first derivative to simplify out. This time we’ll be hoping to have a better error approximation.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-158" class="exercise"><strong>Exercise 3.20  </strong></span>Consider again the Taylor series for an infinitely differentiable function <span class="math inline">\(f(x)\)</span>:
<span class="math display">\[ f(x) = f(x_0) + \frac{f&#39;(x_0)}{1!} (x-x_0)^1 + \frac{f&#39;&#39;(x_0)}{2!}(x-x_0)^2 +
        \frac{f^{(3)}(x_0)}{3!}(x-x_0)^3 + \cdots \]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Replace the “<span class="math inline">\(x\)</span>” in the Taylor Series with “<span class="math inline">\(x+h\)</span>” and replace the “<span class="math inline">\(x_0\)</span>” in the Taylor Series with “<span class="math inline">\(x\)</span>” and simplify.
<span class="math display">\[f(x+h) = \underline{\hspace{3in}}\]</span></p></li>
<li><p>Now replace the “<span class="math inline">\(x\)</span>” in the Taylor Series with “<span class="math inline">\(x-h\)</span>” and replace the “<span class="math inline">\(x_0\)</span>” in the Taylor Series with “<span class="math inline">\(x\)</span>” and simplify.
<span class="math display">\[f(x-h) = \underline{\hspace{3in}}\]</span></p></li>
<li><p>Find the difference between <span class="math inline">\(f(x+h)\)</span> and <span class="math inline">\(f(x-h)\)</span> and simplify. Be very careful of your signs.
<span class="math display">\[f(x+h) - f(x-h) = \underline{\hspace{3in}}\]</span></p></li>
<li><p>Solve for <span class="math inline">\(f&#39;(x)\)</span> in your result from part (c). Fill in the question
marks and blanks below once you have finished simplifying.
<span class="math display">\[f&#39;(x) = \frac{??? - ???}{2h} + \underline{\hspace{3in}}.\]</span></p></li>
<li><p>Use your result from part (d) to verify that
<span class="math display">\[f&#39;(x) = \underline{\hspace{2in}} + \mathcal{O}(h^2).\]</span></p></li>
<li><p>Draw a picture similar to Figure <a href="ch-calculus.html#fig:forward-difference">3.2</a> showing what this scheme is doing graphically.</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-159" class="exercise"><strong>Exercise 3.21  </strong></span>Let’s return to the function <span class="math inline">\(f(x) = \sin(x)(1- x)\)</span> but this time we
will approximate the first derivative at <span class="math inline">\(x=1\)</span> using the formula
<span class="math display">\[f&#39;(1) \approx \frac{f(1+h) - f(1-h)}{2h}.\]</span> You should already have
the first derivative and the exact answer from Exercise <a href="ch-calculus.html#exr:deriv-error-analysis-ex">3.13</a> (if not, then go get them by hand again).</p>
<ol style="list-style-type: lower-alpha">
<li><p>Fill in the table below with the derivative approximation and the
absolute error associated with each given <span class="math inline">\(h\)</span>. You may want to use a
spreadsheet to organize your data (be sure that you’re working in
radians!).</p>
<table>
<thead>
<tr class="header">
<th align="center"><span class="math inline">\(h\)</span></th>
<th align="center">Approx. of <span class="math inline">\(f&#39;(1)\)</span></th>
<th align="center">Exact value of <span class="math inline">\(f&#39;(1)\)</span></th>
<th align="center">Abs. % Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-3} = 0.5\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-3} = 0.25\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-3} = 0.125\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-4}=0.0625\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-5}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-6}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-7}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="even">
<td align="center"><span class="math inline">\(2^{-8}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
<tr class="odd">
<td align="center"><span class="math inline">\(2^{-9}\)</span></td>
<td align="center"></td>
<td align="center"><span class="math inline">\(-\sin(1)\)</span></td>
<td align="center"></td>
</tr>
</tbody>
</table></li>
<li><p>There was nothing really special in part (c) about powers of 2. Use
your spreadsheet to build similar tables for the following sequences
of <span class="math inline">\(h\)</span>: <span class="math display">\[\begin{aligned}
           h &amp;= 3^{-1}, \, 3^{-2}, \, 3^{-3}, \, \ldots \\
           h &amp;= 5^{-1}, \, 5^{-2}, \, 5^{-3}, \, \ldots \\
           h &amp;= 10^{-1}, \, 10^{-2}, \, 10^{-3}, \, \ldots \\
           h &amp;= \pi^{-1}, \, \pi^{-2}, \, \pi^{-3}, \, \ldots 
        \end{aligned}\]</span></p></li>
<li><p>Observation: If you calculate a numerical derivative with a centered
difference and calculate the resulting absolute percent error with a
fixed value of <span class="math inline">\(h\)</span>, then what do you expect to happen to the
absolute percent error if you divide the value of <span class="math inline">\(h\)</span> by some
positive constant <span class="math inline">\(M\)</span>?</p></li>
<li><p>What does your answer to part (e) have to do with the approximation
order of the numerical derivative method that you used?</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-160" class="exercise"><strong>Exercise 3.22  </strong></span>Assume that <span class="math inline">\(f(x)\)</span> is some differentiable function and that we have
calculated the value of <span class="math inline">\(f&#39;(c)\)</span> using the centered difference formula
<span class="math display">\[f&#39;(c) \approx \frac{f(c+h) - f(c-h)}{2h}.\]</span> Using what you learned
from the previous problem to fill in the following table.</p>
<table>
<thead>
<tr class="header">
<th>My <span class="math inline">\(h\)</span></th>
<th>Absolute Percent Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(0.2\)</span></td>
<td><span class="math inline">\(2.83\%\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.1\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.05\)</span></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(0.02\)</span></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(0.002\)</span></td>
<td></td>
</tr>
</tbody>
</table>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-161" class="exercise"><strong>Exercise 3.23  </strong></span>Write a Python function that takes a mathematical function and an interval and returns a second
order numerical approximation to the first derivative on the interval. You should try to write this code without using any loops. (Hint: This should really be a minor modification of your first order first derivative code.)
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-162" class="exercise"><strong>Exercise 3.24  </strong></span>Test the code you wrote in the previous exercise on functions where you know the first derivative.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-163" class="exercise"><strong>Exercise 3.25  </strong></span>The plot shown in Figure <a href="ch-calculus.html#fig:first-deriv-comparison">3.3</a> shows the maximum absolute error between the exact first derivative of a function <span class="math inline">\(f(x)\)</span> and a numerical first derivative approximation scheme. At this point we know two schemes:
<span class="math display">\[ f&#39;(x) = \frac{f(x+h) - f(x)}{h} + \mathcal{O}(h) \]</span>
and
<span class="math display">\[ f&#39;(x) = \frac{f(x+h) - f(x-h)}{2h} + \mathcal{O}(h^2). \]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Which curve in the plot matches with which method. How do you know?</li>
<li>Recreate the plot with a function of your choosing.</li>
</ol>
</div>
<div class="figure" style="text-align: center"><span id="fig:first-deriv-comparison"></span>
<img src="images/Ch03_FirstDerivCompare.png" alt="Maximum absolute error between the first derivative and two different approximations of the first derivative." width="75%" />
<p class="caption">
Figure 3.3: Maximum absolute error between the first derivative and two different approximations of the first derivative.
</p>
</div>
<hr />
</div>
<div id="the-second-derivative" class="section level3" number="3.2.5">
<h3><span class="header-section-number">3.2.5</span> The Second Derivative</h3>
<p>Now we’ll search for an approximation of the second derivative. Again,
the game will be the same: experiment with the Taylor series and some algebra
with an eye toward getting the second derivative to pop out cleanly. This time we’ll do the
algebra in such a way that the first derivative cancels.</p>
<p>From the previous problems you already have Taylor expansions of the
form <span class="math inline">\(f(x+h)\)</span> and <span class="math inline">\(f(x-h)\)</span>. Let’s summarize them here since you’re going
to need them for future computations.
<span class="math display">\[ \begin{aligned}
    f(x+h) &amp;= f(x) + \frac{f&#39;(x)}{1!} h + \frac{f&#39;&#39;(x)}{2!} h^2 + \frac{f^{(3)}(x)}{3!}
    h^3 + \cdots \\
    f(x-h) &amp;= f(x) - \frac{f&#39;(x)}{1!} h + \frac{f&#39;&#39;(x)}{2!} h^2 - \frac{f^{(3)}(x)}{3!}
    h^3 + \cdots \end{aligned} \]</span></p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-164" class="exercise"><strong>Exercise 3.26  </strong></span>The goal of
this problem is to use the Taylor series for <span class="math inline">\(f(x+h)\)</span> and <span class="math inline">\(f(x-h)\)</span> to arrive at an approximation scheme for the second derivative <span class="math inline">\(f&#39;&#39;(x)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Add the Taylor series for <span class="math inline">\(f(x+h)\)</span> and <span class="math inline">\(f(x-h)\)</span> and combine all like
terms. You should notice that several terms cancel.
<span class="math display">\[f(x+h) + f(x-h) = \underline{\hspace{3in}}.\]</span></p></li>
<li><p>Solve your answer in part (a) for <span class="math inline">\(f&#39;&#39;(x)\)</span>.
<span class="math display">\[f&#39;&#39;(x) = \frac{?? - 2 \cdot ?? + ??}{h^2} + \underline{\hspace{1in}}.\]</span></p></li>
<li><p>If we were to drop all of the terms after the fraction on the right-hand
side of the previous result we would be introducing some error into the
derivative computation. What does this tell us about the order of the error for the second derivative approximation scheme we just built?</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-165" class="exercise"><strong>Exercise 3.27  </strong></span>Again consider the function <span class="math inline">\(f(x) = \sin(x)(1 - x)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Calculate the derivative of this function and calculate the exact
value of <span class="math inline">\(f&#39;&#39;(1)\)</span>.</p></li>
<li><p>If we calcuate the second derivative with the central difference scheme that you built in the previous exericse using <span class="math inline">\(h = 0.5\)</span> then we get a 4.115% error. Stop now and verify this percent error calculation.</p></li>
<li><p>Based on our previous work with the order of the error in a numerical differentiation scheme, what do you predict the error will be if we calculate <span class="math inline">\(f&#39;&#39;(1)\)</span> with <span class="math inline">\(h = 0.25\)</span>? With <span class="math inline">\(h = 0.05\)</span>? With <span class="math inline">\(h = 0.005\)</span>? Defend your answers.</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-166" class="exercise"><strong>Exercise 3.28  </strong></span>Write a Python function that takes a mathematical function and a domain and returns a second
order numerical approximation to the second derivative on the interval.
You should ALWAYS start by writing pseudo-code as comments in your function. As before, you should write your code without using any loops.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-167" class="exercise"><strong>Exercise 3.29  </strong></span>Test your second derivative code on the function
<span class="math inline">\(f(x) = \sin(x) - x\sin(x)\)</span> by doing the following.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the analytic second derivative by hand.</p></li>
<li><p>Find the numerical second derivative with the code that you just
wrote.</p></li>
<li><p>Find the absolute difference between your numerical second
derivative and the actual second derivative. This is point-by-point
subtraction so you should end up with a vector of errors.</p></li>
<li><p>Find the maximum of your errors.</p></li>
<li><p>Now we want to see how the code works if you change the number of
points used. Build a plot showing the value of <span class="math inline">\(h\)</span> on the horizontal
axis and the maximum error on the vertical axis. You will need to
write a loop that gets the error for many different values of <span class="math inline">\(h\)</span>.
Finally, it is probably best to build this plot on a log-log scale.</p></li>
<li><p>Discuss what you see? How do you see the fact that the numerical
second derivative is second order accurate?</p></li>
</ol>
</div>
<hr />
<p>The table below summarizes the formulas that we have for derivatives thus far. The exercises at the end of this chapter contain several more derivative approximations. We will return to this idea when we study numerical differential equations in Chapter <a href="ch-odes.html#ch:odes">5</a>.</p>
<table>
<colgroup>
<col width="38%" />
<col width="26%" />
<col width="19%" />
<col width="15%" />
</colgroup>
<thead>
<tr class="header">
<th>Derivative</th>
<th>Formula</th>
<th>Error</th>
<th>Name</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(1^{st}\)</span></td>
<td><span class="math inline">\(f&#39;(x) \approx \frac{f(x+h) - f(x)}{h}\)</span></td>
<td><span class="math inline">\(\mathcal{O}(h)\)</span></td>
<td>Forward Difference</td>
</tr>
<tr class="even">
<td><span class="math inline">\(1^{st}\)</span></td>
<td><span class="math inline">\(f&#39;(x) \approx \frac{f(x) - f(x-h)}{h}\)</span></td>
<td><span class="math inline">\(\mathcal{O}(h)\)</span></td>
<td>Backward Difference</td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1^{st}\)</span></td>
<td><span class="math inline">\(f&#39;(x) \approx \frac{f(x+h) - f(x-h)}{2h}\)</span></td>
<td><span class="math inline">\(\mathcal{O}(h^2)\)</span></td>
<td>Centered Difference</td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{nd}\)</span></td>
<td><span class="math inline">\(f&#39;&#39;(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\)</span></td>
<td><span class="math inline">\(\mathcal{O}(h^2)\)</span></td>
<td>Centered Difference</td>
</tr>
</tbody>
</table>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-168" class="exercise"><strong>Exercise 3.30  </strong></span>Let <span class="math inline">\(f(x)\)</span> be a twice differentiable function. We are interested in the
first and second derivative of the function <span class="math inline">\(f\)</span> at the point <span class="math inline">\(x = 1.74\)</span>.
Use what you have learned in this section to answer the following
questions. (For clarity, you can think of “<span class="math inline">\(f\)</span>” as a different function
in each of the following questions …it doesn’t really matter exactly
what function <span class="math inline">\(f\)</span> is.)</p>
<ol style="list-style-type: lower-alpha">
<li><p>Johnny used a numerical first derivative scheme with <span class="math inline">\(h = 0.1\)</span> to
approximate <span class="math inline">\(f&#39;(1.74)\)</span> and found an abolute percent error of 3.28%.
He then used <span class="math inline">\(h=0.01\)</span> and found an absolute percent error of 0.328%.
What was the order of the error in his first derivative scheme? How
can you tell?</p></li>
<li><p>Betty used a numerical first derivative scheme with <span class="math inline">\(h = 0.2\)</span> to
approximate <span class="math inline">\(f&#39;(1.74)\)</span> and found an absolute percent error of 4.32%.
She then used <span class="math inline">\(h=0.1\)</span> and found an absolute percent error of 1.08%.
What numerical first derivative scheme did she likely use?</p></li>
<li><p>Shelby did the computation
<span class="math display">\[f&#39;(1.74) \approx \frac{f(1.78) - f(1.74)}{0.04}\]</span> and found an
absolute percent error of 2.93%. If she now computes
<span class="math display">\[f&#39;(1.74) \approx \frac{f(1.75) - f(1.74)}{0.01}\]</span> what will the
new absolute percent error be?</p></li>
<li><p>Harry wants to compute <span class="math inline">\(f&#39;&#39;(1.74)\)</span> to within 1% using a central
difference scheme. He tries <span class="math inline">\(h=0.25\)</span> and gets an absolute percent
error of 3.71%. What <span class="math inline">\(h\)</span> should he try next so that his absolute
percent error is less than (but close to) 1%?</p></li>
</ol>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="integration" class="section level2" number="3.3">
<h2><span class="header-section-number">3.3</span> Integration</h2>
<p>Now we begin our work on the second principle computation of Calculus: evaluating a definite integral. Remember that a single-variable definite integral can be interpreted as the signed area between the curve and the <span class="math inline">\(x\)</span> axis. In this section we will study three different techniques for approximating the value of a definite integral.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-169" class="exercise"><strong>Exercise 3.31  </strong></span>Consider the shaded area of the region under the function plotted in
Figure <a href="ch-calculus.html#fig:integration-ex1">3.4</a> between <span class="math inline">\(x=0\)</span> and <span class="math inline">\(x=2\)</span>.</p>
<p>a.What rectangle with area 6 gives an upper bound for the area under the curve? Can you give a better upper bound?
b. Why must the area under the curve be greater than 3?
c. Is the area greater than 4? Why/Why not?
d. Work with your partner to give an estimate of the area and provide an estimate for the amount of error that you’re making.</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:integration-ex1"></span>
<img src="images/Ch03_InitialIntegral.png" alt="A sample integration" width="45%" />
<p class="caption">
Figure 3.4: A sample integration
</p>
</div>
<hr />
<div id="riemann-sums" class="section level3" number="3.3.1">
<h3><span class="header-section-number">3.3.1</span> Riemann Sums</h3>
<p>In this subsection we will build our first method for approximating definite integrals.
Recall from Calculus that the definition of the Riemann integral is
<span class="math display">\[\begin{aligned}
    \int_a^b f(x) dx = \lim_{\Delta x \to 0} \sum_{j=1}^N f(x_j) \Delta x
    \label{eqn:Riemann_integral}\end{aligned}\]</span>
where <span class="math inline">\(N\)</span> is the number
of sub intervals on the interval <span class="math inline">\([a,b]\)</span> and <span class="math inline">\(\Delta x\)</span> is the width of
the interval. As with differentiation, we can remove the limit and have
a decent approximation of the integral so long as <span class="math inline">\(N\)</span> is large (or equivalently, if <span class="math inline">\(\Delta x\)</span> is small).
<span class="math display">\[\int_a^b f(x) dx \approx \sum_{j=1}^N f(x_j) \Delta x.\]</span> You are
likely familiar with this approximation of the integral from Calculus.
The value of <span class="math inline">\(x_j\)</span> can be chosen anywhere within the sub interval and
three common choices are to use the left endpoint, the midpoint, and the
right endpoint.</p>
<p>We see a depiction of this in Figure <a href="ch-calculus.html#fig:integral-with-rectangles">3.5</a>.</p>
<div class="figure" style="text-align: center"><span id="fig:integral-with-rectangles"></span>
<img src="images/Ch03_ThreeRiemannSums.png" alt="Right-aligned Riemann sums, midpoint-aligned Riemann sums, and left-aligned Riemann sums" width="80%" />
<p class="caption">
Figure 3.5: Right-aligned Riemann sums, midpoint-aligned Riemann sums, and left-aligned Riemann sums
</p>
</div>
<p>Clearly, the more rectangles we choose the closer the sum of the areas
of the rectangles will get to the integral.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-170" class="exercise"><strong>Exercise 3.32  </strong></span>Write code to approximate an integral with Riemann sums. You should ALWAYS
start by writing pseudo-code as comments in your function. Your Python function
should accept a Python Function, a lower
bound, an upper bound, the number of subintervals, and an optional input
that allows the user to designate whether they want <code>left</code>, <code>right</code>, or
<code>midpoint</code> rectangles. Test your code on several functions for which you know the integral. You
should write your code without any loops.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-171" class="exercise"><strong>Exercise 3.33  </strong></span>Consider the function <span class="math inline">\(f(x) = \sin(x)\)</span>. We know the antiderivative for this function, <span class="math inline">\(F(x) = -\cos(x) + C\)</span>, but in this question we are going to get a sense of the order of the error when doing Riemann Sum integration.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find the exact value of <span class="math display">\[\int_0^{1} f(x) dx.\]</span></p></li>
<li><p>Now build a Riemann Sum approximation (using your code) with various
values of <span class="math inline">\(\Delta x\)</span>. For all of your approximation use
left-justified rectangles. Fill in the table with your results.</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\Delta x\)</span></th>
<th>Approx. Integral</th>
<th>Exact Integral</th>
<th>Abs. Percent Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(2^{-1} = 0.5\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{-2} = 0.25\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{-3}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{-4}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{-5}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{-6}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(2^{-7}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(2^{-8}\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: lower-alpha">
<li><p>There was nothing really special about powers of 2 in part (b) of
this problem. Examine other sequences of <span class="math inline">\(\Delta x\)</span> with a goal
toward answering the question:<br />
<em>If we find an approximation of the integral with a fixed <span class="math inline">\(\Delta x\)</span> and find an absolute percent error, then what would happen to the absolute percent error if we divide <span class="math inline">\(\Delta x\)</span> by some positive constant <span class="math inline">\(M\)</span>?</em></p></li>
<li><p>What is the apparent approximation error of the Riemann Sum method
using left-justified rectangles.</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-172" class="exercise"><strong>Exercise 3.34  </strong></span>Repeat the previous problem using right-justified rectangles.
</div>
<hr />

<div class="theorem">
<p><span id="thm:unnamed-chunk-173" class="theorem"><strong>Theorem 3.2  </strong></span>In approximating the integral <span class="math inline">\(\int_a^b f(x) dx\)</span> with a fixed interval
width <span class="math inline">\(\Delta  x\)</span> we find an absolute percent error <span class="math inline">\(P\)</span>.</p>
<ul>
<li><p>If we use left rectangles and an interval width of
<span class="math inline">\(\frac{\Delta x}{M}\)</span> then the absolute percent error will be
approximately <span class="math inline">\(\underline{\hspace{1in}}\)</span>.</p></li>
<li><p>If we use right rectangles and an interval width of
<span class="math inline">\(\frac{\Delta x}{M}\)</span> then the absolute percent error will be
approximately <span class="math inline">\(\underline{\hspace{1in}}\)</span>.</p></li>
</ul>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-174" class="exercise"><strong>Exercise 3.35  </strong></span>The previous theorem could be stated in an equivalent way.</p>
<p>In approximating the integral <span class="math inline">\(\int_a^b f(x) dx\)</span> with a fixed interval
number of subintervals we find an absolute percent error <span class="math inline">\(P\)</span>.</p>
<ul>
<li><p>If we use left rectangles and <span class="math inline">\(M\)</span> times as many subintervals then
the absolute percent error will be approximately <span class="math inline">\(\underline{\hspace{1in}}\)</span>.</p></li>
<li><p>If we use right rectangles and <span class="math inline">\(M\)</span> times as many subintervals then
the absolute percent error will be approximately <span class="math inline">\(\underline{\hspace{1in}}\)</span>.</p></li>
</ul>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-175" class="exercise"><strong>Exercise 3.36  </strong></span>Create a plot with the width of the subintervals on the horizontal axis and the absolute error between your Riemann sum calculations (left, right, and midpoint) and the exact integral for a known definite integral. Your plot should be on a log-log scale. Based on your plot, what is the approximate order of the error in the Riemann sum approximation?
</div>
<hr />
</div>
<div id="trapezoidal-rule" class="section level3" number="3.3.2">
<h3><span class="header-section-number">3.3.2</span> Trapezoidal Rule</h3>
<p>Now let’s turn our attention to some slightly better algorithms for
calculating the value of a definite integral: The Trapezoidal Rule and
Simpson’s Rule. There are many others, but in practice these two are
relatively easy to implement and have reasonably good error
approximations. To motivate the idea of the Trapezoid rule consider
Figure <a href="ch-calculus.html#fig:trap-motivation">3.6</a>. It is plain to see that trapezoids
will make better approximations than rectangles at least in this
particular case. Another way to think about using trapezoids, however,
is to see the top side of the trapezoid as a secant line connecting two
points on the curve. As <span class="math inline">\(\Delta x\)</span> gets arbitrarily small, the secant
lines become better and better approximations for tangent lines and are
hence arbitrarily good approximations for the curve. For these reasons
it seems like we should investigate how to systematically approximate
definite integrals via trapezoids.</p>
<div class="figure" style="text-align: center"><span id="fig:trap-motivation"></span>
<img src="images/Ch03_Trapezoidal1.png" alt="Motivation for using trapezoids to approximate a definite integral." width="90%" />
<p class="caption">
Figure 3.6: Motivation for using trapezoids to approximate a definite integral.
</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-176" class="exercise"><strong>Exercise 3.37  </strong></span>Consider a single trapezoid approximating the area under a curve. From
geometry we recall that the area of a trapezoid is
<span class="math display">\[A = \frac{1}{2}\left( b_1 + b_2 \right) h\]</span> where <span class="math inline">\(b_1, b_2\)</span> and <span class="math inline">\(h\)</span>
are marked in Figure <a href="ch-calculus.html#fig:trapezoidal-2">3.7</a>. The function shown in the picture is
<span class="math inline">\(f(x) = \frac{1}{5} x^2 (5-x)\)</span>. Find the area of the shaded region as an
approximation to <span class="math display">\[\int_1^4 \left( \frac{1}{5} x^2 (5-x) \right) dx.\]</span></p>
Now use the same idea with <span class="math inline">\(h = \Delta x = 1\)</span> from Figure <a href="ch-calculus.html#fig:trap-motivation">3.6</a> to approximate the area under the function <span class="math inline">\(f(x) = \frac{1}{5}x^2(5-x)\)</span> between <span class="math inline">\(x=1\)</span> and <span class="math inline">\(x=4\)</span> using three trapezoids.
</div>
<div class="figure" style="text-align: center"><span id="fig:trapezoidal-2"></span>
<img src="images/Ch03_Trapezoidal2.png" alt="A single trapezoid to approximate area under a curve." width="40%" />
<p class="caption">
Figure 3.7: A single trapezoid to approximate area under a curve.
</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-177" class="exercise"><strong>Exercise 3.38  </strong></span>Again consider the function <span class="math inline">\(f(x) = \frac{1}{5}x^2(5-x)\)</span> on the interval <span class="math inline">\([1,4]\)</span>. We want to evaluate the integral
<span class="math display">\[\int_1^4 f(x) dx\]</span>
using trapezoids to approximate the area.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Work out the exact value of the definite integral by hand.</p></li>
<li><p>Summarize your answers to the previous problems in the following
table then extend the data that you have for smaller and smaller
values of <span class="math inline">\(\Delta x\)</span>.</p></li>
</ol>
<table>
<thead>
<tr class="header">
<th><span class="math inline">\(\Delta x\)</span></th>
<th>Approx. Integral</th>
<th>Exact Integral</th>
<th>Abs. % Error</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(3\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(1\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(1/3\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="even">
<td><span class="math inline">\(1/9\)</span></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
<td><span class="math inline">\(\vdots\)</span></td>
</tr>
</tbody>
</table>
<ol start="3" style="list-style-type: lower-alpha">
<li>From the table that you built in part (b), what do you conjecture is
the order of the approximation error for the trapezoid method?</li>
</ol>
</div>
<hr />
<div style="page-break-after: always;"></div>

<div class="definition">
<p><span id="def:trapezoidal" class="definition"><strong>Definition 3.3  (The Trapezoidal Rule)  </strong></span>We want to approximate <span class="math inline">\(\displaystyle \int_a^b f(x) dx\)</span>. One of the
simplest ways is to approximate the area under the function with a
trapezoid. Recall from basic geometry that area of a trapezoid is
<span class="math inline">\(A = \frac{1}{2} (b_1 + b_2) h\)</span>. In terms of the integration problem we
can do the following:</p>
<ol style="list-style-type: lower-alpha">
<li>First partition <span class="math inline">\([a,b]\)</span> into the set
<span class="math inline">\(\{x_0=a, x_1, x_2, \ldots, x_{n-1},x_n=b\}\)</span>.</li>
<li>On each part of the partition approximate the area with a trapezoid:
<span class="math display">\[A_j = \frac{1}{2} \left[ f(x_j) + f(x_{j-1}) \right]\left(x_j - x_{j-1} \right)\]</span></li>
<li>Approximate the integral as <span class="math display">\[\int_a^b f(x) dx = \sum_{j=1}^n A_j\]</span></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-178" class="exercise"><strong>Exercise 3.39  </strong></span>Write code to give the trapezoidal rule approximation for the definite
integral <span class="math inline">\(\int_a^b f(x) dx\)</span>. Test your code on functions where you know
the definite area. Then test your code on functions where you have
approximated the area by examining a plot (i.e. you have a visual
estimate of the area).
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-179" class="exercise"><strong>Exercise 3.40  </strong></span>Use the code that you wrote in the previous problem to test your
conjecture about the order of the approximation error for the trapezoid
rule. Integrate the function <span class="math inline">\(f(x) = \sin(x)\)</span> from <span class="math inline">\(x=0\)</span> to <span class="math inline">\(x=1\)</span> with more and more trapezoids. In
each case compare to the exact answer and find the absolute percent
error. The goal is to answer the question:<br />
<em>If we calculate the definite integral with a fixed <span class="math inline">\(\Delta x\)</span> and get an
absolute percent error, <span class="math inline">\(P\)</span>, then what absolute percent error will we get
if we use a width of <span class="math inline">\(\Delta x / M\)</span> for some positive number <span class="math inline">\(M\)</span>?</em>
</div>
<hr />
</div>
<div id="simpsons-rule" class="section level3" number="3.3.3">
<h3><span class="header-section-number">3.3.3</span> Simpsons Rule</h3>
<p>The trapezoidal rule does a decent job approximating integrals, but
ultimately you are using linear functions to approximate <span class="math inline">\(f(x)\)</span> and the
accuracy may suffer if the step size is too large or the function too
non-linear. You likely notice that the trapezoidal rule will give an
exact answer if you were to integrate a linear or constant function. A
potentially better approach would be to get an integral that evaluates
quadratic functions exactly. In order to do this we need to evaluate the
function at three points (not two like the trapezoidal rule). Let’s
integrate a function <span class="math inline">\(f(x)\)</span> on the interval <span class="math inline">\([a,b]\)</span> by using the three
points <span class="math inline">\((a,f(a))\)</span>, <span class="math inline">\((m,f(m))\)</span>, and <span class="math inline">\((b,f(b))\)</span> where <span class="math inline">\(m=\frac{a+b}{2}\)</span> is
the midpoint of the two boundary points.</p>
<p>We want to find constants <span class="math inline">\(A_1\)</span>, <span class="math inline">\(A_2\)</span>, and <span class="math inline">\(A_3\)</span> such that the integral
<span class="math inline">\(\int_a^b f(x) dx\)</span> can be written as a linear combination of <span class="math inline">\(f(a)\)</span>,
<span class="math inline">\(f(m)\)</span>, and <span class="math inline">\(f(b)\)</span>. Specifically, we want constants <span class="math inline">\(A_1\)</span>, <span class="math inline">\(A_2\)</span>, and
<span class="math inline">\(A_3\)</span> such that
<span class="math display">\[\int_a^b f(x) dx = A_1 f(a) + A_2 f(m) + A_3 f(b)\]</span>
is for all constant, linear, and quadratic functions. This would
guarantee that we have an exact integration method for all polynomials
of order 2 or less but should serve as a decent approximation if the
function is not quadratic.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-180" class="exercise"><strong>Exercise 3.41  </strong></span>Draw a picture showing what the previous two paragraphs discussed.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-181" class="exercise"><strong>Exercise 3.42  </strong></span>Follow these steps to find <span class="math inline">\(A_1\)</span>, <span class="math inline">\(A_2\)</span>, and <span class="math inline">\(A_3\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Prove that <span class="math display">\[\int_a^b 1 dx = b-a = A_1 + A_2 + A_3.\]</span></p></li>
<li><p>Prove that
<span class="math display">\[\int_a^b x dx = \frac{b^2 - a^2}{2} = A_1 a + A_2 \left( \frac{a+b}{2} \right) + A_3
        b.\]</span></p></li>
<li><p>Prove that
<span class="math display">\[\int_a^b x^2 dx = \frac{b^3 - a^3}{3} = A_1 a^2 + A_2 \left( \frac{a+b}{2} \right)^2
        + A_3 b^2.\]</span></p></li>
<li><p>Now solve the linear system of equations to prove that
<span class="math display">\[A_1 = \frac{b-a}{6}, \quad A_2 = \frac{4(b-a)}{6}, \quad \text{and} \quad
        A_3 = \frac{b-a}{6}.\]</span></p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-182" class="exercise"><strong>Exercise 3.43  </strong></span>At this point we can see that an integral can be approximated as
<span class="math display">\[\int_a^b f(x) dx \approx \left( \frac{b-a}{6} \right) \left( f(a) + 4f\left(
\frac{a+b}{2} \right) + f(b) \right)\]</span> and the technique will give an
exact answer for any polynomial of order 2 or below.</p>
<p>Verify the previous sentence by integrating <span class="math inline">\(f(x) = 1\)</span>, <span class="math inline">\(f(x) = x\)</span> and
<span class="math inline">\(f(x) = x^2\)</span> by hand on the interval <span class="math inline">\([0,1]\)</span> and using the approximation
formula
<span class="math display">\[\int_a^b f(x) dx \approx \left( \frac{b-a}{6} \right) \left( f(a) + 4f\left(
\frac{a+b}{2} \right) + f(b) \right).\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Use the method described above to approximate the area under the
curve <span class="math inline">\(f(x) = (1/5) x^2 (5-x)\)</span> on the interval <span class="math inline">\([1,4]\)</span>. To be clear,
you will be using the points <span class="math inline">\(a=1, m=2.5\)</span>, and <span class="math inline">\(b=4\)</span> in the above
derivation.</p></li>
<li><p>Next find the exact area under the curve <span class="math inline">\(g(x) = (-1/2)x^2 +3.3x -2\)</span>
on the interval <span class="math inline">\([1,4]\)</span>.</p></li>
<li><p>What do you notice about the two areas? What does this sample
problem tell you about the formula that we derived above?</p></li>
</ol>
</div>
<hr />
<p>To make the punchline of the previous exercises a bit more clear, using the formula
<span class="math display">\[\int_a^b f(x) dx \approx \left( \frac{a-b}{6} \right) \left( f(a) + 4 f(m) + f(b)
\right)\]</span> is the same as fitting a parabola to the three points
<span class="math inline">\((a,f(a))\)</span>, <span class="math inline">\((m,f(m))\)</span>, and <span class="math inline">\((b,f(b))\)</span> and finding the area under the
parabola exactly. That is exactly the step up from the trapezoid rule
and Riemann sums that we were after:</p>
<ul>
<li>Riemann sums approximate the function with constant functions,</li>
<li>the trapezoid rule uses linear functions, and</li>
<li>now we have a method for approximating with parabolas.</li>
</ul>
<p>To improve upon this idea we now examine the problem of partitioning the
interval <span class="math inline">\([a,b]\)</span> into small pieces and running this process on each
piece. This is called Simpson’s Rule for integration.</p>
<hr />

<div class="definition">
<p><span id="def:simpsons-rule" class="definition"><strong>Definition 3.4  (Simpson’s Rule)  </strong></span>Now we put the process explained above into a form that can be coded to
approximate integrals. We call this method Simpson’s Rule after <a href="https://en.wikipedia.org/wiki/Thomas_Simpson">Thomas Simpson (1710-1761)</a> who, by the way, was a basket weaver in his day job so he could pay the bills and keep doing math.</p>
<ol style="list-style-type: lower-alpha">
<li><p>First partition <span class="math inline">\([a,b]\)</span> into the set
<span class="math inline">\(\{x_0=a, x_1, x_2, \ldots, x_{n-1},  x_n=b\}\)</span>.</p></li>
<li><p>On each part of the partition approximate the area with a parabola:
<span class="math display">\[A_j = \frac{1}{6} \left[ f(x_j) + 4 f\left( \frac{x_j+x_{j-1}}{2} \right) +
                f(x_{j-1}) \right]\left( x_j - x_{j-1} \right)\]</span></p></li>
<li><p>Approximate the integral as <span class="math display">\[\int_a^b f(x) dx = \sum_{j=1}^n A_j\]</span></p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-183" class="exercise"><strong>Exercise 3.44  </strong></span>We have spent a lot of time over the past many pages building
approximations of the order of the error for numerical integration and
differentiation schemes. It is now up to you.<br />
Build a numerical experiment that allows you to conjecture the order of
the approximation error for Simpson’s rule. Remember that the goal is to
answer the question:<br />
<em>If I approximate the integral with a fixed <span class="math inline">\(\Delta x\)</span> and find an absolute percent error of <span class="math inline">\(P\)</span>, then what will the absolute percent error be using a width of <span class="math inline">\(\Delta x / M\)</span>?</em></p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-184" class="exercise"><strong>Exercise 3.45  </strong></span>Write a Python function that implements Simpson’s Rule. You should ALWAYS start by writing pseudo-code as comments in your file. You shouldn’t need a loop in your function.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-185" class="exercise"><strong>Exercise 3.46  </strong></span>Test your function on known integrals and approximate the order of the error based on the mesh size.
</div>
<hr />
<p>Thus far we have three numerical approximations for definite integrals:
Riemann sums (with rectangles), the trapezoidal rule, and Simpsons’s
rule. There are MANY other approximations for integrals and we leave the
further research to the curious reader.</p>
<hr />

<div class="theorem">
<span id="thm:num-int" class="theorem"><strong>Theorem 3.3  (Numerical Integration Schemes)  </strong></span>Let <span class="math inline">\(f(x)\)</span> be a continuous function on the interval <span class="math inline">\([a,b]\)</span>. The integral <span class="math inline">\(\int_a^b f(x) dx\)</span> can be approximated with any of the following.
<span class="math display">\[\begin{aligned}
       &amp;\text{Riemann Sum: }  \int_a^b f(x) dx \approx \sum_{j=1}^N f(x_j) \Delta x \\
       &amp; \qquad \text{Error for Left and Right Riemann Sums: } \mathcal{O}(\Delta x) \\
       &amp;\text{Riemann Sum: }  \int_a^b f(x) dx \approx \sum_{m=1}^N f(x_m) \Delta x \\
       &amp; \qquad \text{Error for Midpoint Riemann Sums: } \mathcal{O}(\Delta x^2) \\
       &amp;\text{Trapezoidal Rule: }  \int_a^b f(x) dx \approx \frac{1}{2} \sum_{j=1}^N
       \left( f(x_j) + f(x_{j-1}) \right) \Delta x \\
       &amp; \qquad \text{Error for Trapezoidal Rule: } \mathcal{O}(\Delta x^2) \\
       &amp;\text{Simpson&#39;s Rule: }  \int_a^b f(x) dx \approx \frac{1}{6} \sum_{j=1}^N \left(
       f(x_j) + 4 f\left( \frac{x_j + x_{j-1}}{2} \right) + f(x_{j-1}) \right) \Delta x \\
       &amp; \qquad \text{Error for Simpson&#39;s Rule: } \mathcal{O}(\Delta x^4) \\
    \end{aligned}\]</span> where <span class="math inline">\(\Delta x = x_j - x_{j-1}\)</span> and <span class="math inline">\(N\)</span> is the
number of subintervals.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-186" class="exercise"><strong>Exercise 3.47  </strong></span>Theorem <a href="ch-calculus.html#thm:num-int">3.3</a> simply states the error rates for our three
primary integration schemes. For this problem you need to empirically
verify these error rates. Use the integration problem and exact answer
<span class="math display">\[\int_0^{\pi/4} e^{3x} \sin(2x) dx = \frac{3}{13} e^{3\pi/4} + \frac{2}{13}\]</span>
and write code that produces a log-log error plot with <span class="math inline">\(\Delta x\)</span> on the
horizontal axis and the absolute error on the vertical axis. Fully
explain how the error rates show themselves in your plot.
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="optimization" class="section level2" number="3.4">
<h2><span class="header-section-number">3.4</span> Optimization</h2>
<div id="single-variable-optimization" class="section level3" number="3.4.1">
<h3><span class="header-section-number">3.4.1</span> Single Variable Optimization</h3>
<p>You likely recall that one of the major applications of Calculus was to
solve optimization problems – find the value of <span class="math inline">\(x\)</span> which makes some
function as big or as small as possible. The process itself can
sometimes be rather challenging due to either the modeling aspect of the
problems and/or the fact that the differentiation might be quite
cumbersome. In this section we will revisit those problems from
Calculus, but our goal will be to build a numerical method for the
Calculus step in hopes to avoid the messy algebra and differentiation.</p>
<hr />

<div class="exercise">
<p><span id="exr:cardboard-problem" class="exercise"><strong>Exercise 3.48  </strong></span>A piece of cardboard measuring 20cm by 20cm is to be cut so that it can be folded into a box without a lid (see Figure <a href="ch-calculus.html#fig:cardboard">3.8</a>). We want to find the size of the cut, <span class="math inline">\(x\)</span>, that maximizes the volume of the box.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Write a function for the volume of the box resulting from a cut of
size <span class="math inline">\(x\)</span>. What is the domain of your function?</p></li>
<li><p>We know that we want to maximize this function so go through the
full Calculus exercise to find the maximum:</p>
<ul>
<li><p>take the derivative</p></li>
<li><p>set it to zero</p></li>
<li><p>find the critical points</p></li>
<li><p>test the critical points and the boundaries of the domain using
the extreme value theorem to determine the <span class="math inline">\(x\)</span> that gives the
maximum.</p></li>
</ul></li>
</ol>
</div>
<div class="figure" style="text-align: center"><span id="fig:cardboard"></span>
<img src="images/Ch03_CardboardBox.png" alt="Folds to make a cardboard box" width="40%" />
<p class="caption">
Figure 3.8: Folds to make a cardboard box
</p>
</div>
<hr />
<p>The hard part of the single variable optimization process is often solving the equation <span class="math inline">\(f&#39;(x) = 0\)</span>. We could use numerical root finding schemes to solve this equation, but we could also potentially do better without actually finding the derivative. In the following we propose a few numerical techniques that can approximate the solution to these types of problems. The basic ideas are simple!</p>

<div class="exercise">
<span id="exr:unnamed-chunk-187" class="exercise"><strong>Exercise 3.49  </strong></span>If you were blind folded and standing on a hill could you find the top of the hill? (assume no trees and no cliffs …this isn’t supposed to be dangerous) How would you do it? Explain your technique clearly.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-188" class="exercise"><strong>Exercise 3.50  </strong></span>If you were blind folded and standing on a crater on the moon could you find the lowest point? How would you do it? Remember that you can hop as far as you like …because gravity …but sometimes that’s not a great thing because you could hop too far.
</div>
<hr />
<p>The intuition of numerical optimization schemes is typically to
visualize the function that you’re trying to minimize or maximize and
think about either climbing the hill to the top (maximization) or
descending the hill to the bottom (minimization).</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-189" class="exercise"><strong>Exercise 3.51  </strong></span>Let’s turn your intuitions into algorithms. If <span class="math inline">\(f(x)\)</span> is the function that you are trying to maximize then turn your ideas from the previous problems into step-by-step algorithms which could be coded. Then try out your codes on the function
<span class="math display">\[f(x) = e^{-x^2} + \sin(x^2)\]</span> to see if your algorithms can find the
local maximum near <span class="math inline">\(x \approx 1.14\)</span>. Try to generate several different algorithms.
</div>
<hr />
<p>Some of the most common algorithms are listed below. Read through them and see which one(s) you ended up recreating? The intuition for these algorithms is pretty darn simple – travel uphill if you want to maximize – travel downhill if you want to minimize.</p>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-190" class="definition"><strong>Definition 3.5  (Derivative Free Optimization)  </strong></span>Let <span class="math inline">\(f(x)\)</span> be the objective function which you are seeking to maximize
(or minimize).</p>
<ul>
<li><p>Pick a starting point, <span class="math inline">\(x_0\)</span>, and find the value of your objective
function at this point, <span class="math inline">\(f(x_0)\)</span>.</p></li>
<li><p>Pick a small step size (say, <span class="math inline">\(\Delta x \approx 0.01\)</span>).</p></li>
<li><p>Calculate the objective function one step to the left and one step
to the right from your starting point. Which ever point is larger
(if you’re seeking a maximum) is the point that you keep for your
next step.</p></li>
<li><p>Iterate (decide on a good stopping rule)</p></li>
</ul>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-191" class="exercise"><strong>Exercise 3.52  </strong></span>Write code to implement the 1D derivative free optimization algorithm and use it to solve Exercise <a href="ch-calculus.html#exr:cardboard-problem">3.48</a>. Compare your answer to the analytic solution.
</div>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-192" class="definition"><strong>Definition 3.6  (Gradient Descent/Ascent)  </strong></span>Let <span class="math inline">\(f(x)\)</span> be the objective function which you are seeking to maximize (or minimize).</p>
<ul>
<li><p>Find the derivative of your objective function, <span class="math inline">\(f&#39;(x)\)</span>.</p></li>
<li><p>Pick a starting point, <span class="math inline">\(x_0\)</span>.</p></li>
<li><p>Pick a small control parameter, <span class="math inline">\(\alpha\)</span> (in machine learning this
parameter is called the “learning rate” for the gradient descent
algorithm).</p></li>
<li><p>Use the iteration <span class="math inline">\(x_{n+1} = x_n + \alpha f&#39;(x_n)\)</span> if you’re
maximizing. Use the iteration <span class="math inline">\(x_{n+1} = x_n - \alpha f&#39;(x_n)\)</span> if
you’re minimizing.</p></li>
<li><p>Iterate (decide on a good stopping rule)</p></li>
</ul>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-193" class="exercise"><strong>Exercise 3.53  </strong></span>Write code to implement the 1D gradient descent algorithm and use it to solve Exercise <a href="ch-calculus.html#exr:cardboard-problem">3.48</a>. Compare your answer to the analytic solution.
</div>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-194" class="definition"><strong>Definition 3.7  (Monte-Carlo Search)  </strong></span>Let <span class="math inline">\(f(x)\)</span> be the objective function which you are seeking to maximize
(or minimize).</p>
<ul>
<li><p>Pick many (perhaps several thousand!) different <span class="math inline">\(x\)</span> values.</p></li>
<li><p>Find the value of the objective function at every one of these
points (Hint: use lists, not loops)</p></li>
<li><p>Keep the <span class="math inline">\(x\)</span> value that has the largest (or smallest if you’re
minimizing) value of the objective function.</p></li>
<li><p>Iterate many times and compare the function value in each iteration
to the previous best function value</p></li>
</ul>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-195" class="exercise"><strong>Exercise 3.54  </strong></span>Write code to implement the 1D monte carlo search algorithm and use it to solve Exercise <a href="ch-calculus.html#exr:cardboard-problem">3.48</a>. Compare your answer to the analytic solution.
</div>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-196" class="definition"><strong>Definition 3.8  (Optimization via Numerical Root Finding)  </strong></span>Let <span class="math inline">\(f(x)\)</span> be the objective function which you are seeking to maximize (or minimize).</p>
<ul>
<li><p>Find the derivative of your objective function.</p></li>
<li><p>Set the derivative to zero and use a numerical root finding method
(such as bisection or Newton) to find the critical point.</p></li>
<li><p>Use the extreme value theorem to determine if the critical point or
one of the endpoints is the maximum (or minimum).</p></li>
</ul>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-197" class="exercise"><strong>Exercise 3.55  </strong></span>Write code to implement the 1D numerical root finding optimization algorithm and use it to solve Exercise <a href="ch-calculus.html#exr:cardboard-problem">3.48</a>. Compare your answer to the analytic solution.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-198" class="exercise"><strong>Exercise 3.56  </strong></span>In this problem we will compare an contrast the four methods proposed in
the previous problem.</p>
<ol style="list-style-type: lower-alpha">
<li><p>What are the advantages to each of the methods proposed?</p></li>
<li><p>What are the disadvantages to each of the methods proposed?</p></li>
<li><p>Which method, do you suppose, will be faster in general? Why?</p></li>
<li><p>Which method, do you suppose, will be slower in general? Why?</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-199" class="exercise"><strong>Exercise 3.57  </strong></span>The Gradient Ascent/Descent algorithm is the most geometrically
interesting of the four that we have proposed. The others are pretty
brute force algorithms. What is the Gradient Ascent/Descent algorithm
doing geometrically? Draw a picture and be prepared to explain to your
peers.
</div>
<hr />

<div class="exercise">
<span id="exr:pig-numerical" class="exercise"><strong>Exercise 3.58  </strong></span>(This problem is modified from <span class="citation">[<a href="#ref-meerschaert" role="doc-biblioref">6</a>]</span>)<br />
A pig weighs 200 pounds and gains weight at a rate proportional to its
current weight. Today the growth rate if 5 pounds per day. The pig costs
45 cents per day to keep due mostly to the price of food. The market
price for pigs if 65 cents per pound but is falling at a rate of 1 cent
per day. When should the pig be sold and how much profit do you make on
the pig when you sell it? Write this situation as a single variable
mathematical model and solve the problem analytically (by hand). Then
solve the problem with all four methods outlined thus far in this
section.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-200" class="exercise"><strong>Exercise 3.59  </strong></span>(This problem is modified from <span class="citation">[<a href="#ref-meerschaert" role="doc-biblioref">6</a>]</span>)<br />
Reconsider the pig problem <a href="ch-calculus.html#exr:pig-numerical">3.58</a> but now suppose that the weight of the pig after <span class="math inline">\(t\)</span> days is <span class="math display">\[w = \frac{800}{1+3e^{-t/30}} \text{ pounds}.\]</span>
When should the pig be sold and how much profit do you make on the pig
when you sell it? Write this situation as a single variable mathematical
model. You should notice that the algebra and calculus for solving this
problem is no longer really a desirable way to go. Use an appropriate
numerical technique to solve this problem.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-201" class="exercise"><strong>Exercise 3.60  </strong></span>Numerical optimization is often seen as quite challenging since the algorithms that we have introduced here could all get “stuck” at local extrema. To illustrate this see the function shown in Figure <a href="ch-calculus.html#fig:num-opt-challenging">3.9</a>. How will derivative free optimization methods have trouble finding the red point starting at the black point with this function? How will gradient descent/ascent methods have trouble? Why?</p>
</div>
<div class="figure" style="text-align: center"><span id="fig:num-opt-challenging"></span>
<img src="images/Ch03_HardOptimization.png" alt="A challenging numerical optimization problem. If we start at the black point then how will any of our algorithms find the local minimum at the red point?" width="50%" />
<p class="caption">
Figure 3.9: A challenging numerical optimization problem. If we start at the black point then how will any of our algorithms find the local minimum at the red point?
</p>
</div>
<hr />
</div>
<div id="multivariable-optimization" class="section level3" number="3.4.2">
<h3><span class="header-section-number">3.4.2</span> Multivariable Optimization</h3>
<p>Now let’s look at multivariable optimization. The analytic process for
finding optimal solutions is essentially the same as for single
variable.</p>
<ul>
<li><p>Write a function that models a scenario in multiple variables,</p></li>
<li><p>find the gradient vector (presuming that the function is
differentiable),</p></li>
<li><p>set the gradient vector equal to the zero vector and solve for the
critical point(s), and</p></li>
<li><p>interpret your answer in the context of the problem.</p></li>
</ul>
<p>The trouble with unconstrained multivariable optimization is that
finding the critical points is now equivalent to solving a system of
nonlinear equations; a task that is likely impossible even with a
computer algebra system.</p>
<p>Let’s see if you can extend your intuition from single variable to
multivariable. This particular subsection is intentionally quite brief. If you want more details on multivariable optimization it would be wise to take a full course in optimization.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-202" class="exercise"><strong>Exercise 3.61  </strong></span>The derivative free optimization method discussed in the single variable
optimization section just said that you should pick two points and pick
the one that takes you furthest uphill.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Why is it insufficient to choose just two points if we are dealing
with a function of two variables? Hint: think about contour line.</p></li>
<li><p>For a function of two variables, how many points should you use to
compare and determine the direction of “uphill”?</p></li>
<li><p>Extend your answer from part (b) to <span class="math inline">\(n\)</span> dimensions. How many points
should we compare if we are in <span class="math inline">\(n\)</span> dimensions and need to determine
which direction is “uphill”?</p></li>
<li><p>Back in the case of a two-variable function, you should have decided
that three points was best. Explain an algorithm for moving one
point at a time so that your three points eventually converge to a
nearby local maximum. It may be helpful to make a surface plot or a
contour plot of a well-known function just as a visual.</p></li>
</ol>
<p>The clode below will demonstrate how to make a contour plot.</p>
</div>
<div class="sourceCode" id="cb12"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb12-1"><a href="ch-calculus.html#cb12-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb12-2"><a href="ch-calculus.html#cb12-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb12-3"><a href="ch-calculus.html#cb12-3"></a>xdomain <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">100</span>)</span>
<span id="cb12-4"><a href="ch-calculus.html#cb12-4"></a>ydomain <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">4</span>,<span class="dv">4</span>,<span class="dv">100</span>)</span>
<span id="cb12-5"><a href="ch-calculus.html#cb12-5"></a>X, Y <span class="op">=</span> np.meshgrid(xdomain,ydomain)</span>
<span id="cb12-6"><a href="ch-calculus.html#cb12-6"></a>f <span class="op">=</span> <span class="kw">lambda</span> x, y: np.sin(x)<span class="op">*</span>np.cos(x)</span>
<span id="cb12-7"><a href="ch-calculus.html#cb12-7"></a>plt.contour(X,Y,f(X,Y))</span>
<span id="cb12-8"><a href="ch-calculus.html#cb12-8"></a>plt.grid()</span>
<span id="cb12-9"><a href="ch-calculus.html#cb12-9"></a>plt.show()</span></code></pre></div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-204" class="exercise"><strong>Exercise 3.62  </strong></span>Now let’s tackle the gradient ascent/descent algorithm. You should
recall that the gradient vector points in the direction of maximum
change. How can you use this fact to modify the gradient ascent/descent
algorithm given previously? Clearly write your algorithm so that a
classmate could turn it into code.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-205" class="exercise"><strong>Exercise 3.63  </strong></span>How does the Monte Carlo algorithm extend to a two-variable optimization
problem? Clearly write your algorithm.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-206" class="exercise"><strong>Exercise 3.64  </strong></span>Try out the gradient descent/ascent and Monte Carlo algorithms on the function
<span class="math inline">\(f(x,y) = \sin(x)\cos(y) + 0.1 x^2\)</span> which has many local extrema and no global
maximum. We are not going to code the multidimensional derivative free optimization routine in this section.
</div>
<hr />
<p>The derivative free, gradient ascent/descent, and monte carlo techniques
still have good analogues in higher dimensions. We just need to be a bit
careful since in higher dimensions there is much more room to move.
Below we’ll give the full description of the gradient ascent/descent
algorithm. We don’t give the full description of the derivative free or
Monte Carlo algorithms since there are many ways to implement them. The
interested reader should see a course in mathematical optimization or
machine learning.</p>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-207" class="definition"><strong>Definition 3.9  (The Gradient Descent Algorithm)  </strong></span>We want to solve the problem
<span class="math display">\[\text{minimize } f(x_1, x_2, \ldots, x_n) \text{ subject to }(x_1, x_2, \ldots, x_n) \in S.\]</span></p>
<ol style="list-style-type: lower-alpha">
<li><p>Choose an arbitrary starting point
<span class="math inline">\(\boldsymbol{x}_0 = (x_1,x_2,\ldots,x_n)\in S\)</span>.</p></li>
<li><p>We are going to define a difference equation that gives successive
guesses for the optimal value:
<span class="math display">\[\boldsymbol{x}_{n+1} = \boldsymbol{x}_n - \alpha \nabla f(\boldsymbol{x}_n).\]</span> The difference
equation says to follow the negative gradient a certain distance
from your present point (why are we doing this). Note that the value
of <span class="math inline">\(\alpha\)</span> is up to you so experiment with a few values (you should
probably take <span class="math inline">\(\alpha \le 1\)</span> …why?).</p></li>
<li><p>Repeat the iterative process in step b until two successive points
are <em>close enough</em> to each other.</p></li>
</ol>
</div>
<hr />
<p>Take Note: If you are looking to maximize your objective function then in the
Monte-Carlo search you should examine if <span class="math inline">\(z\)</span> is greater than your
current largest value. For gradient descent you should actually do a
gradient <em>ascent</em> instead and follow the positive gradient instead of the
negative gradient.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-208" class="exercise"><strong>Exercise 3.65  </strong></span>The functions like <span class="math inline">\(f(x,y) = \sin(x)\cos(y)\)</span> have many local extreme
values which makes optimization challenging. Implement your Gradient
Descent code on this function to find the local minimum <span class="math inline">\((0,0)\)</span>. Start
somewhere near <span class="math inline">\((0,0)\)</span> and show by way of example that your gradient
descent code may not converge to this particular local minimum. Why is
this important?
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="calculus-with-numpy-and-scipy" class="section level2" number="3.5">
<h2><span class="header-section-number">3.5</span> Calculus with <code>numpy</code> and <code>scipy</code></h2>
<p>In this section we will look at some highly versatile functions built into the <code>numpy</code> and <code>scipy</code> libraries in Python. These libraries allow us to lean on pre-built numerical routines for calculus and optimization and instead we can focus our energies on setting up the problems and interpreting solutions. The down side here is that we are going to treat some of the optimization routines in Python as black boxes, so part of the goal of this section is to partially unpack these black boxes so that we know what’s going on under the hood. If you haven’t done Exercise <a href="ch-algebra.html#exr:fsolve">2.65</a> yet you may want to do so now in order to get used to some of the syntax used by the Python <code>scipy</code> library.</p>
<div id="differentiation-1" class="section level3" number="3.5.1">
<h3><span class="header-section-number">3.5.1</span> Differentiation</h3>
<p>There are two main tools built into the <code>numpy</code> and <code>scipy</code> libraries that do numerical differentiation. In <code>numpy</code> there is the <code>np.diff()</code> command. In <code>scipy</code> there is the <code>scipy.misc.derivative()</code> command.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-209" class="exercise"><strong>Exercise 3.66  </strong></span>In the following blocks of Python code we demonstrate what the <code>np.diff()</code> command does. Use these examples to give a thorough description for what <code>np.diff()</code> does to a Python list.
</div>
<p><strong>First example of <code>np.diff()</code>:</strong></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb13-1"><a href="ch-calculus.html#cb13-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb13-2"><a href="ch-calculus.html#cb13-2"></a>myList <span class="op">=</span> np.arange(<span class="dv">0</span>,<span class="dv">10</span>)</span>
<span id="cb13-3"><a href="ch-calculus.html#cb13-3"></a><span class="bu">print</span>(myList)</span></code></pre></div>
<pre><code>## [0 1 2 3 4 5 6 7 8 9]</code></pre>
<div class="sourceCode" id="cb15"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb15-1"><a href="ch-calculus.html#cb15-1"></a><span class="bu">print</span>( np.diff(myList) )</span></code></pre></div>
<pre><code>## [1 1 1 1 1 1 1 1 1]</code></pre>
<p><strong>Second example of <code>np.diff()</code>:</strong></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb17-1"><a href="ch-calculus.html#cb17-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb17-2"><a href="ch-calculus.html#cb17-2"></a>myList <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb17-3"><a href="ch-calculus.html#cb17-3"></a><span class="bu">print</span>(myList)</span></code></pre></div>
<pre><code>## [0.  0.2 0.4 0.6 0.8 1. ]</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb19-1"><a href="ch-calculus.html#cb19-1"></a><span class="bu">print</span>( np.diff(myList) )</span></code></pre></div>
<pre><code>## [0.2 0.2 0.2 0.2 0.2]</code></pre>
<p><strong>Third example of <code>np.diff()</code>:</strong></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb21-1"><a href="ch-calculus.html#cb21-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb21-2"><a href="ch-calculus.html#cb21-2"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb21-3"><a href="ch-calculus.html#cb21-3"></a>dx <span class="op">=</span> x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">0</span>]</span>
<span id="cb21-4"><a href="ch-calculus.html#cb21-4"></a>y <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb21-5"><a href="ch-calculus.html#cb21-5"></a>dy <span class="op">=</span> <span class="dv">2</span><span class="op">*</span>x</span>
<span id="cb21-6"><a href="ch-calculus.html#cb21-6"></a><span class="bu">print</span>(<span class="st">&quot;function values: </span><span class="ch">\n</span><span class="st">&quot;</span>,y)</span></code></pre></div>
<pre><code>## function values: 
##  [0.   0.04 0.16 0.36 0.64 1.  ]</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb23-1"><a href="ch-calculus.html#cb23-1"></a><span class="bu">print</span>(<span class="st">&quot;exact values of derivative: </span><span class="ch">\n</span><span class="st">&quot;</span>,dy)</span></code></pre></div>
<pre><code>## exact values of derivative: 
##  [0.  0.4 0.8 1.2 1.6 2. ]</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb25-1"><a href="ch-calculus.html#cb25-1"></a><span class="bu">print</span>(<span class="st">&quot;values from np.diff(): </span><span class="ch">\n</span><span class="st">&quot;</span>,np.diff(y))</span></code></pre></div>
<pre><code>## values from np.diff(): 
##  [0.04 0.12 0.2  0.28 0.36]</code></pre>
<div class="sourceCode" id="cb27"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb27-1"><a href="ch-calculus.html#cb27-1"></a><span class="bu">print</span>(<span class="st">&quot;values from np.diff()/dx: </span><span class="ch">\n</span><span class="st">&quot;</span>,np.diff(y) <span class="op">/</span> dx )</span></code></pre></div>
<pre><code>## values from np.diff()/dx: 
##  [0.2 0.6 1.  1.4 1.8]</code></pre>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-213" class="exercise"><strong>Exercise 3.67  </strong></span>Why does the <code>np.diff()</code> command produce a list that is one element shorter than the original list?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-214" class="exercise"><strong>Exercise 3.68  </strong></span>If we have a list of <span class="math inline">\(x\)</span> values and a list of <span class="math inline">\(y\)</span> values for a function <span class="math inline">\(y=f(x)\)</span> then how do we use <code>np.diff()</code> to approximate the first derivative of <span class="math inline">\(f(x)\)</span>? What is the order of the error in the approximation?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-215" class="exercise"><strong>Exercise 3.69  </strong></span>What does the following block of Python code do?
</div>
<div class="sourceCode" id="cb29"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb29-1"><a href="ch-calculus.html#cb29-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb29-2"><a href="ch-calculus.html#cb29-2"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">6</span>)</span>
<span id="cb29-3"><a href="ch-calculus.html#cb29-3"></a>dx <span class="op">=</span> x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">0</span>]</span>
<span id="cb29-4"><a href="ch-calculus.html#cb29-4"></a>y <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb29-5"><a href="ch-calculus.html#cb29-5"></a><span class="bu">print</span>( np.diff(y,<span class="dv">2</span>) <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> )</span></code></pre></div>
<pre><code>## [2. 2. 2. 2.]</code></pre>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-217" class="exercise"><strong>Exercise 3.70  </strong></span>Use the <code>np.diff()</code> command to approximate the first and second derivatives of the function <span class="math inline">\(f(x) = x\sin(x) - \ln(x)\)</span> on the domain <span class="math inline">\([1,5]\)</span>. Then create a plot that shows <span class="math inline">\(f(x)\)</span> and the approximations of <span class="math inline">\(f&#39;(x)\)</span> and <span class="math inline">\(f&#39;&#39;(x)\)</span>.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-218" class="exercise"><strong>Exercise 3.71  </strong></span>Next we look into the <code>scipy.misc.derivative()</code> command from the <code>scipy</code> library. This will be another way to calculate the derivative of a function. One advantage will be that you can just send in a Python function (or a lambda function) without actually computing the lists of values. Examine the following Python code and fully describe what it does.
</div>
<div class="sourceCode" id="cb31"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb31-1"><a href="ch-calculus.html#cb31-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb31-2"><a href="ch-calculus.html#cb31-2"></a><span class="im">import</span> scipy.misc</span>
<span id="cb31-3"><a href="ch-calculus.html#cb31-3"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb31-4"><a href="ch-calculus.html#cb31-4"></a>x <span class="op">=</span> np.linspace(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">5</span>)</span>
<span id="cb31-5"><a href="ch-calculus.html#cb31-5"></a>df <span class="op">=</span> scipy.misc.derivative(f,x,dx <span class="op">=</span> <span class="fl">1e-10</span>)</span>
<span id="cb31-6"><a href="ch-calculus.html#cb31-6"></a><span class="bu">print</span>(df)</span></code></pre></div>
<pre><code>## [ 2.00000017  4.00000033  6.0000005   8.00000066 10.00000083]</code></pre>
<p>One advantage to using <code>scipy.misc.derivative()</code> is that you get to dictate the error in the derivative computation, and that error is not tied to the list of values that you provide. In its simplest form you can provide just a single <span class="math inline">\(x\)</span> value just like in the next block of code.</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb33-1"><a href="ch-calculus.html#cb33-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb33-2"><a href="ch-calculus.html#cb33-2"></a><span class="im">import</span> scipy.misc</span>
<span id="cb33-3"><a href="ch-calculus.html#cb33-3"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb33-4"><a href="ch-calculus.html#cb33-4"></a>df <span class="op">=</span> scipy.misc.derivative(f,<span class="dv">1</span>,dx <span class="op">=</span> <span class="fl">1e-10</span>) <span class="co"># derivative at x=1</span></span>
<span id="cb33-5"><a href="ch-calculus.html#cb33-5"></a><span class="bu">print</span>(df)</span></code></pre></div>
<pre><code>## 2.000000165480742</code></pre>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-221" class="exercise"><strong>Exercise 3.72  </strong></span>In the following code we find the first and second derivatives of <span class="math inline">\(f(x) = x\sin(x) - \ln(x)\)</span> using <code>scipy.misc.derivative()</code>. Notice that we’ve chosen to take <code>dx=1e-6</code> for each of the derivative computations. That may seem like an odd choice, but there is more going on here. Try successively smaller and smaller values for the <code>dx</code> parameter. What do you find? Why does it happen?
</div>
<div class="sourceCode" id="cb35"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb35-1"><a href="ch-calculus.html#cb35-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb35-2"><a href="ch-calculus.html#cb35-2"></a><span class="im">import</span> scipy.misc </span>
<span id="cb35-3"><a href="ch-calculus.html#cb35-3"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb35-4"><a href="ch-calculus.html#cb35-4"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.sin(x)<span class="op">*</span>x<span class="op">-</span>np.log(x)</span>
<span id="cb35-5"><a href="ch-calculus.html#cb35-5"></a>x <span class="op">=</span> np.linspace(<span class="dv">1</span>,<span class="dv">5</span>,<span class="dv">100</span>) <span class="co"># x domain: 100 points between 1 and 5</span></span>
<span id="cb35-6"><a href="ch-calculus.html#cb35-6"></a>df <span class="op">=</span> scipy.misc.derivative(f,x,dx<span class="op">=</span><span class="fl">1e-6</span>)</span>
<span id="cb35-7"><a href="ch-calculus.html#cb35-7"></a>df2 <span class="op">=</span> scipy.misc.derivative(f,x,dx<span class="op">=</span><span class="fl">1e-6</span>,n<span class="op">=</span><span class="dv">2</span>)</span>
<span id="cb35-8"><a href="ch-calculus.html#cb35-8"></a>plt.plot(x,f(x),<span class="st">&#39;b&#39;</span>,x,df,<span class="st">&#39;r--&#39;</span>,x,df2,<span class="st">&#39;k--&#39;</span>)</span>
<span id="cb35-9"><a href="ch-calculus.html#cb35-9"></a>plt.legend([<span class="st">&quot;f(x)&quot;</span>,<span class="st">&quot;f&#39;(x)&quot;</span>,<span class="st">&quot;f&#39;&#39;(x)&quot;</span>])</span>
<span id="cb35-10"><a href="ch-calculus.html#cb35-10"></a>plt.grid()</span>
<span id="cb35-11"><a href="ch-calculus.html#cb35-11"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-223"></span>
<img src="images/Ch03_ScipyDerivatives.png" alt="Derivatives with scipy" width="75%" />
<p class="caption">
Figure 3.10: Derivatives with scipy
</p>
</div>
<hr />
</div>
<div id="integration-1" class="section level3" number="3.5.2">
<h3><span class="header-section-number">3.5.2</span> Integration</h3>
<p>In <code>numpy</code> there is a nice tool called <code>np.trapz()</code> that implements the trapezoidal rule. In the following problem you will find several examples of the <code>np.trapz()</code> command. Use these examples to determine how the command works to integrate functions.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-224" class="exercise"><strong>Exercise 3.73  </strong></span>First we’ll approximate the integral <span class="math inline">\(\int_{-2}^2 x^2 dx\)</span>. The exact answer is
<span class="math display">\[ \int_{-2}^2 x^2 dx = \frac{x^3}{3} \Big|_{-2}^2 = \frac{16}{3} = 5.3333... \]</span>
</div>
<div class="sourceCode" id="cb36"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb36-1"><a href="ch-calculus.html#cb36-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb36-2"><a href="ch-calculus.html#cb36-2"></a>x <span class="op">=</span> np.linspace(<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>,<span class="dv">100</span>)</span>
<span id="cb36-3"><a href="ch-calculus.html#cb36-3"></a>dx <span class="op">=</span> x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">0</span>]</span>
<span id="cb36-4"><a href="ch-calculus.html#cb36-4"></a>y <span class="op">=</span> x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb36-5"><a href="ch-calculus.html#cb36-5"></a><span class="bu">print</span>(<span class="st">&quot;Approximate integral is &quot;</span>,np.trapz(y)<span class="op">*</span>dx)</span></code></pre></div>
<pre><code>## Approximate integral is  5.334421657653986</code></pre>
<p>Next we’ll approximate <span class="math inline">\(\int_0^{2\pi} \sin(x) dx\)</span>. We know that the exact value is 0.</p>
<div class="sourceCode" id="cb38"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb38-1"><a href="ch-calculus.html#cb38-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb38-2"><a href="ch-calculus.html#cb38-2"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">2</span><span class="op">*</span>np.pi,<span class="dv">100</span>)</span>
<span id="cb38-3"><a href="ch-calculus.html#cb38-3"></a>dx <span class="op">=</span> x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">0</span>]</span>
<span id="cb38-4"><a href="ch-calculus.html#cb38-4"></a>y <span class="op">=</span> np.sin(x)</span>
<span id="cb38-5"><a href="ch-calculus.html#cb38-5"></a><span class="bu">print</span>(<span class="st">&quot;Approximate integral is &quot;</span>,np.trapz(y)<span class="op">*</span>dx)</span></code></pre></div>
<pre><code>## Approximate integral is  -2.2019371830862577e-17</code></pre>
<p>Pick a function and an interval for which you know the exact definite integral. Demonstrate how to use <code>np.trapz()</code> on your definite integral.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-227" class="exercise"><strong>Exercise 3.74  </strong></span>Notice in the last examples that we multiplied the result of the <code>np.trapz()</code> command by <code>dx</code>. Why did we do this? What is the <code>np.trapz()</code> command doing without the <code>dx</code>?
</div>
<hr />
<p>In the <code>scipy</code> library there is a more general tool called <code>scipy.integrate.quad()</code>. The term “quad” is short for “quadrature”. In numerical analysis literature rules like Simpson’s rule are called quadrature rules for integration. The function <code>scipy.integrate.quad()</code> accepts a Python function (or a lambda function) and the bounds of the definite integral. It outputs an approximation of the integral along with an approximation of the error in the integral calculation. See the Python code below.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb40-1"><a href="ch-calculus.html#cb40-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb40-2"><a href="ch-calculus.html#cb40-2"></a><span class="im">import</span> scipy.integrate</span>
<span id="cb40-3"><a href="ch-calculus.html#cb40-3"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: x<span class="op">**</span><span class="dv">2</span></span>
<span id="cb40-4"><a href="ch-calculus.html#cb40-4"></a>I <span class="op">=</span> scipy.integrate.quad(f,<span class="op">-</span><span class="dv">2</span>,<span class="dv">2</span>)</span>
<span id="cb40-5"><a href="ch-calculus.html#cb40-5"></a><span class="bu">print</span>(I)</span></code></pre></div>
<pre><code>## (5.333333333333333, 5.921189464667501e-14)</code></pre>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-229" class="exercise"><strong>Exercise 3.75  </strong></span>What are the advantages and disadvantages to using the <code>scipy.integrate.quad()</code> command as compared to the <code>np.trapz()</code> command.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-230" class="exercise"><strong>Exercise 3.76  </strong></span>If you have data for the hourly rate at which water is being drained from a dam and you want to find the total amount of water drained over the course of the time in the dataset, then which of the tools that we know would you use? Why?
</div>
<hr />
</div>
<div id="optimization-1" class="section level3" number="3.5.3">
<h3><span class="header-section-number">3.5.3</span> Optimization</h3>
<p>As you’ve seen in this section there are many tools built into <code>numpy</code> and <code>scipy</code> that will do some of our basic numerical computations. The same is true for numerical optimization problems. Keep in mind throughout the remainder of this section that the whole topic of numerical optimization is still an active area of research and there is much more to the story that what we’ll see here. However, the Python tools that we will use are highly optimized and tend to work quite well.</p>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-231" class="exercise"><strong>Exercise 3.77  </strong></span>Let’s solve a very simple function minimization problem to get started. Consider the function <span class="math inline">\(f(x) = (x-3)^2 - 5\)</span>. A moment’s thought reveals that the global minimum of this parabolic function occurs at <span class="math inline">\((3,-5)\)</span>. We can have <code>scipy.optimize.minimize()</code> find this value for us numerically. The routine is much like Newton’s Method in that we give it a starting point <em>near</em> where we think the optimum will be and it will iterate through some algorithm (like a derivative free optimization routine) to approximate the minimum.
</div>
<div class="sourceCode" id="cb42"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb42-1"><a href="ch-calculus.html#cb42-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb42-2"><a href="ch-calculus.html#cb42-2"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize</span>
<span id="cb42-3"><a href="ch-calculus.html#cb42-3"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: (x<span class="op">-</span><span class="dv">3</span>)<span class="op">**</span><span class="dv">2</span> <span class="op">-</span> <span class="dv">5</span></span>
<span id="cb42-4"><a href="ch-calculus.html#cb42-4"></a>minimize(f,<span class="dv">2</span>)</span></code></pre></div>
<pre><code>##       fun: -5.0
##  hess_inv: array([[0.49999999]])
##       jac: array([0.])
##   message: &#39;Optimization terminated successfully.&#39;
##      nfev: 9
##       nit: 2
##      njev: 3
##    status: 0
##   success: True
##         x: array([2.99999998])</code></pre>
<ol style="list-style-type: lower-alpha">
<li>Implement the code above then spend some time playing around with the minimize command to minimize more challenging functions.</li>
<li>Explain what all of the output information is from the <code>.minimize()</code> command.</li>
</ol>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-233" class="exercise"><strong>Exercise 3.78  </strong></span>There is not a function called <code>scipy.optimize.maximize()</code>. Instead, Python expects you to rewrite every maximization problem as a minimization problem. How do you do that?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-234" class="exercise"><strong>Exercise 3.79  </strong></span>Solve Exercise <a href="ch-calculus.html#exr:cardboard-problem">3.48</a> using <code>scipy.optimize.minimize()</code>.
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="least-squares-curve-fitting" class="section level2" number="3.6">
<h2><span class="header-section-number">3.6</span> Least Squares Curve Fitting</h2>
<p>In this section we’ll change our focus a bit to look at a different question from algebra, and, in turn, reveal a hidden numerical optimization problem where the <code>scipy.optimize.minimize()</code> tool will come in quite handy.</p>
<p>Here is the primary question of interest:<br />
<em>If we have a few data points and a reasonable guess for the type of function fitting the points, how would we determine the actual function?</em></p>
<p>You may recognize this as the basic question of regression from statistics. What we will do here is pose the statistical question of which curve best fits a data set as an optimization problem. Then we will use the tools that we’ve built so far to solve the optimization problem.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-235" class="exercise"><strong>Exercise 3.80  </strong></span>Consider the function <span class="math inline">\(f(x)\)</span> that goes exactly through the points
<span class="math inline">\((0,1)\)</span>, <span class="math inline">\((1,4)\)</span>, and <span class="math inline">\((2,13)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find a function that goes through these points exactly. Be able to
defend your work.</p></li>
<li><p>Is your function unique? That is to say, is there another function
out there that also goes exactly through these points?</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:first-least-squares" class="exercise"><strong>Exercise 3.81  </strong></span>Now let’s make a minor tweak to the previous problem. Let’s say that we
have the data points <span class="math inline">\((0,1.07)\)</span>, <span class="math inline">\((1,3.9)\)</span>, <span class="math inline">\((2,14.8)\)</span>, and <span class="math inline">\((3,26.8)\)</span>.
Notice that these points are <em>close</em> to the points we had in the
previous problem, but all of the <span class="math inline">\(y\)</span> values have a little noise in them
and we have added a fourth point. If we suspect that a function <span class="math inline">\(f(x)\)</span>
that <em>best</em> fits this data is quadratic then <span class="math inline">\(f(x) = ax^2 +  bx + c\)</span> for some constants <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Plot the four points along with the function <span class="math inline">\(f(x)\)</span> for arbitrarily
chosen values of <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span>.</p></li>
<li><p>Work with your partner(s) to systematically change <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span> so that you get a good visual match to the data. The Python code below will help you get started.</p></li>
</ol>
</div>
<div class="sourceCode" id="cb44"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb44-1"><a href="ch-calculus.html#cb44-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb44-2"><a href="ch-calculus.html#cb44-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb44-3"><a href="ch-calculus.html#cb44-3"></a>xdata <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb44-4"><a href="ch-calculus.html#cb44-4"></a>ydata <span class="op">=</span> np.array([<span class="fl">1.07</span>, <span class="fl">3.9</span>, <span class="fl">14.8</span>, <span class="fl">26.8</span>])</span>
<span id="cb44-5"><a href="ch-calculus.html#cb44-5"></a>a <span class="op">=</span> <span class="co"># conjecture a value of a</span></span>
<span id="cb44-6"><a href="ch-calculus.html#cb44-6"></a>b <span class="op">=</span> <span class="co"># conjecture a value of b</span></span>
<span id="cb44-7"><a href="ch-calculus.html#cb44-7"></a>c <span class="op">=</span> <span class="co"># conjecture a value of c</span></span>
<span id="cb44-8"><a href="ch-calculus.html#cb44-8"></a>x <span class="op">=</span> <span class="co"># build an x domain starting at 0 and going through 4 </span></span>
<span id="cb44-9"><a href="ch-calculus.html#cb44-9"></a>guess <span class="op">=</span> a<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">*</span>x <span class="op">+</span> c</span>
<span id="cb44-10"><a href="ch-calculus.html#cb44-10"></a><span class="co"># make a plot of the data</span></span>
<span id="cb44-11"><a href="ch-calculus.html#cb44-11"></a><span class="co"># make a plot of your function on top of the data</span></span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-237"></span>
<img src="images/Ch03_DataMatch.png" alt="Initial attempt at matching data with a quadratic." width="75%" />
<p class="caption">
Figure 3.11: Initial attempt at matching data with a quadratic.
</p>
</div>
<p>As an alternative to loading the data manually we could download the data from the book’s github page. All datasets in the text can be loaded in this way. We will be using the <code>pandas</code> library (a Python data science library) to load the <code>.csv</code> files.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb45-1"><a href="ch-calculus.html#cb45-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb45-2"><a href="ch-calculus.html#cb45-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb45-3"><a href="ch-calculus.html#cb45-3"></a>URL1 <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb45-4"><a href="ch-calculus.html#cb45-4"></a>URL2 <span class="op">=</span> <span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb45-5"><a href="ch-calculus.html#cb45-5"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb45-6"><a href="ch-calculus.html#cb45-6"></a>data <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit1.csv&#39;</span>) )</span>
<span id="cb45-7"><a href="ch-calculus.html#cb45-7"></a><span class="co"># Exercise3_datafit1.csv</span></span>
<span id="cb45-8"><a href="ch-calculus.html#cb45-8"></a>xdata <span class="op">=</span> data[:,<span class="dv">0</span>]</span>
<span id="cb45-9"><a href="ch-calculus.html#cb45-9"></a>ydata <span class="op">=</span> data[:,<span class="dv">1</span>]</span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-239" class="exercise"><strong>Exercise 3.82  </strong></span>Now let’s be a bit more systematic about things from the previous problem. Let’s say that you have a pretty good guess that <span class="math inline">\(b \approx 2\)</span> and <span class="math inline">\(c \approx 0.7\)</span>. We need to get a good estimate for <span class="math inline">\(a\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Pick an arbitrary starting value for <span class="math inline">\(a\)</span> then for each of the four points find the error between the predicted <span class="math inline">\(y\)</span> value and the actual <span class="math inline">\(y\)</span> value. These errors are called the <em>residuals</em>.</li>
<li>Square all four of your errors and add them up. (Pause, ponder, and discuss: why are we squaring the errors before we sum them?)</li>
<li>Now change your value of <span class="math inline">\(a\)</span> to several different values and record the sum of the square errors for each of your values of <span class="math inline">\(a\)</span>. It may be worth while to use a spreadsheet to keep track of your work here.</li>
<li>Make a plot with the value of <span class="math inline">\(a\)</span> on the horizontal axis and the value of the sum of the square errors on the vertical axis. Use your plot to defend the optimal choice for <span class="math inline">\(a\)</span>.</li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-240" class="exercise"><strong>Exercise 3.83  </strong></span>We’re going to revisit part (c) of the previous problem. Write a loop that tries many values of <span class="math inline">\(a\)</span> in very small increments and calculates the sum of the squared errors. The following partial Python code should help you get started. In the resulting plot you should see a clear local minimum. What does that minimum tell you about solving this problem?
</div>
<div class="sourceCode" id="cb46"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb46-1"><a href="ch-calculus.html#cb46-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb46-2"><a href="ch-calculus.html#cb46-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb46-3"><a href="ch-calculus.html#cb46-3"></a>xdata <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb46-4"><a href="ch-calculus.html#cb46-4"></a>ydata <span class="op">=</span> np.array([<span class="fl">1.07</span>, <span class="fl">3.9</span>, <span class="fl">14.8</span>, <span class="fl">26.8</span>])</span>
<span id="cb46-5"><a href="ch-calculus.html#cb46-5"></a>b <span class="op">=</span> <span class="dv">2</span></span>
<span id="cb46-6"><a href="ch-calculus.html#cb46-6"></a>c <span class="op">=</span> <span class="fl">0.75</span></span>
<span id="cb46-7"><a href="ch-calculus.html#cb46-7"></a>A <span class="op">=</span> <span class="co"># give a numpy array of values for a</span></span>
<span id="cb46-8"><a href="ch-calculus.html#cb46-8"></a>SumSqRes <span class="op">=</span> [] <span class="co"># this is storage for the sum of the sq. residuals</span></span>
<span id="cb46-9"><a href="ch-calculus.html#cb46-9"></a><span class="cf">for</span> a <span class="kw">in</span> A:</span>
<span id="cb46-10"><a href="ch-calculus.html#cb46-10"></a>  guess <span class="op">=</span> a<span class="op">*</span>xdata<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> b<span class="op">*</span>xdata <span class="op">+</span> c</span>
<span id="cb46-11"><a href="ch-calculus.html#cb46-11"></a>  residuals <span class="op">=</span> <span class="co"># write code to calculate the residuals</span></span>
<span id="cb46-12"><a href="ch-calculus.html#cb46-12"></a>  SumSqRes.append( ??? ) <span class="co"># calculate the sum of the squ. residuals</span></span>
<span id="cb46-13"><a href="ch-calculus.html#cb46-13"></a>plt.plot(A,SumSqRes,<span class="st">&#39;r*&#39;</span>)</span>
<span id="cb46-14"><a href="ch-calculus.html#cb46-14"></a>plt.grid()</span>
<span id="cb46-15"><a href="ch-calculus.html#cb46-15"></a>plt.xlabel(<span class="st">&#39;Value of a&#39;</span>)</span>
<span id="cb46-16"><a href="ch-calculus.html#cb46-16"></a>plt.ylabel(<span class="st">&#39;Sum of squared residuals&#39;</span>)</span>
<span id="cb46-17"><a href="ch-calculus.html#cb46-17"></a>plt.show()</span></code></pre></div>
<hr />
<p>Now let’s formalize the process that we’ve described in the previous problems.</p>

<div class="definition">
<p><span id="def:least-squares" class="definition"><strong>Definition 3.10  (Least Squares Regression)  </strong></span>Let
<span class="math display">\[S = \{ (x_1, y_1), \, (x_2, y_2), \, \ldots, \, (x_n, y_n) \}\]</span> be a
set of <span class="math inline">\(n\)</span> ordered pairs in <span class="math inline">\(\mathbb{R}^2\)</span>. If we guess that a function
<span class="math inline">\(f(x)\)</span> is a best choice to fit the data and if <span class="math inline">\(f(x)\)</span> depends on
parameters <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> then</p>
<ol style="list-style-type: lower-alpha">
<li><p>Pick initial values for the parameters <span class="math inline">\(a_1, a_2, \ldots, a_n\)</span> so that
the function <span class="math inline">\(f(x)\)</span> <em>looks like</em> it is close to the data (this is
strictly a visual step …take care that it may take some playing
around to guess the initial values of the parameters)</p></li>
<li><p>Calculate the square error between the data point and the prediction
from the function <span class="math inline">\(f(x)\)</span>
<span class="math display">\[\text{error for the point $x_i$: } e_i = \left( y_i - f(x_i) \right)^2.\]</span>
Note that squaring the error has the advantages of removing the
sign, accentuating errors larger than 1, and decreasing errors that
are less than 1.</p></li>
<li><p>As a measure of the total error between the function and the data,
sum the squared errors
<span class="math display">\[\text{sum of square errors } = \sum_{i=1}^n \left( y_i - f(x_i) \right)^2.\]</span>
(Take note that if there were a continuum of points instead of a
discrete set then we would integrate the square errors instead of
taking a sum.)</p></li>
<li><p>Change the parameters <span class="math inline">\(a_1, a_2, \ldots\)</span> so as to minimize the sum
of the square errors.</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-242" class="exercise"><strong>Exercise 3.84  </strong></span>In <a href="ch-calculus.html#def:least-squares">3.10</a> the last step is a bit vague. That was purposeful since there are many techniques that could be used to minimize the sum of the square errors. However, if we just think about the sum of the squared residuals as a function then we can apply <code>scipy.optimize.minimize()</code> to that function in order to return the values of the parameters that best minimize the sum of the squared residuals. The following blocks of Python code implement the idea in a very streamlined way. Go through the code and comment each line to describe exactly what it does.
</div>
<div class="sourceCode" id="cb47"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb47-1"><a href="ch-calculus.html#cb47-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb47-2"><a href="ch-calculus.html#cb47-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb47-3"><a href="ch-calculus.html#cb47-3"></a><span class="im">from</span> scipy.optimize <span class="im">import</span> minimize </span>
<span id="cb47-4"><a href="ch-calculus.html#cb47-4"></a>xdata <span class="op">=</span> np.array([<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>])</span>
<span id="cb47-5"><a href="ch-calculus.html#cb47-5"></a>ydata <span class="op">=</span> np.array([<span class="fl">1.07</span>, <span class="fl">3.9</span>, <span class="fl">14.8</span>, <span class="fl">26.8</span>])</span>
<span id="cb47-6"><a href="ch-calculus.html#cb47-6"></a></span>
<span id="cb47-7"><a href="ch-calculus.html#cb47-7"></a><span class="kw">def</span> SSRes(parameters):</span>
<span id="cb47-8"><a href="ch-calculus.html#cb47-8"></a>  <span class="co"># In the next line of code we want to build our </span></span>
<span id="cb47-9"><a href="ch-calculus.html#cb47-9"></a>  <span class="co"># quadratic approximation y = ax^2 + bx + c</span></span>
<span id="cb47-10"><a href="ch-calculus.html#cb47-10"></a>  <span class="co"># We are sending in a list of parameters so </span></span>
<span id="cb47-11"><a href="ch-calculus.html#cb47-11"></a>  <span class="co"># a = parameters[0], b = parameters[1], and c = parameters[2]</span></span>
<span id="cb47-12"><a href="ch-calculus.html#cb47-12"></a>  yapprox <span class="op">=</span> parameters[<span class="dv">0</span>]<span class="op">*</span>xdata<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb47-13"><a href="ch-calculus.html#cb47-13"></a>            parameters[<span class="dv">1</span>]<span class="op">*</span>xdata <span class="op">+</span> <span class="op">\</span></span>
<span id="cb47-14"><a href="ch-calculus.html#cb47-14"></a>            parameters[<span class="dv">2</span>]</span>
<span id="cb47-15"><a href="ch-calculus.html#cb47-15"></a>  residuals <span class="op">=</span> np.<span class="bu">abs</span>(ydata<span class="op">-</span>yapprox)</span>
<span id="cb47-16"><a href="ch-calculus.html#cb47-16"></a>  <span class="cf">return</span> np.<span class="bu">sum</span>(residuals<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb47-17"><a href="ch-calculus.html#cb47-17"></a></span>
<span id="cb47-18"><a href="ch-calculus.html#cb47-18"></a></span>
<span id="cb47-19"><a href="ch-calculus.html#cb47-19"></a>BestParameters <span class="op">=</span> minimize(SSRes,[<span class="dv">2</span>,<span class="dv">2</span>,<span class="fl">0.75</span>])</span>
<span id="cb47-20"><a href="ch-calculus.html#cb47-20"></a><span class="bu">print</span>(<span class="st">&quot;The best values of a, b, and c are: </span><span class="ch">\n</span><span class="st">&quot;</span>,BestParameters.x)</span>
<span id="cb47-21"><a href="ch-calculus.html#cb47-21"></a><span class="co"># If you want to print the diagnositc then use the line below:</span></span>
<span id="cb47-22"><a href="ch-calculus.html#cb47-22"></a><span class="co"># print(&quot;The minimization diagnostics are: \n&quot;,BestParameters)</span></span></code></pre></div>
<pre><code>## The best values of a, b, and c are: 
##  [2.29249989 1.93150033 0.72149989]</code></pre>
<div class="sourceCode" id="cb49"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb49-1"><a href="ch-calculus.html#cb49-1"></a>plt.plot(xdata,ydata,<span class="st">&#39;bo&#39;</span>,markersize<span class="op">=</span><span class="dv">5</span>)</span>
<span id="cb49-2"><a href="ch-calculus.html#cb49-2"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">4</span>,<span class="dv">100</span>)</span>
<span id="cb49-3"><a href="ch-calculus.html#cb49-3"></a>y <span class="op">=</span> BestParameters.x[<span class="dv">0</span>]<span class="op">*</span>x<span class="op">**</span><span class="dv">2</span> <span class="op">+</span> <span class="op">\</span></span>
<span id="cb49-4"><a href="ch-calculus.html#cb49-4"></a>    BestParameters.x[<span class="dv">1</span>]<span class="op">*</span>x <span class="op">+</span> <span class="op">\</span></span>
<span id="cb49-5"><a href="ch-calculus.html#cb49-5"></a>    BestParameters.x[<span class="dv">2</span>]</span>
<span id="cb49-6"><a href="ch-calculus.html#cb49-6"></a>plt.plot(x,y,<span class="st">&#39;r--&#39;</span>)</span>
<span id="cb49-7"><a href="ch-calculus.html#cb49-7"></a>plt.grid()</span>
<span id="cb49-8"><a href="ch-calculus.html#cb49-8"></a>plt.xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb49-9"><a href="ch-calculus.html#cb49-9"></a>plt.ylabel(<span class="st">&#39;y&#39;</span>)</span>
<span id="cb49-10"><a href="ch-calculus.html#cb49-10"></a>plt.title(<span class="st">&#39;Best Fit Quadratic&#39;</span>)</span>
<span id="cb49-11"><a href="ch-calculus.html#cb49-11"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span id="fig:unnamed-chunk-245"></span>
<img src="images/Ch03_BestQuadratic.png" alt="Best fit quadratic function." width="75%" />
<p class="caption">
Figure 3.12: Best fit quadratic function.
</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-246" class="exercise"><strong>Exercise 3.85  </strong></span>With a partner choose a function and then choose 10 points on that function. Add a small bit of error into the <span class="math inline">\(y\)</span>-values of your points. Give your 10 points to another group. Upon receiving your new points:</p>
<ul>
<li>Plot your points.</li>
<li>Make a guess about the basic form of the function that might best fit the data. Your general form will likely have several parameters (just like the quadratic had the parameters <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(c\)</span>).<br />
</li>
<li>Modify the code from above to find the best collection of parameters minimize the sum of the squares of the residuals between your function and the data.<br />
</li>
<li>Plot the data along with your best fit function. If you are not satisfied with how it fit then make another guess on the type of function and repeat the process.</li>
<li>Finally, go back to the group who gave you your points and check your work.</li>
</ul>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-247" class="exercise"><strong>Exercise 3.86  </strong></span>For each dataset associated with this exercise give a functional form that might be a good model for the data. Be sure to choose the most general form of your guess. For example, if you choose “quadratic” then your functional guess is <span class="math inline">\(f(x) = ax^2 + bx + c\)</span>, if you choose “quadratic” then your functional guess should be something like <span class="math inline">\(f(x) = ae^{b(x-c)}+d\)</span>, or if you choose “sinusoidal” then your guess should be something like <span class="math inline">\(f(x) = a\sin(bx) + c\cos(dx) + e\)</span>. Once you have a guess of the function type create a plot showing your data along with your guess for a reasonable set of parameters. Then write a function that leverages <code>scipy.optimize.minimize()</code> to find the best set of parameters so that your function best fits the data. Note that if <code>scipy.optimize.minimize()</code> does not converge then try the alternative <code>scipy</code> function <code>scipy.optimize.fmin()</code>. Also note that you likely need to be very close to the optimal parameters to get the optimizer to work properly.</p>
You can load the data with the following script.
</div>
<div class="sourceCode" id="cb50"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb50-1"><a href="ch-calculus.html#cb50-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb50-2"><a href="ch-calculus.html#cb50-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb50-3"><a href="ch-calculus.html#cb50-3"></a>URL1 <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb50-4"><a href="ch-calculus.html#cb50-4"></a>URL2 <span class="op">=</span> <span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb50-5"><a href="ch-calculus.html#cb50-5"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb50-6"><a href="ch-calculus.html#cb50-6"></a>datasetA <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit2.csv&#39;</span>) )</span>
<span id="cb50-7"><a href="ch-calculus.html#cb50-7"></a>datasetB <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit3.csv&#39;</span>) )</span>
<span id="cb50-8"><a href="ch-calculus.html#cb50-8"></a>datasetC <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit4.csv&#39;</span>) )</span>
<span id="cb50-9"><a href="ch-calculus.html#cb50-9"></a><span class="co"># Exercise3_datafit1.csv, </span></span>
<span id="cb50-10"><a href="ch-calculus.html#cb50-10"></a><span class="co"># Exercise3_datafit2.csv, </span></span>
<span id="cb50-11"><a href="ch-calculus.html#cb50-11"></a><span class="co"># Exercise3_datafit3.csv</span></span></code></pre></div>
<p>As a nudge in the right direction, in the left-hand pane of Figure <a href="ch-calculus.html#fig:datamatching3">3.13</a> the function appears to be exponential. Hence we should choose a function of the form <span class="math inline">\(f(x) = ae^{b(x-c)}+d\)</span>. Moreover, we need to pick good approximations of the parameters to start the optimization process. In the left-hand pane of Figure <a href="ch-calculus.html#fig:datamatching3">3.13</a> the data appears to start near <span class="math inline">\(x=1970\)</span> so our initial guess for <span class="math inline">\(c\)</span> might be <span class="math inline">\(c \approx 1970\)</span>. To get initial guesses for <span class="math inline">\(a\)</span>, <span class="math inline">\(b\)</span>, and <span class="math inline">\(d\)</span> we can observe that the expected best fit curve will approximately go through the points <span class="math inline">\((1970,15000)\)</span>, <span class="math inline">\((1990,40000)\)</span>, and <span class="math inline">\((2000,75000)\)</span>. With this information we get the equations <span class="math inline">\(a+d \approx 15000\)</span>, <span class="math inline">\(ae^{20b}+d \approx 40000\)</span> and <span class="math inline">\(ae^{30b}+d \approx 75000\)</span> and work to get reasonable approximations for <span class="math inline">\(a,b,\)</span> and <span class="math inline">\(d\)</span> to feed into the <code>scipy.optimize.minimize()</code> command.</p>
<div class="figure" style="text-align: center"><span id="fig:datamatching3"></span>
<img src="images/Ch03_datamatching.png" alt="Raw data for least squares function matching problems." width="95%" />
<p class="caption">
Figure 3.13: Raw data for least squares function matching problems.
</p>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="exercises-2" class="section level2" number="3.7">
<h2><span class="header-section-number">3.7</span> Exercises</h2>
<div id="algorithm-summaries-1" class="section level3" number="3.7.1">
<h3><span class="header-section-number">3.7.1</span> Algorithm Summaries</h3>

<div class="exercise">
<span id="exr:unnamed-chunk-249" class="exercise"><strong>Exercise 3.87  </strong></span>Starting from Taylor series prove that
<span class="math display">\[f&#39;(x) \approx \frac{f(x+h) - f(x)}{h}\]</span> is a first-order approximation
of the first derivative of <span class="math inline">\(f(x)\)</span>. Clearly describe what “first-order
approximation” means in this context.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-250" class="exercise"><strong>Exercise 3.88  </strong></span>Starting from Taylor series prove that
<span class="math display">\[f&#39;(x) \approx \frac{f(x+h) - f(x-h)}{2h}\]</span> is a second-order
approximation of the first derivative of <span class="math inline">\(f(x)\)</span>. Clearly describe what
“second-order approximation” means in this context.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-251" class="exercise"><strong>Exercise 3.89  </strong></span>Starting from Taylor series prove that
<span class="math display">\[f&#39;&#39;(x) \approx \frac{f(x+h) - 2f(x) + f(x-h)}{h^2}\]</span> is a second-order
approximation of the second derivative of <span class="math inline">\(f(x)\)</span>. Clearly describe what
“second-order approximation” means in this context.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-252" class="exercise"><strong>Exercise 3.90  </strong></span>Explain how to approximate the value of a definite integral with Riemann
sums. When will the Riemann sum approximation be exact? The Riemann sum
approximation is first order. Expain what “first order” means for
calculating a definite integral.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-253" class="exercise"><strong>Exercise 3.91  </strong></span>Explain how to approximate the value of a definite integral with the
Trapezoid rule. When will the Trapezoid rule approximation be exact? The
Trapezoidal rule approximation is second order. Expain what “second
order” means for calculating a definite integral.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-254" class="exercise"><strong>Exercise 3.92  </strong></span>Explain how to approximate the value of a definite integral with
Simpson’s rule. Give the full mathematical details for where Simpson’s
rule comes from. When will the Simpson’s rule approximation be exact?
The Simpson’s rule approximation is fourth order. Expain what “fourth
order” means for calculating a definite integral.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-255" class="exercise"><strong>Exercise 3.93  </strong></span>Explain in clear language how the derivative free optimization method
works on a single-variable function.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-256" class="exercise"><strong>Exercise 3.94  </strong></span>Explain in clear language how the gradient descent/ascent optimization
method works on a single-variable function.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-257" class="exercise"><strong>Exercise 3.95  </strong></span>Explain in clear language how the Monte Carlo search optimization method
works on a single-variable function.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-258" class="exercise"><strong>Exercise 3.96  </strong></span>Explain in clear language how you find the optimal set of parameters
given a set of data and a proposed general function type.
</div>
<hr />
</div>
<div id="applying-what-youve-learned-2" class="section level3" number="3.7.2">
<h3><span class="header-section-number">3.7.2</span> Applying What You’ve Learned</h3>

<div class="exercise">
<p><span id="exr:unnamed-chunk-259" class="exercise"><strong>Exercise 3.97  </strong></span>For each of the following numerical differentiation formulas (1) prove
that the formula is true and (2) find the order of the method. To prove
that each of the formulas is true you will need to write the Taylor
series for all of the terms in the numerator on the right and then
simplify to solve for the necessary derivative. The highest power of the
remainder should reveal the order of the method.</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(f&#39;(x) \approx \frac{\frac{1}{12} f(x-2h) - \frac{2}{3} f(x-h) +  \frac{2}{3} f(x+h) - \frac{1}{12} f(x+2h)}{h}\)</span></p></li>
<li><p><span class="math inline">\(f&#39;(x) \approx \frac{-\frac{3}{2} f(x) + 2 f(x+h) -  \frac{1}{2} f(x+2h)}{h}\)</span></p></li>
<li><p><span class="math inline">\(f&#39;&#39;(x) \approx \frac{-\frac{1}{12} f(x-2h) + \frac{4}{3} f(x-h) -  \frac{5}{2} f(x) + \frac{4}{3} f(x+h) - \frac{1}{12} f(x+2h)}{h^2}\)</span></p></li>
<li><p><span class="math inline">\(f&#39;&#39;&#39;(x) \approx \frac{-\frac{1}{2} f(x-2h) + f(x-h) - f(x+h) +  \frac{1}{2} f(x+2h)}{h^3}\)</span></p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-260" class="exercise"><strong>Exercise 3.98  </strong></span>Write a function that accepts a list of
<span class="math inline">\((x,y)\)</span> ordered pairs from a spreadsheet and returns a list of
<span class="math inline">\((x,y)\)</span> ordered pairs for a first order approximation of the first
derivative of the underlying function. Create a test spreadsheet file and a
test script that have graphical output showing that your function is
finding the correct derivative.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-261" class="exercise"><strong>Exercise 3.99  </strong></span>Write a function that accepts a list of <span class="math inline">\((x,y)\)</span> ordered pairs from a spreadsheet or a <code>*.csv</code> file and returns a list of <span class="math inline">\((x,y)\)</span> ordered pairs for a
second order approximation of the second derivative of the underlying
function. Create a test spreadsheet file and a test script that have graphical
output showing that your function is finding the correct derivative.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-262" class="exercise"><strong>Exercise 3.100  </strong></span>Write a function that implements the
trapezoidal rule on a list of <span class="math inline">\((x,y)\)</span> order pairs representing the
integrand function. The list of ordered pairs should be read from a spreadsheet file. Create a test spreadsheet file and a test script showing that your
function is finding the correct integral.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-263" class="exercise"><strong>Exercise 3.101  </strong></span>Use numerical integration to answer the question in each of the following scenarios</p>
<ol style="list-style-type: lower-alpha">
<li>We measure the rate at which water is flowing out of a reservoir (in
gallons per second) several times over the course of one hour.
Estimate the total amount of water which left the reservoir during
that hour.</li>
</ol>
<table>
<thead>
<tr class="header">
<th>time (min)</th>
<th>0</th>
<th>7</th>
<th>19</th>
<th>25</th>
<th>38</th>
<th>47</th>
<th>55</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>flow rate (gal/sec)</td>
<td>316</td>
<td>309</td>
<td>296</td>
<td>298</td>
<td>305</td>
<td>314</td>
<td>322</td>
</tr>
</tbody>
</table>
You can download the data directly from the textbook’s github page with the code below.
</div>
<div class="sourceCode" id="cb51"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb51-1"><a href="ch-calculus.html#cb51-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb51-2"><a href="ch-calculus.html#cb51-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb51-3"><a href="ch-calculus.html#cb51-3"></a>URL1 <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb51-4"><a href="ch-calculus.html#cb51-4"></a>URL2 <span class="op">=</span> <span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb51-5"><a href="ch-calculus.html#cb51-5"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb51-6"><a href="ch-calculus.html#cb51-6"></a>data <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_waterflow.csv&#39;</span>) )</span>
<span id="cb51-7"><a href="ch-calculus.html#cb51-7"></a><span class="co"># Exercise3_waterflow.csv</span></span></code></pre></div>
<ol start="2" style="list-style-type: lower-alpha">
<li>The department of transportation finds that the rate at which cars
cross a bridge can be approximated by the function
<span class="math display">\[f(t) = \frac{22.8 }{3.5 + 7(t-1.25)^4} ,\]</span> where <span class="math inline">\(t=0\)</span> at 4pm, and
is measured in hours, and <span class="math inline">\(f(t)\)</span> is measured in cars per minute.
Estimate the total number of cars that cross the bridge between 4
and 6pm. Make sure that your estimate has an error less than 5% and
provide sufficient mathematical evidence of your error estimate.</li>
</ol>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-265" class="exercise"><strong>Exercise 3.102  </strong></span>Consider the integrals
<span class="math display">\[\int_{-2}^2 e^{-x^2/2} dx \quad \text{and} \quad \int_0^1 \cos(x^2) dx.\]</span>
Neither of these integrals have closed-form solutions so a numerical method is necessary. Create a loglog plot that shows the errors for the integrals with different values of <span class="math inline">\(h\)</span> (log of <span class="math inline">\(h\)</span> on the <span class="math inline">\(x\)</span>-axis and log of the absolute error on the <span class="math inline">\(y\)</span>-axis). Write a complete interpretation of the loglog plot. To get the <em>exact</em> answer for these plots use Python’s <code>scipy.integrate.quad</code> command. (What we’re really doing here is comparing our algorithms to Python’s <code>scipy.integrate.quad()</code> algorithm).
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-266" class="exercise"><strong>Exercise 3.103  </strong></span>Go to <a href="https://www.data.gov/">data.gov</a> or the <a href="http://apps.who.int/gho/data/?theme=home">World Health
Organization Data Repository</a>
and find data sets for the following tasks.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Find a data set where the variables naturally lead to a meaningful
derivative. Use appropriate code to evaluate and plot the
derivative. If your data appears to be subject to significant noise
then you may want to smooth the data first before doing the derivative. Write a few sentences explaning what the
derivative means in the context of the data.</p></li>
<li><p>Find a data set where the variables naturally lead to a meaningfun
definite integral. Use appropriate code to evaluate the definite integral.
If your data appears to be subject to significant noise then you might want to smooth the data first before doing the
integral. Write a few sentences explaning what the integral means in
the context of the data.</p></li>
</ol>
<p>In both of these tasks be very cautious of the units on the data sets
and the units of your answer.</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-267" class="exercise"><strong>Exercise 3.104  </strong></span>Numerically integrate each of the functions over the interval <span class="math inline">\([-1,2]\)</span> with an appropriate technique and verify mathematically that your numerical integral is correct to 10 decimal places. Then provide a plot of the function along with its numerical first derivative.</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(f(x) = \frac{x}{1+x^4}\)</span></p></li>
<li><p><span class="math inline">\(g(x) = (x-1)^3 (x-2)^2\)</span></p></li>
<li><p><span class="math inline">\(h(x) = \sin\left(x^2\right)\)</span></p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-268" class="exercise"><strong>Exercise 3.105  </strong></span>A bicyclist completes a race course in 90 seconds. The speed of the
biker at each 10-second interval is determined using a radar gun and is
given in the table in feet per second. How long is the race course?</p>
<table>
<thead>
<tr class="header">
<th>Time (sec)</th>
<th>0</th>
<th>10</th>
<th>20</th>
<th>30</th>
<th>40</th>
<th>50</th>
<th>60</th>
<th>70</th>
<th>80</th>
<th>90</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Speed (ft/sec)</td>
<td>34</td>
<td>32</td>
<td>29</td>
<td>33</td>
<td>37</td>
<td>40</td>
<td>41</td>
<td>36</td>
<td>38</td>
<td>39</td>
</tr>
</tbody>
</table>
You can download the data with the following code.
</div>
<div class="sourceCode" id="cb52"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb52-1"><a href="ch-calculus.html#cb52-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb52-2"><a href="ch-calculus.html#cb52-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb52-3"><a href="ch-calculus.html#cb52-3"></a>URL1 <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb52-4"><a href="ch-calculus.html#cb52-4"></a>URL2 <span class="op">=</span> <span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb52-5"><a href="ch-calculus.html#cb52-5"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb52-6"><a href="ch-calculus.html#cb52-6"></a>data <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_bikespeed.csv&#39;</span>) )</span>
<span id="cb52-7"><a href="ch-calculus.html#cb52-7"></a><span class="co"># Exercise3_bikespeed.csv</span></span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-270" class="exercise"><strong>Exercise 3.106  </strong></span>For each of the following functions write code to numerically approximate the local maximum or minimum that is closest to <span class="math inline">\(x=0\)</span>. You may want to start with a plot of the function just to get a feel for where the local extreme value(s) might be.</p>
<ol style="list-style-type: lower-alpha">
<li><p><span class="math inline">\(\displaystyle f(x) = \frac{x}{1+x^4} + \sin(x)\)</span></p></li>
<li><p><span class="math inline">\(\displaystyle g(x) =  \left(x-1\right)^3\cdot\left(x-2\right)^2+e^{-0.5\cdot x}\)</span></p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-271" class="exercise"><strong>Exercise 3.107  </strong></span>Go back to your old Calculus textbook or homework and find your favorite
optimization problem. State the problem, create the mathematical model,
and use any of the numerical optimization techniques in this chapter to
get an approximate solution to the problem.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-272" class="exercise"><strong>Exercise 3.108  </strong></span>In the code below you can download several sets of noisy data from measurements of elementary single variable functions.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Make a hypothesis about which type of function would best model the data. Be sure to choose the most general (parameterized) form of your function.</p></li>
<li><p>Use appropriate tools to find the parameters for the function that best fits the data. Report you sum of square residuals for each function.</p></li>
</ol>
<p>The functions that you propose must be continuous functions.</p>
</div>
<div class="sourceCode" id="cb53"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb53-1"><a href="ch-calculus.html#cb53-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb53-2"><a href="ch-calculus.html#cb53-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb53-3"><a href="ch-calculus.html#cb53-3"></a>URL1 <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb53-4"><a href="ch-calculus.html#cb53-4"></a>URL2 <span class="op">=</span> <span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb53-5"><a href="ch-calculus.html#cb53-5"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb53-6"><a href="ch-calculus.html#cb53-6"></a>datasetA <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit5.csv&#39;</span>) )</span>
<span id="cb53-7"><a href="ch-calculus.html#cb53-7"></a>datasetB <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit6.csv&#39;</span>) )</span>
<span id="cb53-8"><a href="ch-calculus.html#cb53-8"></a>datasetC <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit7.csv&#39;</span>) )</span>
<span id="cb53-9"><a href="ch-calculus.html#cb53-9"></a>datasetD <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit8.csv&#39;</span>) )</span>
<span id="cb53-10"><a href="ch-calculus.html#cb53-10"></a>datasetE <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit9.csv&#39;</span>) )</span>
<span id="cb53-11"><a href="ch-calculus.html#cb53-11"></a>datasetF <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit10.csv&#39;</span>) )</span>
<span id="cb53-12"><a href="ch-calculus.html#cb53-12"></a>datasetG <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit11.csv&#39;</span>) )</span>
<span id="cb53-13"><a href="ch-calculus.html#cb53-13"></a>datasetH <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise3_datafit12.csv&#39;</span>) )</span>
<span id="cb53-14"><a href="ch-calculus.html#cb53-14"></a><span class="co"># Exercise3_datafit5.csv - Exercise3_datafit12.csv</span></span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-274" class="exercise"><strong>Exercise 3.109  (The Goat Problem)  </strong></span>This is a classic problem in recreational mathematics that has a great approximate solution where we can leverage some of our numerical analysis skills. Grab a pencil and a piece of paper so we can draw a picture.</p>
<ul>
<li>Draw a coordinate plane</li>
<li>Draw a circle with radius 1 unit centered at the point <span class="math inline">\((0,1)\)</span>. This circle will obviously be tangent to the <span class="math inline">\(x\)</span> axis.</li>
<li>Draw a circle with radius <span class="math inline">\(r\)</span> centered at the point <span class="math inline">\((0,0)\)</span>. We will take <span class="math inline">\(0 &lt; r &lt; 2\)</span> so there are two intersections of the two circles.
<ul>
<li>Label the left-hand intersection of the two circles as point <span class="math inline">\(A\)</span>. (Point <span class="math inline">\(A\)</span> should be in the second quadrant of your coordinate plane.)</li>
<li>Label the right-hand intersection of the circles as point <span class="math inline">\(B\)</span>. (Point <span class="math inline">\(B\)</span> shoudl be in the first quadrant of your coordinate plan.)</li>
</ul></li>
<li>Label the point <span class="math inline">\((0,0)\)</span> as the point <span class="math inline">\(P\)</span>.</li>
</ul>
<p>A rancher has built a circular fence of radius 1 unit centered at the point <span class="math inline">\((0,1)\)</span> for his goat to graze. He tethers his goat at point <span class="math inline">\(P\)</span> on the far south end of the circular fence. He wants to make the length of the goat’s chain, <span class="math inline">\(r\)</span>, just long enough so that it can graze half of the area of the fenced region. How long should he make the chain?</p>
<p>Hints:</p>
<ul>
<li><p>It would be helpful to write equations for both circles. Then you can use the equations to find the coordinates of the intersection points <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span>.</p>
<ul>
<li>You can either solve for the intersection points algebraically or you can use a numerical root finding technique to find the intersection points.</li>
<li>In any case, the intersection points will (obviously) depend on the value of <span class="math inline">\(r\)</span></li>
</ul></li>
<li><p>Set up an integral to find the area grazed by the goat.</p>
<ul>
<li>You will likely need to use a numerical integration technique to evaluate the integral.</li>
</ul></li>
<li><p>Write code to narrow down on the best value of <span class="math inline">\(r\)</span> where the integral evaluates to half the area of the fenced region.</p>
</div></li>
</ul>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="projects-1" class="section level2" number="3.8">
<h2><span class="header-section-number">3.8</span> Projects</h2>
<p>In this section we propose several ideas for projects related to
numerical Calculus. These projects are meant to be open ended, to
encourage creative mathematics, to push your coding skills, and to
require you to write and communicate your mathematics. Take the time to
read Appendix <a href="ch-writing.html#ch:writing">B</a> before you write your final solution.</p>
<div id="galaxy-integration" class="section level3" number="3.8.1">
<h3><span class="header-section-number">3.8.1</span> Galaxy Integration</h3>
<p>To analyze the light from stars and galaxies, scientists use a spectral
grating (fancy prism) to split it up into the different frequencies
(colors). We can then measure the intensity (brightness) of the light
(in units of Watts per square meter) at each frequency (measured in
Hertz), to get intensity per frequency (Watts per square meter per
Hertz, W/(m<span class="math inline">\(^2\)</span> Hz)). Light from the dense opaque surface of a star
produces a smooth rainbow, which produces a continuous curve when we
plot intensity versus frequency. However stars are also surrounded by
thin gas which either emits or absorbs light at only a specific set of
frequencies, called spectral lines. Every chemical element produces a
specific set of lines (or peaks) at fixed frequencies, so by identifying
the lines, we can tell what types of atoms and molecules a star is made
of. If the gas is cool, then it will absorb light at these wavelengths,
and if the gas is hot then it will emit light at these wavelengths. For
galaxies, on the other hand, we expect mostly emission spectra: light
emitted from the galaxy.</p>
<p>For this project we will be analyzing the galaxy “ngc 1275”. The black
hole at the center of this galaxy is often referred to as the “Galactic
Spaghetti Monster” since the magnetic field “sustains a mammoth network
of spaghetti-like gas filaments around it”. You can download the data file
associated with this project with the following Python code.</p>
<div class="sourceCode" id="cb54"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb54-1"><a href="ch-calculus.html#cb54-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb54-2"><a href="ch-calculus.html#cb54-2"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb54-3"><a href="ch-calculus.html#cb54-3"></a>URL1<span class="op">=</span><span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb54-4"><a href="ch-calculus.html#cb54-4"></a>URL2<span class="op">=</span><span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb54-5"><a href="ch-calculus.html#cb54-5"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb54-6"><a href="ch-calculus.html#cb54-6"></a>ngc1275 <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;ngc1275.csv&#39;</span>) )</span>
<span id="cb54-7"><a href="ch-calculus.html#cb54-7"></a><span class="co"># ngc1275.csv</span></span></code></pre></div>
<p>In the data you will see the spectral data measuring
the light intensity from ncg 1275 at several different wavelengths
(measured in Angstroms ). You will notice in this data set that there
are several emission lines at various wavelengths. Of particular
interest are the peaks near <span class="math inline">\(3800\)</span> Angstroms, <span class="math inline">\(5100\)</span> Angstroms, <span class="math inline">\(6400\)</span>
Angstroms, and the two peaks around <span class="math inline">\(6700\)</span> Angstroms. The data set
contains 1,727 data points at different wavelengths. Your first job will
be to transform the wavelength data to frequency via the formula
<span class="math display">\[\lambda = \frac{c}{f}\]</span> where <span class="math inline">\(\lambda\)</span> is the wavelength, <span class="math inline">\(c\)</span> is the
speed of light, and <span class="math inline">\(f\)</span> is the frequency (measured in Hertz). Be sure to
double check the units. Given the inverse relationship between frequency
and wavelength you should see the emission lines flip to the other side
of the plot (right-to-left or left-to-right).</p>
<p>The strength of each emission line (in W/m<span class="math inline">\(^2\)</span>) is defined as the
relative intensity of each peak across the associated frequencies. Note
that you are not interested in the intensity of the continuous spectrum
– just the peaks. That is to say that you are only interested in the
area above the background curve and the background noise.</p>
<p>Your primary task is to develop a process for analyzing data sets like
this so as to determine the strength of each emission lines. You must
demonstrate your process on this particular data set, but your process
must be generalizable to any similar data set. Your process must clearly
determine the strength of peaks in data sets like this and you must
apply your procedure to determine the strength of each of these four
lines with an associated margin of error. Keep in mind that you will
first want to first develop a method for removing the background noise.
Finally, the double peak near <span class="math inline">\(6700\)</span> Angstroms needs to be handled with
care: the strength of each emission line is only the integral over one
peak, not two, so you’ll need to determine a way to separate these
peaks.</p>
<p>Finally, it would be cool, but is not necessary, to report on which
chemicals correspond to the emission lines in the data. Remember that
the galaxy is far away and hence there is a non-trivial red-shift to
consider. This will take some research but if done properly will likely
give a lot more merit to your paper.</p>
</div>
<div id="higher-order-integration" class="section level3" number="3.8.2">
<h3><span class="header-section-number">3.8.2</span> Higher Order Integration</h3>
<p>Riemann sums can be used to approximate integrals and they do so by
using piece wise constant functions to approximate the function. The
trapezoidal rule uses piece wise linear functions to approximate the
function and then the area of a trapezoid to approximate the area. We
saw earlier that Simpson’s rule uses piece wise parabolas to approximate
the function. The process which we used to build Simpson’s rule can be
extended to any higher-order polynomial. Your job in this project is to
build integration algorithms that use piece wise cubic functions, quartic
functions, etc. For each you need to show all of the mathematics
necessary to derive the algorithm, provide several test cases to show
that the algorithm works, and produce a numerical experiment that shows
the order of accuracy of the algorithm.</p>
</div>
<div id="dam-integration" class="section level3" number="3.8.3">
<h3><span class="header-section-number">3.8.3</span> Dam Integration</h3>
<p>Go to the USGS water data repository:<br />
<a href="https://maps.waterdata.usgs.gov/mapper/index.html" class="uri">https://maps.waterdata.usgs.gov/mapper/index.html</a>.<br />
Here you’ll find a map with information about water resources around the
country.</p>
<ul>
<li><p>Zoom in to a dam of your choice (make sure that it is a dam).</p></li>
<li><p>Click on the map tag then click “Access Data”</p></li>
<li><p>From the drop down menu at the top select either “Daily Data” or
“Current / Historical Data”. If these options don’t appear then
choose a different dam.</p></li>
<li><p>Change the dates so you have the past year’s worth of information.</p></li>
<li><p>Select “Tab-separated” under “Output format” and press Go. Be sure
that the data you got has a flow rate (ft<span class="math inline">\(^3\)</span>/sec).</p></li>
<li><p>At this point you should have access to the entire data set. Copy it
into a <code>csv</code> file and save it to your computer.</p></li>
</ul>
<p>For the data that you just downloaded you have three tasks: (1) plot the
data in a reasonable way giving appropriate units, (2) find the total
amount of water that has been discharged from the dam during the past
calendar year, and (3) report any margin of error in your calculation
based on the numerical method that you used in part (2).</p>
</div>
<div id="edge-detection-in-images" class="section level3" number="3.8.4">
<h3><span class="header-section-number">3.8.4</span> Edge Detection in Images</h3>
<p>Edge detection is the process of finding the boundaries or edges of objects in an image. There are many approaches to performing edge detection, but one method that is quite robust is to use the gradient vector in the following way:</p>
<ul>
<li>First convert the image to gray scale.</li>
<li>Then think of the gray scale image as a plot of a multivariable function <span class="math inline">\(G(x,y)\)</span> where the ordered pair <span class="math inline">\((x,y)\)</span> is the pixel location and the output <span class="math inline">\(G(x,y)\)</span> is the value of the gray scale at that point.</li>
<li>At each pixel calculate the gradient of the function <span class="math inline">\(G(x,y)\)</span> numerically.</li>
<li>If the magnitude of the gradient is larger than some threshold then the function <span class="math inline">\(G(x,y)\)</span> is steep at that location and it is possible that there is an edge (a transition from one part of the image to a different part) at that point. Hence, if <span class="math inline">\(\|\nabla G(x,y)\| &gt; \delta\)</span> for some threshold <span class="math inline">\(\delta\)</span> then we can mark the point <span class="math inline">\((x,y)\)</span> as an edge point.</li>
</ul>
<p><strong>Your Tasks:</strong></p>
<ol style="list-style-type: decimal">
<li>Choose several images on which to do edge detection. You should take your own images, but if you choose not to be sure that you cite the source(s) of your images.</li>
<li>Write Python code that performs edge detection as described above on the image. In the end you should produce side-by-side plots of the original picture and the image showing only the edges. To calculate the gradient use a centered difference scheme for the first derivatives
<span class="math display">\[ f&#39;(x) \approx \frac{f(x+h)-f(x-h)}{2h}. \]</span>
In an image we can take <span class="math inline">\(h=1\)</span> (why?), and since the gradient is two dimensional we get
<span class="math display">\[ \nabla G(x,y) \approx \left&lt; \frac{G(x+1,y)-G(x-1,y)}{2} \, , \, \frac{G(x,y+1)-G(x,y-1)}{2}  \right&gt;. \]</span>
Figure <a href="ch-calculus.html#fig:gray-gradient">3.14</a> depicts what this looks like when we zoom in to a pixel and its immediate neighbors. The pixel labeled <code>G[i,j]</code> is the pixel at which we want to evaluate the gradient, and the surrounding pixels are labeled by their indices relative to <code>[i,j]</code>.</li>
</ol>
<div class="figure" style="text-align: center"><span id="fig:gray-gradient"></span>
<img src="images/GrayGradient.png" alt="The gradient computation on a single pixel using a centered difference scheme for the first derivative." width="90%" />
<p class="caption">
Figure 3.14: The gradient computation on a single pixel using a centered difference scheme for the first derivative.
</p>
</div>
<ol start="3" style="list-style-type: decimal">
<li>There are many ways to approximate numerical first derivatives. The simplest approach is what you did in part (2) – using a centered difference scheme. However, pixels are necessarily tightly packed in an image and the immediate neighbors of a point may not have enough contrast to truly detect edges. If you examine Figure <a href="ch-calculus.html#fig:gray-gradient">3.14</a> you’ll notice that we only use 4 of the 8 neighbors of the pixel <code>[i,j]</code>. Also notice that we didn’t reach out any further than a single pixel. Your job now is to build several other approaches to calculating the gradient vector, implement them to perform edge detection, and show the resulting images. For each method you need to give the full mathematical details for how you calculated the gradient as well as give a list of pros and cons for using the new numerical gradient for edge detection based on what you see in your images. As an example, you could use a centered difference scheme that looks two pixels away instead of at the immediate neighboring pixels
<span class="math display">\[ f&#39;(x) \approx \frac{??? f(x-2) + ??? f(x+2)}{???}. \]</span>
Of course you would need to determine the coefficients in this approximation scheme.<br />
Another idea could use a centered difference scheme that uses pixels that are immediate neighbors AND pixels that are two units away
<span class="math display">\[ f&#39;(x) \approx \frac{??? f(x-2) + ??? f(x-1) + ??? f(x+1) + ??? f(x+2)}{???}. \]</span><br />
In any case, you will need to use Taylor Series to derive coefficients in the formulas for the derivatives as well as the order of the error. There are many ways to approximate the first derivatives so be creative. In your exploration you are not restricted to using just the first derivative. There could be some argument for using the second derivatives and/or the Hessian matrix of the gray scale image function <span class="math inline">\(G(x,y)\)</span> and using some function of the concavity as a means of edge detection. Explore and have fun!</li>
</ol>
<p>The following code will allow you to read an image into Python as an <code>np.array()</code>.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb55-1"><a href="ch-calculus.html#cb55-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb55-2"><a href="ch-calculus.html#cb55-2"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb55-3"><a href="ch-calculus.html#cb55-3"></a><span class="im">from</span> matplotlib <span class="im">import</span> image</span>
<span id="cb55-4"><a href="ch-calculus.html#cb55-4"></a>I <span class="op">=</span> np.array(image.imread(<span class="st">&#39;ImageName.jpg&#39;</span>))</span>
<span id="cb55-5"><a href="ch-calculus.html#cb55-5"></a>plt.imshow(I)</span>
<span id="cb55-6"><a href="ch-calculus.html#cb55-6"></a>plt.axis(<span class="st">&quot;off&quot;</span>)</span>
<span id="cb55-7"><a href="ch-calculus.html#cb55-7"></a>plt.show()</span></code></pre></div>
<p>You should notice that the image, <code>I</code>, is a three dimensional array. The three layers are the red, green, and blue channels of the image. To flatten the image to gray scale you can apply the rule
<span class="math display">\[ \text{grayscale value} = 0.3 \text{Red} + 0.59 \text{Green} + 0.11 \text{Blue}. \]</span>
The output should be a 2 dimensional <code>numpy</code> array which you can show with the following Python code.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb56-1"><a href="ch-calculus.html#cb56-1"></a>plt.imshow(G, cmap<span class="op">=</span><span class="st">&#39;gray&#39;</span>) <span class="co"># &quot;cmap&quot; stands for &quot;color map&quot;</span></span>
<span id="cb56-2"><a href="ch-calculus.html#cb56-2"></a>plt.axis(<span class="st">&quot;off&quot;</span>)</span>
<span id="cb56-3"><a href="ch-calculus.html#cb56-3"></a>plt.show()</span></code></pre></div>
<p>Figure <a href="ch-calculus.html#fig:edgedetection">3.15</a> shows the result of different threshold values applied to the simplest numerical gradient computations. The image was taken by the author.</p>
<div class="figure" style="text-align: center"><span id="fig:edgedetection"></span>
<img src="images/Ch03_EdgeDetection.png" alt="Edge detection using different thresholds for the value of the gradient on the grayscale image" width="95%" />
<p class="caption">
Figure 3.15: Edge detection using different thresholds for the value of the gradient on the grayscale image
</p>
</div>

</div>
</div>
</div>
<h3>References</h3>
<div id="refs" class="references">
<div id="ref-meerschaert">
<p>[6] M. Meerschaert, <em>Mathematical modeling, 4ed</em>. Academic Press, 2013.</p>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-algebra.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-linearalgebra.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"toc": {
"collapse": "section"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
