<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>6 Partial Differential Equations | Numerical Methods</title>
  <meta name="description" content="Inquiry Based Numerical Methods" />
  <meta name="generator" content="bookdown 0.24.4 and GitBook 2.6.7" />

  <meta property="og:title" content="6 Partial Differential Equations | Numerical Methods" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Inquiry Based Numerical Methods" />
  

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="6 Partial Differential Equations | Numerical Methods" />
  
  <meta name="twitter:description" content="Inquiry Based Numerical Methods" />
  

<meta name="author" content="Dr. Eric Sullivan" />



  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="ch-odes.html"/>
<link rel="next" href="ch-python.html"/>
<script src="libs/header-attrs-2.11/header-attrs.js"></script>
<script src="libs/jquery-3.6.0/jquery-3.6.0.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/fuse.js@6.4.6/dist/fuse.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />








<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<style type="text/css">
/* Used with Pandoc 2.11+ new --citeproc when CSL is used */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
}
.hanging div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}
</style>

</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li class="chapter" data-level="" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i>Front Matter</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#resources"><i class="fa fa-check"></i>Resources</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#preface"><i class="fa fa-check"></i>Preface</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#creative-commons"><i class="fa fa-check"></i>Creative Commons</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#acknowledgements"><i class="fa fa-check"></i>Acknowledgements</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#to-the-student"><i class="fa fa-check"></i>To The Student</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-inquiry-based-approach"><i class="fa fa-check"></i>The Inquiry-Based Approach</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#to-the-instructor"><i class="fa fa-check"></i>To the Instructor</a>
<ul>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-inquiry-based-approach-1"><i class="fa fa-check"></i>The Inquiry-Based Approach</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#the-projects"><i class="fa fa-check"></i>The Projects</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#coding"><i class="fa fa-check"></i>Coding</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#pacing"><i class="fa fa-check"></i>Pacing</a></li>
<li class="chapter" data-level="" data-path="index.html"><a href="index.html#other-considerations"><i class="fa fa-check"></i>Other Considerations:</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="1" data-path="ch-intro.html"><a href="ch-intro.html"><i class="fa fa-check"></i><b>1</b> Preliminary Topics</a>
<ul>
<li class="chapter" data-level="1.1" data-path="ch-intro.html"><a href="ch-intro.html#what-is-numerical-analysis"><i class="fa fa-check"></i><b>1.1</b> What Is Numerical Analysis?</a></li>
<li class="chapter" data-level="1.2" data-path="ch-intro.html"><a href="ch-intro.html#arithmetic-in-base-2"><i class="fa fa-check"></i><b>1.2</b> Arithmetic in Base 2</a></li>
<li class="chapter" data-level="1.3" data-path="ch-intro.html"><a href="ch-intro.html#floating-point-arithmetic"><i class="fa fa-check"></i><b>1.3</b> Floating Point Arithmetic</a></li>
<li class="chapter" data-level="1.4" data-path="ch-intro.html"><a href="ch-intro.html#sec:Taylor"><i class="fa fa-check"></i><b>1.4</b> Approximating Functions</a></li>
<li class="chapter" data-level="1.5" data-path="ch-intro.html"><a href="ch-intro.html#approximation-error-with-taylor-series"><i class="fa fa-check"></i><b>1.5</b> Approximation Error with Taylor Series</a></li>
<li class="chapter" data-level="1.6" data-path="ch-intro.html"><a href="ch-intro.html#exercises"><i class="fa fa-check"></i><b>1.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="1.6.1" data-path="ch-intro.html"><a href="ch-intro.html#coding-exercises"><i class="fa fa-check"></i><b>1.6.1</b> Coding Exercises</a></li>
<li class="chapter" data-level="1.6.2" data-path="ch-intro.html"><a href="ch-intro.html#applying-what-youve-learned"><i class="fa fa-check"></i><b>1.6.2</b> Applying What You’ve Learned</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="2" data-path="ch-algebra.html"><a href="ch-algebra.html"><i class="fa fa-check"></i><b>2</b> Algebra</a>
<ul>
<li class="chapter" data-level="2.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intro-to-numerical-root-finding"><i class="fa fa-check"></i><b>2.1</b> Intro to Numerical Root Finding</a></li>
<li class="chapter" data-level="2.2" data-path="ch-algebra.html"><a href="ch-algebra.html#the-bisection-method"><i class="fa fa-check"></i><b>2.2</b> The Bisection Method</a>
<ul>
<li class="chapter" data-level="2.2.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation"><i class="fa fa-check"></i><b>2.2.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.2.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis"><i class="fa fa-check"></i><b>2.2.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.3" data-path="ch-algebra.html"><a href="ch-algebra.html#the-regula-falsi-method"><i class="fa fa-check"></i><b>2.3</b> The Regula Falsi Method</a>
<ul>
<li class="chapter" data-level="2.3.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-1"><i class="fa fa-check"></i><b>2.3.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.3.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-1"><i class="fa fa-check"></i><b>2.3.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.4" data-path="ch-algebra.html"><a href="ch-algebra.html#newtons-method"><i class="fa fa-check"></i><b>2.4</b> Newton’s Method</a>
<ul>
<li class="chapter" data-level="2.4.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-2"><i class="fa fa-check"></i><b>2.4.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.4.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-2"><i class="fa fa-check"></i><b>2.4.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.5" data-path="ch-algebra.html"><a href="ch-algebra.html#the-secant-method"><i class="fa fa-check"></i><b>2.5</b> The Secant Method</a>
<ul>
<li class="chapter" data-level="2.5.1" data-path="ch-algebra.html"><a href="ch-algebra.html#intuition-and-implementation-3"><i class="fa fa-check"></i><b>2.5.1</b> Intuition and Implementation</a></li>
<li class="chapter" data-level="2.5.2" data-path="ch-algebra.html"><a href="ch-algebra.html#analysis-3"><i class="fa fa-check"></i><b>2.5.2</b> Analysis</a></li>
</ul></li>
<li class="chapter" data-level="2.6" data-path="ch-algebra.html"><a href="ch-algebra.html#exercises-1"><i class="fa fa-check"></i><b>2.6</b> Exercises</a>
<ul>
<li class="chapter" data-level="2.6.1" data-path="ch-algebra.html"><a href="ch-algebra.html#algorithm-summaries"><i class="fa fa-check"></i><b>2.6.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="2.6.2" data-path="ch-algebra.html"><a href="ch-algebra.html#applying-what-youve-learned-1"><i class="fa fa-check"></i><b>2.6.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="2.7" data-path="ch-algebra.html"><a href="ch-algebra.html#projects"><i class="fa fa-check"></i><b>2.7</b> Projects</a>
<ul>
<li class="chapter" data-level="2.7.1" data-path="ch-algebra.html"><a href="ch-algebra.html#basins-of-attraction"><i class="fa fa-check"></i><b>2.7.1</b> Basins of Attraction</a></li>
<li class="chapter" data-level="2.7.2" data-path="ch-algebra.html"><a href="ch-algebra.html#artillery"><i class="fa fa-check"></i><b>2.7.2</b> Artillery</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="3" data-path="ch-calculus.html"><a href="ch-calculus.html"><i class="fa fa-check"></i><b>3</b> Calculus</a>
<ul>
<li class="chapter" data-level="3.1" data-path="ch-calculus.html"><a href="ch-calculus.html#intro-to-numerical-calculus"><i class="fa fa-check"></i><b>3.1</b> Intro to Numerical Calculus</a></li>
<li class="chapter" data-level="3.2" data-path="ch-calculus.html"><a href="ch-calculus.html#differentiation"><i class="fa fa-check"></i><b>3.2</b> Differentiation</a>
<ul>
<li class="chapter" data-level="3.2.1" data-path="ch-calculus.html"><a href="ch-calculus.html#the-first-derivative"><i class="fa fa-check"></i><b>3.2.1</b> The First Derivative</a></li>
<li class="chapter" data-level="3.2.2" data-path="ch-calculus.html"><a href="ch-calculus.html#error-analysis"><i class="fa fa-check"></i><b>3.2.2</b> Error Analysis</a></li>
<li class="chapter" data-level="3.2.3" data-path="ch-calculus.html"><a href="ch-calculus.html#efficient-coding"><i class="fa fa-check"></i><b>3.2.3</b> Efficient Coding</a></li>
<li class="chapter" data-level="3.2.4" data-path="ch-calculus.html"><a href="ch-calculus.html#a-better-first-derivative"><i class="fa fa-check"></i><b>3.2.4</b> A Better First Derivative</a></li>
<li class="chapter" data-level="3.2.5" data-path="ch-calculus.html"><a href="ch-calculus.html#the-second-derivative"><i class="fa fa-check"></i><b>3.2.5</b> The Second Derivative</a></li>
</ul></li>
<li class="chapter" data-level="3.3" data-path="ch-calculus.html"><a href="ch-calculus.html#integration"><i class="fa fa-check"></i><b>3.3</b> Integration</a>
<ul>
<li class="chapter" data-level="3.3.1" data-path="ch-calculus.html"><a href="ch-calculus.html#riemann-sums"><i class="fa fa-check"></i><b>3.3.1</b> Riemann Sums</a></li>
<li class="chapter" data-level="3.3.2" data-path="ch-calculus.html"><a href="ch-calculus.html#trapezoidal-rule"><i class="fa fa-check"></i><b>3.3.2</b> Trapezoidal Rule</a></li>
<li class="chapter" data-level="3.3.3" data-path="ch-calculus.html"><a href="ch-calculus.html#simpsons-rule"><i class="fa fa-check"></i><b>3.3.3</b> Simpsons Rule</a></li>
</ul></li>
<li class="chapter" data-level="3.4" data-path="ch-calculus.html"><a href="ch-calculus.html#optimization"><i class="fa fa-check"></i><b>3.4</b> Optimization</a>
<ul>
<li class="chapter" data-level="3.4.1" data-path="ch-calculus.html"><a href="ch-calculus.html#single-variable-optimization"><i class="fa fa-check"></i><b>3.4.1</b> Single Variable Optimization</a></li>
<li class="chapter" data-level="3.4.2" data-path="ch-calculus.html"><a href="ch-calculus.html#multivariable-optimization"><i class="fa fa-check"></i><b>3.4.2</b> Multivariable Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="ch-calculus.html"><a href="ch-calculus.html#calculus-with-numpy-and-scipy"><i class="fa fa-check"></i><b>3.5</b> Calculus with <code>numpy</code> and <code>scipy</code></a>
<ul>
<li class="chapter" data-level="3.5.1" data-path="ch-calculus.html"><a href="ch-calculus.html#differentiation-1"><i class="fa fa-check"></i><b>3.5.1</b> Differentiation</a></li>
<li class="chapter" data-level="3.5.2" data-path="ch-calculus.html"><a href="ch-calculus.html#integration-1"><i class="fa fa-check"></i><b>3.5.2</b> Integration</a></li>
<li class="chapter" data-level="3.5.3" data-path="ch-calculus.html"><a href="ch-calculus.html#optimization-1"><i class="fa fa-check"></i><b>3.5.3</b> Optimization</a></li>
</ul></li>
<li class="chapter" data-level="3.6" data-path="ch-calculus.html"><a href="ch-calculus.html#least-squares-curve-fitting"><i class="fa fa-check"></i><b>3.6</b> Least Squares Curve Fitting</a></li>
<li class="chapter" data-level="3.7" data-path="ch-calculus.html"><a href="ch-calculus.html#exercises-2"><i class="fa fa-check"></i><b>3.7</b> Exercises</a>
<ul>
<li class="chapter" data-level="3.7.1" data-path="ch-calculus.html"><a href="ch-calculus.html#algorithm-summaries-1"><i class="fa fa-check"></i><b>3.7.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="3.7.2" data-path="ch-calculus.html"><a href="ch-calculus.html#applying-what-youve-learned-2"><i class="fa fa-check"></i><b>3.7.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="3.8" data-path="ch-calculus.html"><a href="ch-calculus.html#projects-1"><i class="fa fa-check"></i><b>3.8</b> Projects</a>
<ul>
<li class="chapter" data-level="3.8.1" data-path="ch-calculus.html"><a href="ch-calculus.html#galaxy-integration"><i class="fa fa-check"></i><b>3.8.1</b> Galaxy Integration</a></li>
<li class="chapter" data-level="3.8.2" data-path="ch-calculus.html"><a href="ch-calculus.html#higher-order-integration"><i class="fa fa-check"></i><b>3.8.2</b> Higher Order Integration</a></li>
<li class="chapter" data-level="3.8.3" data-path="ch-calculus.html"><a href="ch-calculus.html#dam-integration"><i class="fa fa-check"></i><b>3.8.3</b> Dam Integration</a></li>
<li class="chapter" data-level="3.8.4" data-path="ch-calculus.html"><a href="ch-calculus.html#edge-detection-in-images"><i class="fa fa-check"></i><b>3.8.4</b> Edge Detection in Images</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html"><i class="fa fa-check"></i><b>4</b> Linear Algebra</a>
<ul>
<li class="chapter" data-level="4.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#intro-to-numerical-linear-algebra"><i class="fa fa-check"></i><b>4.1</b> Intro to Numerical Linear Algebra</a></li>
<li class="chapter" data-level="4.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#vectors-and-matrices-in-python"><i class="fa fa-check"></i><b>4.2</b> Vectors and Matrices in Python</a></li>
<li class="chapter" data-level="4.3" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#matrix-and-vector-operations"><i class="fa fa-check"></i><b>4.3</b> Matrix and Vector Operations</a>
<ul>
<li class="chapter" data-level="4.3.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-dot-product"><i class="fa fa-check"></i><b>4.3.1</b> The Dot Product</a></li>
<li class="chapter" data-level="4.3.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#matrix-multiplication"><i class="fa fa-check"></i><b>4.3.2</b> Matrix Multiplication</a></li>
</ul></li>
<li class="chapter" data-level="4.4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-lu-factorization"><i class="fa fa-check"></i><b>4.4</b> The LU Factorization</a>
<ul>
<li class="chapter" data-level="4.4.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#a-recap-of-row-reduction"><i class="fa fa-check"></i><b>4.4.1</b> A Recap of Row Reduction</a></li>
<li class="chapter" data-level="4.4.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-lu-decomposition"><i class="fa fa-check"></i><b>4.4.2</b> The LU Decomposition</a></li>
<li class="chapter" data-level="4.4.3" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#solving-triangular-systems"><i class="fa fa-check"></i><b>4.4.3</b> Solving Triangular Systems</a></li>
<li class="chapter" data-level="4.4.4" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#solving-systems-with-lu"><i class="fa fa-check"></i><b>4.4.4</b> Solving Systems with LU</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-qr-factorization"><i class="fa fa-check"></i><b>4.5</b> The QR Factorization</a></li>
<li class="chapter" data-level="4.6" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#over-determined-systems-and-curve-fitting"><i class="fa fa-check"></i><b>4.6</b> Over Determined Systems and Curve Fitting</a></li>
<li class="chapter" data-level="4.7" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-eigenvalue-eigenvector-problem"><i class="fa fa-check"></i><b>4.7</b> The Eigenvalue-Eigenvector Problem</a></li>
<li class="chapter" data-level="4.8" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#exercises-3"><i class="fa fa-check"></i><b>4.8</b> Exercises</a>
<ul>
<li class="chapter" data-level="4.8.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#algorithm-summaries-2"><i class="fa fa-check"></i><b>4.8.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="4.8.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#applying-what-youve-learned-3"><i class="fa fa-check"></i><b>4.8.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="4.9" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#projects-2"><i class="fa fa-check"></i><b>4.9</b> Projects</a>
<ul>
<li class="chapter" data-level="4.9.1" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#the-google-page-rank-algorithm"><i class="fa fa-check"></i><b>4.9.1</b> The Google Page Rank Algorithm</a></li>
<li class="chapter" data-level="4.9.2" data-path="ch-linearalgebra.html"><a href="ch-linearalgebra.html#alternative-methods-to-solving-a-boldsymbolx-boldsymbolb"><i class="fa fa-check"></i><b>4.9.2</b> Alternative Methods To Solving <span class="math inline">\(A \boldsymbol{x} = \boldsymbol{b}\)</span></a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="5" data-path="ch-odes.html"><a href="ch-odes.html"><i class="fa fa-check"></i><b>5</b> Ordinary Differential Equations</a>
<ul>
<li class="chapter" data-level="5.1" data-path="ch-odes.html"><a href="ch-odes.html#intro-to-numerical-odes"><i class="fa fa-check"></i><b>5.1</b> Intro to Numerical ODEs</a></li>
<li class="chapter" data-level="5.2" data-path="ch-odes.html"><a href="ch-odes.html#recalling-the-basics-of-odes"><i class="fa fa-check"></i><b>5.2</b> Recalling the Basics of ODEs</a></li>
<li class="chapter" data-level="5.3" data-path="ch-odes.html"><a href="ch-odes.html#eulers-method"><i class="fa fa-check"></i><b>5.3</b> Euler’s Method</a></li>
<li class="chapter" data-level="5.4" data-path="ch-odes.html"><a href="ch-odes.html#the-midpoint-method"><i class="fa fa-check"></i><b>5.4</b> The Midpoint Method</a></li>
<li class="chapter" data-level="5.5" data-path="ch-odes.html"><a href="ch-odes.html#the-runge-kutta-4-method"><i class="fa fa-check"></i><b>5.5</b> The Runge-Kutta 4 Method</a></li>
<li class="chapter" data-level="5.6" data-path="ch-odes.html"><a href="ch-odes.html#animating-ode-solutions"><i class="fa fa-check"></i><b>5.6</b> Animating ODE Solutions</a>
<ul>
<li class="chapter" data-level="5.6.1" data-path="ch-odes.html"><a href="ch-odes.html#ipywidgets.interactive"><i class="fa fa-check"></i><b>5.6.1</b> <code>ipywidgets.interactive</code></a></li>
<li class="chapter" data-level="5.6.2" data-path="ch-odes.html"><a href="ch-odes.html#matplotlib.animation"><i class="fa fa-check"></i><b>5.6.2</b> <code>matplotlib.animation</code></a></li>
</ul></li>
<li class="chapter" data-level="5.7" data-path="ch-odes.html"><a href="ch-odes.html#the-backwards-euler-method"><i class="fa fa-check"></i><b>5.7</b> The Backwards Euler Method</a></li>
<li class="chapter" data-level="5.8" data-path="ch-odes.html"><a href="ch-odes.html#fitting-ode-models-to-data"><i class="fa fa-check"></i><b>5.8</b> Fitting ODE Models to Data</a></li>
<li class="chapter" data-level="5.9" data-path="ch-odes.html"><a href="ch-odes.html#exercises-4"><i class="fa fa-check"></i><b>5.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="5.9.1" data-path="ch-odes.html"><a href="ch-odes.html#algorithm-summaries-3"><i class="fa fa-check"></i><b>5.9.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="5.9.2" data-path="ch-odes.html"><a href="ch-odes.html#applying-what-youve-learned-4"><i class="fa fa-check"></i><b>5.9.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="5.10" data-path="ch-odes.html"><a href="ch-odes.html#projects-3"><i class="fa fa-check"></i><b>5.10</b> Projects</a>
<ul>
<li class="chapter" data-level="5.10.1" data-path="ch-odes.html"><a href="ch-odes.html#the-covid-19-pandemic"><i class="fa fa-check"></i><b>5.10.1</b> The COVID-19 Pandemic</a></li>
<li class="chapter" data-level="5.10.2" data-path="ch-odes.html"><a href="ch-odes.html#pain-management"><i class="fa fa-check"></i><b>5.10.2</b> Pain Management</a></li>
<li class="chapter" data-level="5.10.3" data-path="ch-odes.html"><a href="ch-odes.html#the-h1n1-virus"><i class="fa fa-check"></i><b>5.10.3</b> The H1N1 Virus</a></li>
<li class="chapter" data-level="5.10.4" data-path="ch-odes.html"><a href="ch-odes.html#the-artillery-problem"><i class="fa fa-check"></i><b>5.10.4</b> The Artillery Problem</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="ch-pdes.html"><a href="ch-pdes.html"><i class="fa fa-check"></i><b>6</b> Partial Differential Equations</a>
<ul>
<li class="chapter" data-level="6.1" data-path="ch-pdes.html"><a href="ch-pdes.html#intro-to-pdes"><i class="fa fa-check"></i><b>6.1</b> Intro to PDEs</a></li>
<li class="chapter" data-level="6.2" data-path="ch-pdes.html"><a href="ch-pdes.html#solutions-to-pdes"><i class="fa fa-check"></i><b>6.2</b> Solutions to PDEs</a></li>
<li class="chapter" data-level="6.3" data-path="ch-pdes.html"><a href="ch-pdes.html#boundary-conditions"><i class="fa fa-check"></i><b>6.3</b> Boundary Conditions</a></li>
<li class="chapter" data-level="6.4" data-path="ch-pdes.html"><a href="ch-pdes.html#the-heat-equation"><i class="fa fa-check"></i><b>6.4</b> The Heat Equation</a></li>
<li class="chapter" data-level="6.5" data-path="ch-pdes.html"><a href="ch-pdes.html#stability-of-the-heat-equation-solution"><i class="fa fa-check"></i><b>6.5</b> Stability of the Heat Equation Solution</a></li>
<li class="chapter" data-level="6.6" data-path="ch-pdes.html"><a href="ch-pdes.html#the-wave-equation"><i class="fa fa-check"></i><b>6.6</b> The Wave Equation</a></li>
<li class="chapter" data-level="6.7" data-path="ch-pdes.html"><a href="ch-pdes.html#traveling-waves"><i class="fa fa-check"></i><b>6.7</b> Traveling Waves</a></li>
<li class="chapter" data-level="6.8" data-path="ch-pdes.html"><a href="ch-pdes.html#the-laplace-and-poisson-equations"><i class="fa fa-check"></i><b>6.8</b> The Laplace and Poisson Equations</a></li>
<li class="chapter" data-level="6.9" data-path="ch-pdes.html"><a href="ch-pdes.html#exercises-5"><i class="fa fa-check"></i><b>6.9</b> Exercises</a>
<ul>
<li class="chapter" data-level="6.9.1" data-path="ch-pdes.html"><a href="ch-pdes.html#algorithm-summaries-4"><i class="fa fa-check"></i><b>6.9.1</b> Algorithm Summaries</a></li>
<li class="chapter" data-level="6.9.2" data-path="ch-pdes.html"><a href="ch-pdes.html#applying-what-youve-learned-5"><i class="fa fa-check"></i><b>6.9.2</b> Applying What You’ve Learned</a></li>
</ul></li>
<li class="chapter" data-level="6.10" data-path="ch-pdes.html"><a href="ch-pdes.html#projects-4"><i class="fa fa-check"></i><b>6.10</b> Projects</a>
<ul>
<li class="chapter" data-level="6.10.1" data-path="ch-pdes.html"><a href="ch-pdes.html#hunting-and-diffusion"><i class="fa fa-check"></i><b>6.10.1</b> Hunting and Diffusion</a></li>
<li class="chapter" data-level="6.10.2" data-path="ch-pdes.html"><a href="ch-pdes.html#heating-adobe-houses"><i class="fa fa-check"></i><b>6.10.2</b> Heating Adobe Houses</a></li>
</ul></li>
</ul></li>
<li class="appendix"><span><b>Appendices</b></span></li>
<li class="chapter" data-level="A" data-path="ch-python.html"><a href="ch-python.html"><i class="fa fa-check"></i><b>A</b> Introduction to Python</a>
<ul>
<li class="chapter" data-level="A.1" data-path="ch-python.html"><a href="ch-python.html#why-python"><i class="fa fa-check"></i><b>A.1</b> Why Python?</a></li>
<li class="chapter" data-level="A.2" data-path="ch-python.html"><a href="ch-python.html#getting-started"><i class="fa fa-check"></i><b>A.2</b> Getting Started</a></li>
<li class="chapter" data-level="A.3" data-path="ch-python.html"><a href="ch-python.html#hello-world"><i class="fa fa-check"></i><b>A.3</b> Hello, World!</a></li>
<li class="chapter" data-level="A.4" data-path="ch-python.html"><a href="ch-python.html#python-programming-basics"><i class="fa fa-check"></i><b>A.4</b> Python Programming Basics</a>
<ul>
<li class="chapter" data-level="A.4.1" data-path="ch-python.html"><a href="ch-python.html#variables"><i class="fa fa-check"></i><b>A.4.1</b> Variables</a></li>
<li class="chapter" data-level="A.4.2" data-path="ch-python.html"><a href="ch-python.html#indexing-and-lists"><i class="fa fa-check"></i><b>A.4.2</b> Indexing and Lists</a></li>
<li class="chapter" data-level="A.4.3" data-path="ch-python.html"><a href="ch-python.html#list-operations"><i class="fa fa-check"></i><b>A.4.3</b> List Operations</a></li>
<li class="chapter" data-level="A.4.4" data-path="ch-python.html"><a href="ch-python.html#tuples"><i class="fa fa-check"></i><b>A.4.4</b> Tuples</a></li>
<li class="chapter" data-level="A.4.5" data-path="ch-python.html"><a href="ch-python.html#control-flow-loops-and-if-statements"><i class="fa fa-check"></i><b>A.4.5</b> Control Flow: Loops and If Statements</a></li>
<li class="chapter" data-level="A.4.6" data-path="ch-python.html"><a href="ch-python.html#functions"><i class="fa fa-check"></i><b>A.4.6</b> Functions</a></li>
<li class="chapter" data-level="A.4.7" data-path="ch-python.html"><a href="ch-python.html#lambda-functions"><i class="fa fa-check"></i><b>A.4.7</b> Lambda Functions</a></li>
<li class="chapter" data-level="A.4.8" data-path="ch-python.html"><a href="ch-python.html#packages"><i class="fa fa-check"></i><b>A.4.8</b> Packages</a></li>
</ul></li>
<li class="chapter" data-level="A.5" data-path="ch-python.html"><a href="ch-python.html#numerical-python-with-numpy"><i class="fa fa-check"></i><b>A.5</b> Numerical Python with <code>numpy</code></a>
<ul>
<li class="chapter" data-level="A.5.1" data-path="ch-python.html"><a href="ch-python.html#numpy-arrays-array-operations-and-matrix-operations"><i class="fa fa-check"></i><b>A.5.1</b> Numpy Arrays, Array Operations, and Matrix Operations</a></li>
<li class="chapter" data-level="A.5.2" data-path="ch-python.html"><a href="ch-python.html#arange-linspace-zeros-ones-and-meshgrid"><i class="fa fa-check"></i><b>A.5.2</b> <code>arange, linspace, zeros, ones</code>, and <code>meshgrid</code></a></li>
</ul></li>
<li class="chapter" data-level="A.6" data-path="ch-python.html"><a href="ch-python.html#plotting-with-matplotlib"><i class="fa fa-check"></i><b>A.6</b> Plotting with <code>matplotlib</code></a>
<ul>
<li class="chapter" data-level="A.6.1" data-path="ch-python.html"><a href="ch-python.html#basics-with-plt.plot"><i class="fa fa-check"></i><b>A.6.1</b> Basics with <code>plt.plot()</code></a></li>
<li class="chapter" data-level="A.6.2" data-path="ch-python.html"><a href="ch-python.html#subplots"><i class="fa fa-check"></i><b>A.6.2</b> Subplots</a></li>
<li class="chapter" data-level="A.6.3" data-path="ch-python.html"><a href="ch-python.html#logarithmic-scaling-with-semilogy-semilogx-and-loglog"><i class="fa fa-check"></i><b>A.6.3</b> Logarithmic Scaling with <code>semilogy</code>, <code>semilogx</code>, and <code>loglog</code></a></li>
</ul></li>
<li class="chapter" data-level="A.7" data-path="ch-python.html"><a href="ch-python.html#symbolic-python-with-sympy"><i class="fa fa-check"></i><b>A.7</b> Symbolic Python with <code>sympy</code></a>
<ul>
<li class="chapter" data-level="A.7.1" data-path="ch-python.html"><a href="ch-python.html#symbolic-variables-with-symbols"><i class="fa fa-check"></i><b>A.7.1</b> Symbolic Variables with <code>symbols</code></a></li>
<li class="chapter" data-level="A.7.2" data-path="ch-python.html"><a href="ch-python.html#symbolic-algebra"><i class="fa fa-check"></i><b>A.7.2</b> Symbolic Algebra</a></li>
<li class="chapter" data-level="A.7.3" data-path="ch-python.html"><a href="ch-python.html#symbolic-function-evaluation"><i class="fa fa-check"></i><b>A.7.3</b> Symbolic Function Evaluation</a></li>
<li class="chapter" data-level="A.7.4" data-path="ch-python.html"><a href="ch-python.html#symbolic-calculus"><i class="fa fa-check"></i><b>A.7.4</b> Symbolic Calculus</a></li>
<li class="chapter" data-level="A.7.5" data-path="ch-python.html"><a href="ch-python.html#solving-equations-symbolically"><i class="fa fa-check"></i><b>A.7.5</b> Solving Equations Symbolically</a></li>
<li class="chapter" data-level="A.7.6" data-path="ch-python.html"><a href="ch-python.html#symbolic-plotting"><i class="fa fa-check"></i><b>A.7.6</b> Symbolic Plotting</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="B" data-path="ch-writing.html"><a href="ch-writing.html"><i class="fa fa-check"></i><b>B</b> Mathematical Writing</a>
<ul>
<li class="chapter" data-level="B.1" data-path="ch-writing.html"><a href="ch-writing.html#the-paper"><i class="fa fa-check"></i><b>B.1</b> The Paper</a></li>
<li class="chapter" data-level="B.2" data-path="ch-writing.html"><a href="ch-writing.html#figures-and-tables"><i class="fa fa-check"></i><b>B.2</b> Figures and Tables</a></li>
<li class="chapter" data-level="B.3" data-path="ch-writing.html"><a href="ch-writing.html#writing-style"><i class="fa fa-check"></i><b>B.3</b> Writing Style</a></li>
<li class="chapter" data-level="B.4" data-path="ch-writing.html"><a href="ch-writing.html#tips-for-writing-clear-math"><i class="fa fa-check"></i><b>B.4</b> Tips For Writing Clear Math</a>
<ul>
<li class="chapter" data-level="B.4.1" data-path="ch-writing.html"><a href="ch-writing.html#audience"><i class="fa fa-check"></i><b>B.4.1</b> Audience</a></li>
<li class="chapter" data-level="B.4.2" data-path="ch-writing.html"><a href="ch-writing.html#how-to-make-mathematics-readable-10-things-to-do"><i class="fa fa-check"></i><b>B.4.2</b> How To Make Mathematics Readable – 10 Things To Do</a></li>
<li class="chapter" data-level="B.4.3" data-path="ch-writing.html"><a href="ch-writing.html#some-writing-tips"><i class="fa fa-check"></i><b>B.4.3</b> Some Writing Tips</a></li>
<li class="chapter" data-level="B.4.4" data-path="ch-writing.html"><a href="ch-writing.html#mathematical-vocabulary"><i class="fa fa-check"></i><b>B.4.4</b> Mathematical Vocabulary</a></li>
</ul></li>
<li class="chapter" data-level="B.5" data-path="ch-writing.html"><a href="ch-writing.html#code-and-mathematical-writing"><i class="fa fa-check"></i><b>B.5</b> Code and Mathematical writing</a></li>
</ul></li>
<li class="chapter" data-level="C" data-path="ch-extras.html"><a href="ch-extras.html"><i class="fa fa-check"></i><b>C</b> Optional Material</a>
<ul>
<li class="chapter" data-level="C.1" data-path="ch-extras.html"><a href="ch-extras.html#interpolation"><i class="fa fa-check"></i><b>C.1</b> Interpolation</a>
<ul>
<li class="chapter" data-level="C.1.1" data-path="ch-extras.html"><a href="ch-extras.html#vandermonde-interpolation"><i class="fa fa-check"></i><b>C.1.1</b> Vandermonde Interpolation</a></li>
<li class="chapter" data-level="C.1.2" data-path="ch-extras.html"><a href="ch-extras.html#lagrange-interpolation"><i class="fa fa-check"></i><b>C.1.2</b> Lagrange Interpolation</a></li>
<li class="chapter" data-level="C.1.3" data-path="ch-extras.html"><a href="ch-extras.html#chebyshev-points"><i class="fa fa-check"></i><b>C.1.3</b> Chebyshev Points</a></li>
</ul></li>
<li class="chapter" data-level="C.2" data-path="ch-extras.html"><a href="ch-extras.html#sec:mv_newton"><i class="fa fa-check"></i><b>C.2</b> Multi-Dimensional Newton’s Method</a></li>
<li class="chapter" data-level="C.3" data-path="ch-extras.html"><a href="ch-extras.html#the-method-of-lines"><i class="fa fa-check"></i><b>C.3</b> The Method Of Lines</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Numerical Methods</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="ch-pdes" class="section level1" number="6">
<h1><span class="header-section-number">6</span> Partial Differential Equations</h1>
<div id="intro-to-pdes" class="section level2" number="6.1">
<h2><span class="header-section-number">6.1</span> Intro to PDEs</h2>
<blockquote>
<p><em>“When you open the toolkit of differential equations you see the hammers and saws of engineering and physics for the past two centuries and for the foreseeable future.”</em><br />
–<a href="https://en.wikipedia.org/wiki/Benoit_Mandelbrot">Benoit Mandelbrot</a></p>
</blockquote>
<p>Partial differential equations (PDEs) are differential equations involving the partial derivatives of an unknown multivariable function. The study of PDEs is highly motivated f3by physics. In most of this chapter we will examine two classical problems from physics: heat transport phenomenon and wave phenomenon. Don’t think, however, that just because we’re focusing only on these two primary examples that this is the extent of the utility of PDEs. Basically every scientific field has been impacted by (or has directly impacted) the study of PDEs. Any phenomenon that can be modeled via the change in multiple dimensions (and time) is likely governed by a PDE model. Some common phenomena that are modeled by PDEs are:</p>
<ul>
<li>heat transport
<ul>
<li>The heat equation models heat energy (temperature) diffusing through a metal rod or a solid body</li>
</ul></li>
<li>diffusion of a concentrated substance
<ul>
<li>The diffusion equation is a PDE model for the diffusion of smells, contaminants, or the motion of a solute</li>
</ul></li>
<li>wave propagation
<ul>
<li>The wave equation is a PDE that can be used to model the standing waves on a guitar string, the waves on lake, or sound waves traveling through the air</li>
</ul></li>
<li>traveling waves
<ul>
<li>The traveling wave equation is a PDE that can be used to model pulses of light propagating through a fiber optic cable or regions of high density traffic moving along a highway.</li>
</ul></li>
<li>quantum mechanics
<ul>
<li>The wave functions of quantum mechanics are described by a PDE called the Schrodinger Equation.</li>
</ul></li>
<li>electro-magnetism
<ul>
<li>Maxwell’s Equations are a system of PDEs describing the relationships between electricity and magnetism.</li>
</ul></li>
<li>fluid flow
<ul>
<li>The Navier-Stokes equations are a system of PDEs that model fluids in three dimensions – including turbulent flow.</li>
<li>Darcy’s Law and Richard’s equation are PDE models for the motion of fluids moving through saturated and unsaturated soils.</li>
</ul></li>
<li>stress and strain in structures
<ul>
<li>The Linear Elasticity equation is a PDE that models the stresses in a solid body (like a bridge or a building) under load.</li>
</ul></li>
<li>spatial patterns
<ul>
<li>Solutions to the Helmholtz equation are known for exhibiting <em>Turing patterns</em> which are patterns like leopard spots or zebra stripes.<br />
</li>
</ul></li>
<li>… and many more …</li>
</ul>
<p>In many cases we are interested in ultimately solving PDEs in terms of our usual three spatial dimensions along with an extra dimension for time. However, in many cases we don’t have to work with all three spatial dimensions (like if the domain is much larger in one or two directions versus the others) or in some cases (like in linear elasticity) we don’t need to worry about time.</p>
<p>So what <em>is</em> a Partial Differential Equation?</p>

<div class="definition">
<span id="def:unnamed-chunk-533" class="definition"><strong>Definition 6.1  </strong></span>(<strong>Partial Differential Equation</strong>) A partial differential equation (PDE) is an equation that relates a function and its partial derivatives. Typically we use the function name <span class="math inline">\(u\)</span> for the unknown function, and in most cases that we consider in this book we are thinking of <span class="math inline">\(u\)</span> as a function of time <span class="math inline">\(t\)</span> as well as one, two, or three spatial dimensions <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span>.
</div>
<hr />
<p>Specific examples of some common PDEs are:</p>
<ul>
<li>In one spatial dimension the “heat equation” takes the form
<span class="math display">\[ \frac{\partial u}{\partial t} = D \frac{\partial^2 u}{\partial x^2}.  \]</span>
This PDE states that the time derivative of the function <span class="math inline">\(u\)</span> is proportional to the second derivative with respect to the spatial dimension <span class="math inline">\(x\)</span>. This PDE can be used to model the time evolution of temperature in a heated one-dimensional rod. To see a video introduction to the heat equation go to <a href="https://youtu.be/uV-96o8RwOI">https://youtu.be/uV-96o8RwOI</a>.</li>
<li>In three dimensions the heat equation takes the form
<span class="math display">\[ \frac{\partial u}{\partial t} = D\left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} + \frac{\partial^2 u}{\partial z^2}  \right). \]</span>
This PDE states that the time derivative of <span class="math inline">\(u\)</span> is proportional to the sum of the three spatial second derivatives. This PDE can be used to model the time evolution of temperature in a heated three-dimensional object.</li>
<li>As a third example, consider the Laplace equation
<span class="math display">\[ \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} + \frac{\partial^2 u}{\partial z^2} = 0. \]</span>
This PDE states that the sum of the three second order derivatives is always zero. The Laplace equation gives the shape of an object that has minimum surface area while fixed to some boundary (like a soap bubble attached to a wire frame).<br />
</li>
<li>Finally, consider the three dimensional wave equation
<span class="math display">\[ \frac{\partial^2 u}{\partial t^2} = k\left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2}+ \frac{\partial^2 u}{\partial z^2} \right). \]</span>
This PDE states that the acceleration at a point is proportional to the sum of the spatial second derivatives. The wave equation can be used to model the propagation of a sound wave through the air. For a video introduction to the wave equation go to <a href="https://youtu.be/hPcH22-ap9o">https://youtu.be/hPcH22-ap9o</a>.</li>
</ul>
<p>There is a wealth of wonderful theory for finding analytic solutions to many special classes of PDEs. However, most PDEs simply do not easily lend themselves to analytic solutions that we can write down in terms of the regular mathematical operations of sums, products, powers, roots, trigonometric functions, logarithms, etc. Just like with ODEs, the trouble comes in that you are ultimately trying to integrate to solve the PDE, and we know that finding an antiderivative is usually an impossible task!</p>
<p>Recall that numerical solutions to ODEs were approximations of the value of the unknown function at every time. Similarly, numerical solutions to PDEs are going to be approximations of the value of the unknown function at every time AND at every point in the spatial domain.</p>
<p>What we’ll cover in this chapter will include one primary and powerful technique for approximating solutions to PDEs: <strong>the finite difference method</strong>. There are many other techniques for approximating solutions to PDEs, and the field of numerical PDEs is still an active area of mathematical and scientific research. For a quick video introduction to numerical PDEs go to <a href="https://youtu.be/_W7srt0hghY">https://youtu.be/_W7srt0hghY</a>.</p>
<p>Lastly, since PDEs require a strong background in the notions of multivariable calculus let’s at least start with an exercise that should jog your memory about such things as the partial derivative, the gradient, and the divergence operators.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-534" class="exercise"><strong>Exercise 6.1  </strong></span>With your partner answer each of the following questions. The main ideas in this problem <em>should</em> be review from multivariable calculus. If you and your partner are stuck then ask another group.</p>
<ol style="list-style-type: lower-alpha">
<li>What is a partial derivative (explain geometrically)</li>
<li>What is the gradient of a function? What does it tell us physically or geometrically? If <span class="math inline">\(u(x,y)=x^2+\sin(xy)\)</span> then what is <span class="math inline">\(\nabla u\)</span>?</li>
<li>What is the divergence of a vector-valued function? What does it tell us physically or geometrically? If <span class="math inline">\(F(x,y)=\left&lt; \sin(xy), x^2+y^2\right&gt;\)</span> then what is <span class="math inline">\(\nabla \cdot F\)</span>?</li>
<li>If <span class="math inline">\(u\)</span> is a function of <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(z\)</span> then what is <span class="math inline">\(\nabla \cdot \nabla u\)</span>?</li>
</ol>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="solutions-to-pdes" class="section level2" number="6.2">
<h2><span class="header-section-number">6.2</span> Solutions to PDEs</h2>

<div class="example">
<p><span id="exm:unnamed-chunk-535" class="example"><strong>Example 6.1  </strong></span>If we were to claim that <span class="math inline">\(x(t) = 7e^{3t}\)</span> is a solution to the ordinary differential equation <span class="math inline">\(\frac{dx}{dt} = 3x\)</span> with <span class="math inline">\(x(0) = 7\)</span> then you could easily check that the claim was true by doing two things:</p>
<ol style="list-style-type: decimal">
<li>Check that the proposed solution matches the initial condition. In this example we see that <span class="math inline">\(x(0) = 7e^{3 \cdot 0} = 7 \quad \checkmark.\)</span></li>
<li>Check that the function satisfies the differential equation. In other words, substitute the function <span class="math inline">\(x(t)\)</span> into the differential equation <span class="math inline">\(x&#39; = 3x\)</span> and verify that the equal sign is actually true. In this case, <span class="math inline">\(x&#39; = 3\cdot 7e^{3t} = 3 x \quad \checkmark .\)</span></li>
</ol>
</div>
<hr />
<p>Checking a solution to a differential equation amounts to substituting the function into the differential equation and the associated conditions and verifying that everything is true. Let’s do the same for some partial differential equations.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-536" class="exercise"><strong>Exercise 6.2  </strong></span>Consider the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> where <span class="math inline">\(u(t,x)\)</span> is the temperature of a long thin metal rod at time <span class="math inline">\(t\)</span> (in seconds) and spatial location <span class="math inline">\(x\)</span> (in meters).</p>
<p>Note: the symbol <span class="math inline">\(u_t\)</span> is quick shorthand for the partial derivative <span class="math inline">\(\frac{\partial u}{\partial t}\)</span> and <span class="math inline">\(u_{xx}\)</span> is a quick shorthand for the second partial derivative <span class="math inline">\(\frac{\partial^2 u}{\partial x^2}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>What are the units of the constant <span class="math inline">\(D\)</span>?</li>
<li>For each of the following functions, test whether it is an analytical solution to this PDE by taking the first derivative with respect to time, the second derivative with respect to position, and substituting them into this equation to see if we get an identity (a true statement). If <span class="math inline">\(D = 3\)</span>, which of these functions is a solution? Be able to defend your answer.
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(u(t,x) = 4 x^3 + 6 t^2\)</span></li>
<li><span class="math inline">\(u(t,x) = 7 x + 5\)</span></li>
<li><span class="math inline">\(u(t,x) = 8 x^2 t\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{3 t + x}\)</span></li>
<li><span class="math inline">\(u(t,x) = 6 e^{3 t + x} +5x - 2\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{-3t} + \sin (x)\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{3t} \sin (x)\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{-3t} \sin (x)\)</span></li>
<li><span class="math inline">\(u(t,x) = 5 e^{-3t} \sin (x) + 6x + 7\)</span></li>
<li><span class="math inline">\(u(t,x) = -4 e^{-3t} \sin (x) + 3t + 2\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{-2t} \sin (3x)\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{-12 t} \cos (3x)\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{-12 t} \cos (3x)+4x^2 + 8\)</span></li>
<li><span class="math inline">\(u(t,x) = e^{-75 t} \cos (5x)\)</span></li>
<li><span class="math inline">\(u(t,x) = 9 e^{-75 t} \cos (5x) + 2 x + 7\)</span></li>
</ol></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-537" class="exercise"><strong>Exercise 6.3  </strong></span>Consider the PDE <span class="math inline">\(u_t = D u_{xx}\)</span>, and suppose that <span class="math inline">\(D=4\)</span>. For each of the following functions, find the value of the parameter <span class="math inline">\(a\)</span> that will make the function solve the PDE, by taking derivatives and substituting them into the equation.</p>
<ol style="list-style-type: lower-alpha">
<li><span class="math inline">\(u(t,x) = 6 e^{-8 t} \sin(ax)\)</span></li>
<li><span class="math inline">\(u(t,x) = -5 e^{38 t} \cos(ax)\)</span></li>
<li><span class="math inline">\(u(t,x) = 3 e^{at} \sin(5 x)\)</span></li>
<li><span class="math inline">\(u(t,x) = 7 e^{at} \cos(2 x)\)</span></li>
<li><span class="math inline">\(u(t,x) = a e^{-36t} \cos(3 x)\)</span></li>
<li><span class="math inline">\(u(t,x) = a e^{-4t} \cos(6 x)\)</span></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-538" class="exercise"><strong>Exercise 6.4  </strong></span>Consider again the PDE <span class="math inline">\(u_t = D u_{xx}\)</span>. Is the function <span class="math inline">\(u(t,x) = x^2 - t^3\)</span> a valid solution for this differential equation? If so, what is the value of the constant <span class="math inline">\(k\)</span>?</p>
<ol style="list-style-type: lower-alpha">
<li>Calculate <span class="math inline">\(u_t\)</span> and <span class="math inline">\(u_{xx}\)</span>
<span class="math display">\[ u_t = \underline{\hspace{1in}} \quad \text{and} \quad u_{xx} = \underline{\hspace{1in}} \]</span></li>
<li>If the differential equation <span class="math inline">\(u_t = Du_{xx}\)</span> is to be satisfied then what equation must be true?
<span class="math display">\[ \underline{\hspace{1in}} = \underline{\hspace{1in}} \]</span></li>
<li>Is there a single value of <span class="math inline">\(D\)</span> that makes the PDE true with this proposed solution? If so, then we must have a solution to the PDE, if not then we must not have a solution to the PDE. Is <span class="math inline">\(u(t,x)\)</span> a solution to the equation <span class="math inline">\(u_t = Du_{xx}\)</span>?</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-539" class="exercise"><strong>Exercise 6.5  </strong></span>The PDE <span class="math inline">\(u_t = D u_{xx}\)</span> can be seen as asking two questions: (1) the time derivative of the function <span class="math inline">\(u(t,x)\)</span> is related to the function <span class="math inline">\(u\)</span> itself, and (2) the second spatial derivative of the function <span class="math inline">\(u(t,x)\)</span> is related to the function <span class="math inline">\(u\)</span> itself.</p>
<ol style="list-style-type: lower-alpha">
<li>What sort of function has the property that when you take the derivative you get a scaled version of the function back.</li>
<li>What sort of function has the property that when you take two derivatives you get a scaled version of the function back.</li>
<li>Based on your answers to parts (a) and (b), propose a function that might be a solution to the PDE.</li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-540" class="exercise"><strong>Exercise 6.6  </strong></span>Is the function <span class="math inline">\(u(t,x) = e^{-0.2t} \sin(\pi x)\)</span> a solution to the PDE <span class="math inline">\(u_t =Dk u_{xx}\)</span>? If this function is a solution to the PDE then what is the associated value of <span class="math inline">\(D\)</span>?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-541" class="exercise"><strong>Exercise 6.7  </strong></span>Is a scalar multiple of the function in the previous exercise also a solution to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> with the exact same value for <span class="math inline">\(k\)</span>? Will this always be true? That is, if we have one solution <span class="math inline">\(u(t,x)\)</span> to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> then will <span class="math inline">\(c u(t,x)\)</span> be another solution for any real number <span class="math inline">\(c\)</span>?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-542" class="exercise"><strong>Exercise 6.8  </strong></span>When we studied ODEs we always had a starting point for a solution – the initial condition. In the case of a PDE we also need to have an initial condition, but the initial condition is associated with every point in the spatial domain. Hence, the initial condition is actually a function of <span class="math inline">\(x\)</span>. In the previous exercise you found the <span class="math inline">\(u(t,x) = e^{-0.2t} \sin(\pi x)\)</span> is a solution to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span>. What is the initial condition that this solution satisfies? In other words, what is the function <span class="math inline">\(u(t,x)\)</span> at time <span class="math inline">\(t=0\)</span>?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-543" class="exercise"><strong>Exercise 6.9  </strong></span>Since we have both temporal and spatial variables in PDEs it stands to reason that we need conditions on both variables in order to get a unique solution to the PDE. For the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> we already saw that <span class="math inline">\(u(t,x) = e^{-0.2t} \sin(\pi x)\)</span> is a solution to the PDE and the initial condition for that solution is <span class="math inline">\(u(0,x) = \sin(\pi x)\)</span>. If we are solving the PDE on the domain <span class="math inline">\(x \in [0,1]\)</span> then what are the conditions that holds for all time at the points <span class="math inline">\(x=0\)</span> and <span class="math inline">\(x=1\)</span>? These conditions are called <strong>boundary conditions</strong>.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-544" class="exercise"><strong>Exercise 6.10  </strong></span>(<strong>Visualizing Solutions to PDEs</strong>) Solutions to PDEs are multivariable functions. In the previous few problems we have examined the heat equation <span class="math inline">\(u_t = D u_{xx}\)</span>. The function <span class="math inline">\(u\)</span> is a function of time, <span class="math inline">\(t\)</span>, and one spatial variable, <span class="math inline">\(x\)</span>. We have several choices when we make a plot of this type of function. Implement and complete the blocks of code below to get three different visualizations of the solution <span class="math inline">\(u(t,x) = e^{-0.2t} \sin(\pi x)\)</span> on the domain <span class="math inline">\(t \in [0,1]\)</span> and <span class="math inline">\(x \in [0,1]\)</span>.
</div>
<ol style="list-style-type: lower-alpha">
<li>The first idea is to show several discrete snapshots of time and to arrange the plots in an array so we can read from left to right to see the evolution in time.</li>
</ol>
<div class="sourceCode" id="cb99"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb99-1"><a href="ch-pdes.html#cb99-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb99-2"><a href="ch-pdes.html#cb99-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb99-3"><a href="ch-pdes.html#cb99-3" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="kw">lambda</span> t, x: np.exp(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>t) <span class="op">*</span> np.sin(np.pi<span class="op">*</span>x)</span>
<span id="cb99-4"><a href="ch-pdes.html#cb99-4" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="co"># code that gives 100 equally spaced points from 0 to 1 </span></span>
<span id="cb99-5"><a href="ch-pdes.html#cb99-5" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="co"># code that gives 16 equally spaced points from 0 to 10</span></span>
<span id="cb99-6"><a href="ch-pdes.html#cb99-6" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots(nrows<span class="op">=</span><span class="dv">4</span>,ncols<span class="op">=</span><span class="dv">4</span>)</span>
<span id="cb99-7"><a href="ch-pdes.html#cb99-7" aria-hidden="true" tabindex="-1"></a>counter <span class="op">=</span> <span class="dv">0</span> <span class="co"># this counter will count through the times</span></span>
<span id="cb99-8"><a href="ch-pdes.html#cb99-8" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb99-9"><a href="ch-pdes.html#cb99-9" aria-hidden="true" tabindex="-1"></a>    <span class="cf">for</span> m <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">4</span>):</span>
<span id="cb99-10"><a href="ch-pdes.html#cb99-10" aria-hidden="true" tabindex="-1"></a>        ax[n,m].plot(??? , ???, <span class="st">&#39;b&#39;</span>) <span class="co"># plot x vs u(t[counter],x)</span></span>
<span id="cb99-11"><a href="ch-pdes.html#cb99-11" aria-hidden="true" tabindex="-1"></a>        ax[n,m].grid()</span>
<span id="cb99-12"><a href="ch-pdes.html#cb99-12" aria-hidden="true" tabindex="-1"></a>        ax[n,m].set_ylim(<span class="dv">0</span>,<span class="dv">1</span>) <span class="co"># same axis for every plot</span></span>
<span id="cb99-13"><a href="ch-pdes.html#cb99-13" aria-hidden="true" tabindex="-1"></a>        ax[n,m].set_xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb99-14"><a href="ch-pdes.html#cb99-14" aria-hidden="true" tabindex="-1"></a>        ax[n,m].set_ylabel(<span class="st">&#39;u&#39;</span>)</span>
<span id="cb99-15"><a href="ch-pdes.html#cb99-15" aria-hidden="true" tabindex="-1"></a>        ax[n,m].set_title(<span class="st">&quot;time=&quot;</span><span class="op">+</span>np.<span class="bu">str</span>(t[counter]))</span>
<span id="cb99-16"><a href="ch-pdes.html#cb99-16" aria-hidden="true" tabindex="-1"></a>        counter <span class="op">+=</span> <span class="dv">1</span> <span class="co"># increment the counter</span></span>
<span id="cb99-17"><a href="ch-pdes.html#cb99-17" aria-hidden="true" tabindex="-1"></a>fig.tight_layout()        </span>
<span id="cb99-18"><a href="ch-pdes.html#cb99-18" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-546"></span>
<img src="images/Ch06_TimeEvolution1.png" alt="Time evolution of a solution to the PDE" width="95%" />
<p class="caption">
Figure 6.1: Time evolution of a solution to the PDE
</p>
</div>
<ol start="2" style="list-style-type: lower-alpha">
<li>A second idea for plotting the solution to a PDE is to give an interactive plot where we can use a slider to advance (or reverse) time.</li>
</ol>
<div class="sourceCode" id="cb100"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb100-1"><a href="ch-pdes.html#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb100-2"><a href="ch-pdes.html#cb100-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb100-3"><a href="ch-pdes.html#cb100-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interactive</span>
<span id="cb100-4"><a href="ch-pdes.html#cb100-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-5"><a href="ch-pdes.html#cb100-5" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="kw">lambda</span> t, x: np.exp(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>t) <span class="op">*</span> (<span class="dv">1</span><span class="op">*</span>np.sin(<span class="dv">1</span><span class="op">*</span>np.pi<span class="op">*</span>x))</span>
<span id="cb100-6"><a href="ch-pdes.html#cb100-6" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">100</span>)</span>
<span id="cb100-7"><a href="ch-pdes.html#cb100-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-8"><a href="ch-pdes.html#cb100-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotter(T):</span>
<span id="cb100-9"><a href="ch-pdes.html#cb100-9" aria-hidden="true" tabindex="-1"></a>  plt.plot(x , u(T,x), <span class="st">&#39;b&#39;</span>)</span>
<span id="cb100-10"><a href="ch-pdes.html#cb100-10" aria-hidden="true" tabindex="-1"></a>  plt.grid()</span>
<span id="cb100-11"><a href="ch-pdes.html#cb100-11" aria-hidden="true" tabindex="-1"></a>  plt.ylim(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb100-12"><a href="ch-pdes.html#cb100-12" aria-hidden="true" tabindex="-1"></a>  plt.show()</span>
<span id="cb100-13"><a href="ch-pdes.html#cb100-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb100-14"><a href="ch-pdes.html#cb100-14" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="op">=</span> interactive(plotter, T<span class="op">=</span>(<span class="dv">0</span>,<span class="dv">20</span>,<span class="fl">0.1</span>))</span>
<span id="cb100-15"><a href="ch-pdes.html#cb100-15" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-548"></span>
<img src="images/Ch06_TimeEvolution2.png" alt="Snapshot of animated time evolution of a solution to the PDE" width="75%" />
<p class="caption">
Figure 6.2: Snapshot of animated time evolution of a solution to the PDE
</p>
</div>
<ol start="3" style="list-style-type: lower-alpha">
<li>A third idea for plotting the solution to a PDE is to create a three dimensional plot with time on one axis, <span class="math inline">\(x\)</span> on the second axis, and <span class="math inline">\(u\)</span> on the vertical axis. To read this plot we start our eyes at <span class="math inline">\(t=0\)</span> and then scan down the <span class="math inline">\(t\)</span> axis. In this way we can see the whole time evolution of the PDE in one plot without animation. Of course, if the PDE had two or more spatial dimensions plus time then this sort of plot would not be feasible.</li>
</ol>
<div class="sourceCode" id="cb101"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb101-1"><a href="ch-pdes.html#cb101-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb101-2"><a href="ch-pdes.html#cb101-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb101-3"><a href="ch-pdes.html#cb101-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> mpl_toolkits.mplot3d <span class="im">import</span> Axes3D</span>
<span id="cb101-4"><a href="ch-pdes.html#cb101-4" aria-hidden="true" tabindex="-1"></a>fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">10</span>,<span class="dv">8</span>))</span>
<span id="cb101-5"><a href="ch-pdes.html#cb101-5" aria-hidden="true" tabindex="-1"></a>ax <span class="op">=</span> fig.gca(projection<span class="op">=</span><span class="st">&#39;3d&#39;</span>) <span class="co"># gca stands for &quot;Get Current Axis&quot;</span></span>
<span id="cb101-6"><a href="ch-pdes.html#cb101-6" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="kw">lambda</span> t, x: np.exp(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>t)<span class="op">*</span>np.sin(np.pi<span class="op">*</span>x)</span>
<span id="cb101-7"><a href="ch-pdes.html#cb101-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">25</span>)</span>
<span id="cb101-8"><a href="ch-pdes.html#cb101-8" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">25</span>)</span>
<span id="cb101-9"><a href="ch-pdes.html#cb101-9" aria-hidden="true" tabindex="-1"></a>T, X <span class="op">=</span> np.meshgrid(t,x)</span>
<span id="cb101-10"><a href="ch-pdes.html#cb101-10" aria-hidden="true" tabindex="-1"></a>ax.plot_wireframe(T,X,u(T,X))</span>
<span id="cb101-11"><a href="ch-pdes.html#cb101-11" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;time&#39;</span>)</span>
<span id="cb101-12"><a href="ch-pdes.html#cb101-12" aria-hidden="true" tabindex="-1"></a>ax.set_ylabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb101-13"><a href="ch-pdes.html#cb101-13" aria-hidden="true" tabindex="-1"></a>ax.set_zlabel(<span class="st">&#39;u(t,x)&#39;</span>)</span>
<span id="cb101-14"><a href="ch-pdes.html#cb101-14" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-550"></span>
<img src="images/Ch06_TimeEvolution3.png" alt="3D plot showing the time evolution of the solution to the PDE." width="75%" />
<p class="caption">
Figure 6.3: 3D plot showing the time evolution of the solution to the PDE.
</p>
</div>
<ol start="4" style="list-style-type: lower-alpha">
<li>A final idea is to use <code>matplotlib.animation</code>. Note that this method may only work well with the Google Colab environment.</li>
</ol>
<div class="sourceCode" id="cb102"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb102-1"><a href="ch-pdes.html#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb102-2"><a href="ch-pdes.html#cb102-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb102-3"><a href="ch-pdes.html#cb102-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> animation, rc</span>
<span id="cb102-4"><a href="ch-pdes.html#cb102-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb102-5"><a href="ch-pdes.html#cb102-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-6"><a href="ch-pdes.html#cb102-6" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="kw">lambda</span> t, x: np.exp(<span class="op">-</span><span class="fl">0.2</span><span class="op">*</span>t)<span class="op">*</span>np.sin(np.pi<span class="op">*</span>x)</span>
<span id="cb102-7"><a href="ch-pdes.html#cb102-7" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">25</span>)</span>
<span id="cb102-8"><a href="ch-pdes.html#cb102-8" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">101</span>)</span>
<span id="cb102-9"><a href="ch-pdes.html#cb102-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-10"><a href="ch-pdes.html#cb102-10" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb102-11"><a href="ch-pdes.html#cb102-11" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb102-12"><a href="ch-pdes.html#cb102-12" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb102-13"><a href="ch-pdes.html#cb102-13" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb102-14"><a href="ch-pdes.html#cb102-14" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(( <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb102-15"><a href="ch-pdes.html#cb102-15" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(( <span class="dv">0</span>, <span class="dv">1</span>))</span>
<span id="cb102-16"><a href="ch-pdes.html#cb102-16" aria-hidden="true" tabindex="-1"></a>frame, <span class="op">=</span> ax.plot([], [], linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb102-17"><a href="ch-pdes.html#cb102-17" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-18"><a href="ch-pdes.html#cb102-18" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> animator(N):</span>
<span id="cb102-19"><a href="ch-pdes.html#cb102-19" aria-hidden="true" tabindex="-1"></a>  U <span class="op">=</span> u(t[N],x)</span>
<span id="cb102-20"><a href="ch-pdes.html#cb102-20" aria-hidden="true" tabindex="-1"></a>  ax.set_title(<span class="st">&#39;Time=&#39;</span><span class="op">+</span><span class="bu">str</span>(t[N]))</span>
<span id="cb102-21"><a href="ch-pdes.html#cb102-21" aria-hidden="true" tabindex="-1"></a>  frame.set_data(x,U)</span>
<span id="cb102-22"><a href="ch-pdes.html#cb102-22" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (frame,)</span>
<span id="cb102-23"><a href="ch-pdes.html#cb102-23" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb102-24"><a href="ch-pdes.html#cb102-24" aria-hidden="true" tabindex="-1"></a>PlotFrames <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(t),<span class="dv">1</span>) </span>
<span id="cb102-25"><a href="ch-pdes.html#cb102-25" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> animation.FuncAnimation(fig, </span>
<span id="cb102-26"><a href="ch-pdes.html#cb102-26" aria-hidden="true" tabindex="-1"></a>                               animator, </span>
<span id="cb102-27"><a href="ch-pdes.html#cb102-27" aria-hidden="true" tabindex="-1"></a>                               frames<span class="op">=</span>PlotFrames, </span>
<span id="cb102-28"><a href="ch-pdes.html#cb102-28" aria-hidden="true" tabindex="-1"></a>                               interval<span class="op">=</span><span class="dv">100</span>, </span>
<span id="cb102-29"><a href="ch-pdes.html#cb102-29" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb102-30"><a href="ch-pdes.html#cb102-30" aria-hidden="true" tabindex="-1"></a>rc(<span class="st">&#39;animation&#39;</span>, html<span class="op">=</span><span class="st">&#39;jshtml&#39;</span>) <span class="co"># embed in the HTML for Google Colab</span></span>
<span id="cb102-31"><a href="ch-pdes.html#cb102-31" aria-hidden="true" tabindex="-1"></a>anim</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:unnamed-chunk-552"></span>
<img src="images/Ch06_TimeEvolution4.png" alt="Snapshot of an animation applet showing the time evolution of the solution to the PDE." width="75%" />
<p class="caption">
Figure 6.4: Snapshot of an animation applet showing the time evolution of the solution to the PDE.
</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-553" class="exercise"><strong>Exercise 6.11  </strong></span>In the previous problem you built several plots of the function <span class="math inline">\(u(t,x) = e^{-0.2t} \sin(\pi x)\)</span> as a solution to the heat equation <span class="math inline">\(u_t = D u_{xx}\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Based on the plots, why do you think the equation <span class="math inline">\(u_t = D u_{xx}\)</span> called the “heat equation?” That is, why do the solutions look like dissipating heat?<br />
</li>
<li>What is the limit
<span class="math display">\[ \lim_{t \to \infty} u(t,x)? \]</span>
Explain why your answer makes sense if we are solving an equation, called the “heat equation,” that models the diffusion of heat through an object. Hint: think of this <em>object</em> as a long thing metal rod and take note that the boundary conditions are both 0.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-554" class="exercise"><strong>Exercise 6.12  </strong></span>Propose another solution to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> that exactly matches the boundary conditions <span class="math inline">\(u(t,0)=0\)</span> and <span class="math inline">\(u(t,1)=0\)</span> for all time <span class="math inline">\(t\)</span> AND exactly the same value for <span class="math inline">\(D\)</span> as with the function <span class="math inline">\(u(t,x) = e^{-0.2t} \sin(\pi x)\)</span>. What is the new initial condition associated with your new solution?</p>
Hint: You may want to start with a function of the form <span class="math inline">\(u(t,x) = e^{at} \sin( bx)\)</span> and then determine values of <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span> that will satisfy all of the required conditions.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-555" class="exercise"><strong>Exercise 6.13  </strong></span>We now have two solutions to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> that satisfy both the PDE and the boundary conditions <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u(t,1)=0\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Prove that the sum of the two solutions also satisfies the PDE and the same boundary conditions? If so, then the sum appears to be <em>another</em> valid solution to the PDE.</li>
<li>What is the initial condition associated with the new solution you found in part (a)?</li>
<li>Use the code that you built above to show the time evolution of your new solution.</li>
</ol>
</div>
<hr />
<p>Let’s take stock of what we’ve investigated thus far.</p>

<div class="theorem">
<span id="thm:unnamed-chunk-556" class="theorem"><strong>Theorem 6.1  </strong></span>If <span class="math inline">\(u_0(t,x)\)</span> and <span class="math inline">\(u_1(t,x)\)</span> are both solutions to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> matching the same boundary conditions <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span> then for real scalars <span class="math inline">\(c_0\)</span> and <span class="math inline">\(c_1\)</span> the function <span class="math inline">\(c_0 u_0(t,x) + c_1 u_1(t,x)\)</span> is another solution to the PDE matching the same boundary conditions but perhaps having a different initial condition.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-557" class="exercise"><strong>Exercise 6.14  </strong></span>Prove the previous theorem. Then extend the theorem to show that if there are many functions that satisfy <span class="math inline">\(u_t = D u_{xx}\)</span> and the boundary conditions <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span> then the sum of all of the functions is also a solution and also satisfies the boundary conditions.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-558" class="exercise"><strong>Exercise 6.15  </strong></span>Propose several solutions to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> with the boundary conditions <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u_x(t,1) = 0\)</span>. That is to say that the function <span class="math inline">\(u(t,x)\)</span> is <span class="math inline">\(0\)</span> at <span class="math inline">\(x=0\)</span> and the derivative of <span class="math inline">\(u\)</span> with respect to <span class="math inline">\(x\)</span> at <span class="math inline">\(x=1\)</span> is 0 (there is a horizontal tangent line to the function <span class="math inline">\(u\)</span> at <span class="math inline">\(x=1\)</span> for all times <span class="math inline">\(t\)</span>). Then use your plotting code to verify that your solution satisfies the boundary conditions and visually shows the diffusion of heat as time evolves.
</div>
<hr />
<p>At this point we have a good notion of what the solutions to the PDE <span class="math inline">\(u_t = D u_{xx}\)</span> look and behave like. Now let’s ramp this up to two spatial dimensions.</p>

<div class="exercise">
<span id="exr:unnamed-chunk-559" class="exercise"><strong>Exercise 6.16  </strong></span>Leverage what you learned in the previous exercises to propose a function <span class="math inline">\(u(t,x,y)\)</span> that solves the equation
<span class="math display">\[ u_t = D \left( u_{xx} + u_{yy} \right) \]</span>
on the domain <span class="math inline">\(x \in [0,1]\)</span> and <span class="math inline">\(y \in [0,1]\)</span> with <span class="math inline">\(D=1\)</span>, the boundary conditions <span class="math inline">\(u(t,0,y) = 0\)</span>, <span class="math inline">\(u(t,1,y) = 0\)</span>, <span class="math inline">\(u(t,x,0)=u(t,x,1)=0\)</span>, and the initial condition <span class="math inline">\(u(0,x,y) = \sin(\pi x) \sin(\pi y)\)</span> (shown in Figure <a href="ch-pdes.html#fig:heat-ic">6.5</a>). Then use the code below to show the time evolution of your solution.
</div>
<div class="sourceCode" id="cb103"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb103-1"><a href="ch-pdes.html#cb103-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb103-2"><a href="ch-pdes.html#cb103-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb103-3"><a href="ch-pdes.html#cb103-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interactive</span>
<span id="cb103-4"><a href="ch-pdes.html#cb103-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-5"><a href="ch-pdes.html#cb103-5" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="kw">lambda</span> t, x, y: <span class="co"># your function goes here</span></span>
<span id="cb103-6"><a href="ch-pdes.html#cb103-6" aria-hidden="true" tabindex="-1"></a>x, y <span class="op">=</span> np.meshgrid( np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">25</span>), np.linspace(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">25</span>) )</span>
<span id="cb103-7"><a href="ch-pdes.html#cb103-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-8"><a href="ch-pdes.html#cb103-8" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotter(T):</span>
<span id="cb103-9"><a href="ch-pdes.html#cb103-9" aria-hidden="true" tabindex="-1"></a>    fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">15</span>,<span class="dv">12</span>))</span>
<span id="cb103-10"><a href="ch-pdes.html#cb103-10" aria-hidden="true" tabindex="-1"></a>    ax <span class="op">=</span> fig.gca(projection<span class="op">=</span><span class="st">&#39;3d&#39;</span>)</span>
<span id="cb103-11"><a href="ch-pdes.html#cb103-11" aria-hidden="true" tabindex="-1"></a>    z <span class="op">=</span> u(T,x,y)</span>
<span id="cb103-12"><a href="ch-pdes.html#cb103-12" aria-hidden="true" tabindex="-1"></a>    ax.plot_surface(x,y,z)</span>
<span id="cb103-13"><a href="ch-pdes.html#cb103-13" aria-hidden="true" tabindex="-1"></a>    ax.set_xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb103-14"><a href="ch-pdes.html#cb103-14" aria-hidden="true" tabindex="-1"></a>    ax.set_ylabel(<span class="st">&#39;y&#39;</span>)</span>
<span id="cb103-15"><a href="ch-pdes.html#cb103-15" aria-hidden="true" tabindex="-1"></a>    ax.set_zlabel(<span class="st">&#39;u(t,x,y)&#39;</span>)</span>
<span id="cb103-16"><a href="ch-pdes.html#cb103-16" aria-hidden="true" tabindex="-1"></a>    ax.set_zlim(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb103-17"><a href="ch-pdes.html#cb103-17" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb103-18"><a href="ch-pdes.html#cb103-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb103-19"><a href="ch-pdes.html#cb103-19" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="op">=</span> interactive(plotter, T <span class="op">=</span> (<span class="dv">0</span>,<span class="dv">10</span>,<span class="fl">0.1</span>) )</span>
<span id="cb103-20"><a href="ch-pdes.html#cb103-20" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code></pre></div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:heat-ic"></span>
<img src="images/Ch06_IC_2DHeat.png" alt="Initial condition" width="75%" />
<p class="caption">
Figure 6.5: Initial condition
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-561" class="exercise"><strong>Exercise 6.17  </strong></span>Prove that the function <span class="math inline">\(u(t,x,y) = e^{-0.2t} \sin(\pi x) \sin(\pi y)\)</span> is a solution to the two dimensional heat equation <span class="math inline">\(u_t = D(u_{xx} + u_{yy})\)</span>. Determine the value of <span class="math inline">\(D\)</span> for this particular solution. What are the boundary conditions and the initial condition?
</div>
<hr />
<p>Let’s move on to a different PDE: the wave equation.</p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-562" class="exercise"><strong>Exercise 6.18  </strong></span>Consider the wave equation <span class="math display">\[\frac{\partial^2 u}{\partial t^2} = c \frac{\partial^2 u}{\partial x^2}\]</span>
where <span class="math inline">\(u\)</span> is the height of the wave at time <span class="math inline">\(t\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>What are the units of <span class="math inline">\(c\)</span>?</li>
<li>Reading from left-to-right, the partial differential equation says that the second derivative of some function of <span class="math inline">\(t\)</span> is related to that same function. If you had to guess the <em>type</em> of function, what would you guess and why?</li>
<li>Reading from right-to-left, the partial differential equation says that the second derivative of some function of <span class="math inline">\(x\)</span> is related to that same function. If you had to guess the <em>type</em> of function, what would you guess and why?</li>
<li>Based on your guesses from parts (a) and (b), what type of function would think is a reasonable solution for the differential equation? Why?</li>
<li>If <span class="math inline">\(u(0,x) = \sin(2\pi x)\)</span> is the initial condition for the PDE and the boundary conditions are <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span> then propose a solution that matches these conditions and make plots showing how the solution behaves over time.</li>
</ol>
</div>
<hr />

<div class="theorem">
<span id="thm:unnamed-chunk-563" class="theorem"><strong>Theorem 6.2  </strong></span>If the function <span class="math inline">\(u(t,x)\)</span> solves the 1D wave equation <span class="math inline">\(u_{tt} = c u_{xx}\)</span> then <span class="math inline">\(u(t,x)\)</span> likely has the functional form
<span class="math display">\[u(t,x) = \underline{\hspace{2in}}.\]</span>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-564" class="exercise"><strong>Exercise 6.19  </strong></span>Prove your hypotheses from the previous theorem.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-565" class="exercise"><strong>Exercise 6.20  </strong></span>Make several plots of your solution showing the time evolution of the function. Examples of the plots are shown in Figures <a href="ch-pdes.html#fig:wave1">6.6</a> and <a href="ch-pdes.html#fig:wave2">6.7</a>. Your plots may look different given the oscillation period and the initial condition.
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:wave1"></span>
<img src="images/Ch06_WaveTimeEvolution1.png" alt="Time evolution of a solution to the wave equation." width="95%" />
<p class="caption">
Figure 6.6: Time evolution of a solution to the wave equation.
</p>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:wave2"></span>
<img src="images/Ch06_WaveTimeEvolution2.png" alt="3D plot of the time evolution of a solution to the wave equation." width="95%" />
<p class="caption">
Figure 6.7: 3D plot of the time evolution of a solution to the wave equation.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-566" class="exercise"><strong>Exercise 6.21  </strong></span>If <span class="math inline">\(u_0(t,x)\)</span> and <span class="math inline">\(u_1(t,x)\)</span> are both solutions the wave equation <span class="math inline">\(u_{tt} = c u_{xx}\)</span> matching boundary conditions <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span>, then is a linear combination of <span class="math inline">\(u_0\)</span> and <span class="math inline">\(u_1\)</span> also a solution that matches the particular boundary conditions?
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-567" class="exercise"><strong>Exercise 6.22  </strong></span>Consider the wave equation <span class="math inline">\(u_{tt} = c ( u_{xx} + u_{yy})\)</span> where <span class="math inline">\(u(x,y,t)\)</span> is the height (in centimeters) of a wave at time <span class="math inline">\(t\)</span> in seconds and spatial location <span class="math inline">\((x,y)\)</span> (each in centimeters).</p>
<ol style="list-style-type: lower-alpha">
<li>What are the units of the constant <span class="math inline">\(c\)</span>?</li>
<li>For each of the following functions, test whether it is an analytical solution to this PDE by substituting the derivatives into the equation. If <span class="math inline">\(c = 2\)</span>, which of these functions is a solution?
<ol style="list-style-type: lower-roman">
<li><span class="math inline">\(u(t,x,y) = 3x + 2y + 5 t - 6\)</span></li>
<li><span class="math inline">\(u(t,x,y) = 3x^2 + 2y^2 + 5 t^2 - 6\)</span></li>
<li><span class="math inline">\(u(t,x,y) = \sin( 2 x) + \cos(3 y) + \sin(4t)\)</span></li>
<li><span class="math inline">\(u(t,x,y) = \sin( 2 x) \cos(3 y) \sin(4t)\)</span></li>
<li><span class="math inline">\(u(t,x,y) = \sin(3 x) \cos(4 y) \sin(10t)\)</span></li>
<li><span class="math inline">\(u(t,x,y) = -6\sin( 3 x) \cos(4 y) \sin(10t)+2x -3y+9-12\)</span></li>
<li><span class="math inline">\(u(t,x,y) = \cos(7 x) \cos(3 y) \cos(12t)\)</span></li>
<li><span class="math inline">\(u(t,x,y) = \cos(5 x) \sin(12 y) \cos(13\sqrt{2}t)\)</span></li>
</ol></li>
<li>Make plots of the time evolution of the solutions from part (b). What phenomena do you observe in the plots?</li>
</ol>
</div>
<hr />

<div class="theorem">
<span id="thm:unnamed-chunk-568" class="theorem"><strong>Theorem 6.3  </strong></span>If the function <span class="math inline">\(u(t,x,y)\)</span> solves the 2D wave equation <span class="math inline">\(u_{tt} = c \left( u_{xx} + u_{yy} \right)\)</span> then <span class="math inline">\(u(t,x,y)\)</span> likely has the functional form
<span class="math display">\[u(t,x,y) = \underline{\hspace{2in}}.\]</span>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-569" class="exercise"><strong>Exercise 6.23  </strong></span>Prove your hypotheses from the previous theorem.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-570" class="exercise"><strong>Exercise 6.24  </strong></span>Propose a solution to the wave equation <span class="math inline">\(u_{tt} = c u_{xx}\)</span> where <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u_x(t,1)=0\)</span>.
</div>
<hr />
<p>At this point we have only examined two PDEs, the heat and wave equations, and have proposed possible forms of the analytic solutions. These two particular PDEs have nice analytic solutions in terms of exponential and trigonometric functions so it isn’t terribly challenging to <em>guess</em> at the proper functional forms of the solutions. However, if we were to change the initial conditions, boundary conditions, or the differential equation by just a bit it may be more challenging to propose analytic solutions. It is not the purpose of this chapter to give a complete treatment of the analytic solutions to PDEs (not even the heat or wave equations). The purpose of what we just did was to build some intuition about the types of behaviors that we should expect from these prototypical PDEs. This way we will be able to determine if our numerical solutions in future sections are reasonable or not.</p>
<div style="page-break-after: always;"></div>
</div>
<div id="boundary-conditions" class="section level2" number="6.3">
<h2><span class="header-section-number">6.3</span> Boundary Conditions</h2>
<p>When we were solving ODEs we typically needed initial conditions to tell us where the solutions starts at time <span class="math inline">\(t=0\)</span>. Since PDEs require both spatial and temporal information we need to tell the differential equation how to behave both at time zero AND on the boundaries of the domain.</p>
<hr />

<div class="definition">
<p><span id="def:unnamed-chunk-571" class="definition"><strong>Definition 6.2  </strong></span>Let’s say that we want to solve a PDE with variable <span class="math inline">\(t\)</span> and <span class="math inline">\(x\)</span> on the domain <span class="math inline">\(x \in [0,1]\)</span>.</p>
<ul>
<li>The <strong>initial condition</strong> is a function <span class="math inline">\(f(x)\)</span> where <span class="math inline">\(u(0,x) = f(x)\)</span>. In other words, we are dictating the value of <span class="math inline">\(u\)</span> at every point <span class="math inline">\(x\)</span> at time <span class="math inline">\(t=0\)</span>.</li>
<li>The boundary conditions are restrictions for how the solution behaves at <span class="math inline">\(x=0\)</span> and <span class="math inline">\(x=1\)</span> (for this problem).
<ul>
<li>If the value of the solution <span class="math inline">\(u\)</span> at the boundary is either a fixed value or a fixed function of time then we call the boundary condition a <strong>Dirichlet boundary condition.</strong> For example, <span class="math inline">\(u(t,0) = 1\)</span> and <span class="math inline">\(u(t,1) = 5\)</span> are Dirichlet boundary conditions for this domain. Similarly, the conditions <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u(t,1) = \sin(100\pi t)\)</span> are also Dirichlet boundary conditions. Dirichlet boundary conditions give the exact value of <span class="math inline">\(u\)</span> the the boundary points.</li>
<li>If the value of the solution <span class="math inline">\(u\)</span> depends on the flux of <span class="math inline">\(u\)</span> at the boundary then we call the boundary condition a <strong>Neumann boundary condition.</strong> For example, <span class="math inline">\(\frac{\partial u}{\partial x}(t,0) = 0\)</span> and <span class="math inline">\(\frac{\partial u}{\partial x}(t,1) = 0\)</span> are Neumann boundary conditions. They state that the flux of <span class="math inline">\(u\)</span> is fixed at the boundaries.</li>
</ul></li>
</ul>
</div>
<hr />
<p>Let’s play with a couple problems that should help to build your intuition about boundary conditions in PDEs. Again, we will do this graphically instead of numerically.</p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-572" class="exercise"><strong>Exercise 6.25  </strong></span>Consider solving the heat equation <span class="math inline">\(u_t = D u_{xx}\)</span> in 1 spatial dimension.</p>
<ol style="list-style-type: lower-alpha">
<li>If a long thin metal rod is initially heated in the middle and the temperature at the ends of the rod is held fixed at 0 then the heat diffusion is described by the heat equation. What type of boundary conditions do we have in this setup? How can you tell? Draw a picture showing the expected evolution of the heat equation with these boundary conditions.</li>
<li>What if we take the initial condition for the 1D heat equation to be <span class="math inline">\(u(0,x) = \cos(2\pi x)\)</span> and enforce the conditions <span class="math inline">\(\frac{\partial u}{\partial x}\Big|_{x=0} = 0\)</span> and <span class="math inline">\(u(t,1) = 1\)</span>. What types of boundary conditions are these? Draw a collection of pictures showing the expected evolution of the heat equation with these boundary conditions.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-573" class="exercise"><strong>Exercise 6.26  </strong></span>Consider solving the wave equation <span class="math inline">\(u_{tt} = c u_{xx}\)</span> in 1 spatial dimension.</p>
<ol style="list-style-type: lower-alpha">
<li>If a guitar string is pulled up in the center and held fixed at the frets then the resulting vibrations of the string are described by the wave equation. What type of boundary conditions do we have in this setup? How can you tell? Draw a picture showing the expected evolution of the heat equation with these boundary conditions.</li>
<li>What if we take the initial condition for the 1D wave equation to be <span class="math inline">\(u(0,x) = \cos(2\pi x)\)</span> and enforce the conditions <span class="math inline">\(\frac{\partial u}{\partial x}\Big|_{x=0} = 0\)</span> and <span class="math inline">\(u(t,1) = 1\)</span>. What types of boundary conditions are these? Draw a collection of pictures showing the expected evolution of the wave equation with these boundary conditions.</li>
</ol>
</div>
<hr />
<p>The next two problems should help you to understand some of the basic scenarios that we might wish to solve with the heat and wave equation.</p>

<div class="exercise">
<p><span id="exr:unnamed-chunk-574" class="exercise"><strong>Exercise 6.27  </strong></span>For each of the following situations propose meaningful boundary conditions for the 1D or 2D heat equation.</p>
<ol style="list-style-type: lower-alpha">
<li>A thin metal rod 1 meter long is heated to <span class="math inline">\(100^\circ\)</span>C on the left end and is cooled to <span class="math inline">\(0^\circ\)</span>C on the right end. We model the heat transport with the 1D heat equation <span class="math inline">\(u_t = Du_{xx}\)</span>. What are the appropriate boundary and initial conditions?</li>
<li>A thin metal rod 1 meter long is insulated on the left end so that the heat flux through that end is 0. The rod is held at a constant temperature of <span class="math inline">\(50^\circ\)</span>C on the right end. We model the heat transport with the 1D heat equation <span class="math inline">\(u_t = D u_{xx}\)</span>. What are the appropriate boundary conditions?</li>
<li>In a soil-science lab a column of packed soil is insulated on the sides and cooled to <span class="math inline">\(20^\circ\)</span>C at the bottom. The top of the column is exposed to a heat lamp that cycles periodically between <span class="math inline">\(15^\circ\)</span>C and <span class="math inline">\(25^\circ\)</span>C and is supposed to mimic the heating and cooling that occurs during a day due to the sun. We model the heat transport within the column with the 1D heat equation <span class="math inline">\(u_t = D u_{xx}\)</span>. What are the appropriate boundary conditions?</li>
<li>A thin rectangular slab of concrete is being designed for a sidewalk. Imagine the slab as viewed from above. We expect the right-hand side to be heated to <span class="math inline">\(50^\circ\)</span>C due to radiant heating from the road and the left-hand side to be cooled to approximately <span class="math inline">\(20^\circ\)</span>C due to proximity to a grassy hillside. The top and bottom of the slab are insulated with a felt mat so that the flux of heat through both ends is zero. We model the heat transport with the 2D heat equation <span class="math inline">\(u_t = D(u_{xx} + u_{yy})\)</span>. What are the appropriate boundary conditions?</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-575" class="exercise"><strong>Exercise 6.28  </strong></span>For each of the following situations propose meaningful boundary conditions for the 1D and 2D wave equation.</p>
<ol style="list-style-type: lower-alpha">
<li>A guitar string is held tight at both ends and plucked in the middle. We model the vibration of the guitar string with the 1D wave equation <span class="math inline">\(u_{tt} = c u_{xx}\)</span>. What are the appropriate boundary conditions?</li>
<li>A rope is stretched between two people. The person on the left holds the rope tight and doesn’t move. The person on the right wiggles the rope in a periodic fashion completing one full oscillation per second. We model the waves in the rope with the 1D wave equation <span class="math inline">\(u_{tt} = c u_{xx}\)</span>. What are the appropriate boundary conditions?</li>
<li>A rubber membrane is stretched taught on a rectangular frame. The frame is held completely rigid while the membrane is stretched from equilibrium and then released. We model the vibrations in the membrane with the 2D wave equation <span class="math inline">\(u_{tt} = c (u_{xx} + u_{yy})\)</span>. What are the appropriate boundary conditions?</li>
</ol>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="the-heat-equation" class="section level2" number="6.4">
<h2><span class="header-section-number">6.4</span> The Heat Equation</h2>
<p>Thus far in this chapter we have supplied you with the PDEs and then we have built solutions, plots, initial conditions, and boundary conditions based on intuition and some knowledge of Calculus. Before going any further, however, we should give a clear derivation for where the heat equation comes from. For the sake of brevity (and simpler algebra) we will just give a derivation for the 1D heat equation. The 2D and 3D derivations are all quite similar.</p>
<p>The heat equation is also often called the <em>diffusion equation</em> since it models the diffusion (spreading out) of all sorts of things – e.g. heat, the density of molecules in a gos, the concentration of solute in a solvent. Let’s say that the density of some gas is distributed somehow along a line segment. If we divide the line segment into discrete adjacent intervals then random molecular motion would dictate that in a small discrete time steps half of the density in interval <span class="math inline">\(n\)</span> would move to the interval to the right, and half of the density would move to the interval to the left. Of course this assumption is only valid if the intervals are small enough so as to capture the distance that a bumped molecule will move in the time step. Mathematically we can express this simple assumptions of random molecular motion as
<span class="math display">\[\underbrace{u(t_{k+1},x_n) - u(t_k,x_n)}_{\text{change in density in interval n}} = \underbrace{\frac{1}{2} u(t_k,x_{n+1})}_{\text{in from the right}} - \underbrace{\frac{1}{2} u(t_k,x_n)}_{\text{out to the right}} + \underbrace{\frac{1}{2}u(t_k,x_{n-1})}_{\text{in from the left}} - \underbrace{\frac{1}{2}u(t_k,x_n)}_{\text{out to the left}} .\]</span></p>
<p>Rearranging we can write the previous equation as
<span class="math display">\[u(t_{k+1},x_n) - u(t_k,x_n) = \frac{1}{2} \left( u(t_k,x_{n+1}) - 2 u(t_k,x_n) + u(t_k,x_{n-1}) \right).\]</span>
We have seen enough discrete approximations of derivatives now that the next step should seem obvious (hopefully)! If we divide the left-hand side by <span class="math inline">\(\Delta t\)</span> then it appears to be a discrete approximation of a time derivative. If we divide the right-hand side by <span class="math inline">\(\Delta x^2\)</span> then it appears to be the discrete approximation of a second derivative in space. Of course we need to do our algebra correctly so we end up with the equation
<span class="math display">\[\frac{u(t_{k+1},x_n) - u(t_k,x_n)}{\Delta t} = \frac{\Delta x^2}{2\Delta t} \left( \frac{u(t_k,x_{n+1}) - 2 u(t_k,x_n) + u(t_k,x_{n-1})}{\Delta x^2} \right).\]</span></p>
<p>Finally, if we take the limits as the time step, <span class="math inline">\(\Delta t\)</span>, and the length of the spatial intervals, <span class="math inline">\(\Delta x\)</span>, get arbirarily small we get
<span class="math display">\[\frac{\partial u}{\partial t} = D \frac{\partial^2 u}{\partial x^2}\]</span>
where we have combined the coefficients on the right-hand side into the diffusion coefficient <span class="math inline">\(D\)</span>.</p>
<p>If there was a mechanism forcing density into each of the small intervals then we would end up with the forced heat equation
<span class="math display">\[\frac{\partial u}{\partial t} = D \frac{\partial^2 u}{\partial x^2} + f(x).\]</span>
where the function <span class="math inline">\(f(x)\)</span> would model exactly how the density is being forced into each spatial point <span class="math inline">\(x\)</span>. We’ll let <span class="math inline">\(f(x) = 0\)</span> for the majority of this section for simplicity, but you can modify any of the code that you write in this section to include a forcing term.</p>
<p>Derivations of the 2D and 3D diffusion equations are very similar. You should stop now and at least work out the details of the 2D heat equation.</p>
<p>In the remainder of this section we’ll use a technique called <strong>the finite difference method</strong> to build numerical approximations to solutions of the heat equation in 1D, 2D, and 3D.</p>
<p>For the sake of simplicity we will start by considering the time dependent heat equation in 1 spatial dimension with no external forcing function
<span class="math display">\[ \frac{\partial u}{\partial t} = D \frac{\partial^2 u}{\partial x^2}. \]</span>
The constant <span class="math inline">\(D\)</span> is the called the diffusivity (the rate of diffusion) so in terms of physical problems, if <span class="math inline">\(D\)</span> is small then the diffusion occurs slowly and if <span class="math inline">\(D\)</span> is large then the diffusion occurs quickly. Just as we did in Chapter <a href="ch-calculus.html#ch-calculus">3</a> to approximate derivatives and integrals numerically, and also in Chapter <a href="ch-odes.html#ch-odes">5</a> to approximate solutions to ODEs, we will start by partitioning the domain into finitely many pieces and we will partition time into finitely many pieces.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-576" class="exercise"><strong>Exercise 6.29  </strong></span>In 1 spatial dimension, the heat equation is simply <span class="math display">\[u_t = D u_{xx}.\]</span> We want to build a numerical approximation to the function <span class="math inline">\(u(t,x)\)</span> for a given collection of initial and boundary conditions.</p>
<p>First we need to introduce some notation for the numerical solution. As you’ll see in a moment, there is a lot to keep track of in numerical PDEs so careful index and well-chosen notation is essential. Let <span class="math inline">\(U_i^n\)</span> be the approximation of the solution to <span class="math inline">\(u(t,x)\)</span> at the point <span class="math inline">\(t=t_n\)</span> and <span class="math inline">\(x=x_i\)</span> (since we have two variables we need to two indices). For example, <span class="math inline">\(U_4^1\)</span> is the value of the approximation at time <span class="math inline">\(t_1\)</span> and at the spatial point <span class="math inline">\(x_4\)</span>.</p>
<p>Next we need to approximate both derivatives <span class="math inline">\(u_t\)</span> and <span class="math inline">\(u_{xx}\)</span> in the PDE using methods that we have used before. Now would be a good time to go back to Chapter <a href="ch-calculus.html#ch-calculus">3</a> and refresh your memory for how we build approximations of derivatives.</p>
<ol style="list-style-type: lower-alpha">
<li>Give an approximation of <span class="math inline">\(u_t\)</span> similar to Euler’s method
<span class="math display">\[ u_t \approx \frac{??? - ???}{???}. \]</span></li>
<li>Give an approximation of <span class="math inline">\(u_{xx}\)</span> using the approximation for the second derivative from Chapter <a href="ch-calculus.html#ch-calculus">3</a>
<span class="math display">\[ u_{xx} \approx \frac{??? - ??? + ???}{???}. \]</span></li>
<li>Put your answers from parts (a) and (b) together using the 1D heat equation
<span class="math display">\[\frac{??? - ???}{\Delta t} = D \left( \frac{??? - ??? + ???}{\Delta x^2} \right).\]</span>
Be sure that your indexing is correct: the superscript <span class="math inline">\(n\)</span> is the index for time and the subscript <span class="math inline">\(i\)</span> is the index for space.</li>
<li>Rearrange your result from part (c) to solve for <span class="math inline">\(U_i^{n+1}\)</span>:
<span class="math display">\[\begin{aligned}
     U_i^{n+1} = ??? + \frac{D \Delta t}{\Delta x^2} \left( ??? - ??? + ??? \right). 
\end{aligned}\]</span>
The iterative scheme which you just derived is called a <strong>finite difference scheme</strong> for the heat equation. Notice that the term on the left is the only term at the next time step <span class="math inline">\(n+1\)</span>. So, for every spatial point <span class="math inline">\(x_i\)</span> we can build <span class="math inline">\(U_i^{n+1}\)</span> by evaluating the right-hand side of the finite difference scheme.</li>
<li>What is the expected order of the error for the approximation of the time derivative in the finite difference scheme from part (d)?</li>
<li>What is the expected order of the error for the approximation of the spatial second derivative in the finite difference scheme from part (d)?</li>
<li>The numerical errors made by using the finite difference scheme we just built come from two sources: from the approximation of the time derivative and from the approximation of the second spatial derivative. The total error is the sum of the two errors. Fill in the question marks in the powers of the following expression:
<span class="math display">\[ \text{Numerical Error} = \mathcal{O}(\Delta t^{???}) + \mathcal{O}(\Delta x^{???}). \]</span></li>
<li>Explain what the result from part (g) means in plain English?</li>
</ol>
</div>
<hr />
<p>There are many different finite difference schemes due to the fact that there are many different ways to approximate derivatives (See Chapter <a href="ch-calculus.html#ch-calculus">3</a>). One convenient way to keep track of which information you are using and what you are calculating in a finite difference scheme is to use a <strong>finite difference stencil image</strong>. Figure <a href="ch-pdes.html#fig:heat-stencil">6.8</a> shows the finite difference stencil for the approximation to the heat equation that you built in the previous exercise. In this figure we are showing that the function values <span class="math inline">\(U_{i-1}^n\)</span>, <span class="math inline">\(U_i^n\)</span>, and <span class="math inline">\(U_{i+1}^n\)</span> at the points <span class="math inline">\(x_{i-1}\)</span>, <span class="math inline">\(x_i\)</span>, and <span class="math inline">\(x_{i+1}\)</span> are being used at time step <span class="math inline">\(t_n\)</span> to calculate <span class="math inline">\(U_i^{n+1}\)</span>. We will build similar stencil diagrams for other finite difference schemes throughout this chapter.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:heat-stencil"></span>
<img src="images/Ch06_HeatStencil.png" alt="The finite difference stencil for the 1D heat equation." width="75%" />
<p class="caption">
Figure 6.8: The finite difference stencil for the 1D heat equation.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-577" class="exercise"><strong>Exercise 6.30  </strong></span>Now we want to implement your answer to part (d) of the previous exercise to approximate the solution to the
following problem:
<span class="math display">\[\text{Solve: } u_t = 0.5u_{xx}\]</span>
with
<span class="math display">\[ x \in (0,1), \, u(0,x) = \sin(2 \pi x), \, u(t,0) = 0, \, \text{and} \, u(t,1) = 0.\]</span>
Some partial code is given below to get you started.
</div>
<ul>
<li>First we import the proper libraries, set up the time domain, and set up the spatial domain.</li>
</ul>
<div class="sourceCode" id="cb104"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb104-1"><a href="ch-pdes.html#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb104-2"><a href="ch-pdes.html#cb104-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb104-3"><a href="ch-pdes.html#cb104-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interactive</span>
<span id="cb104-4"><a href="ch-pdes.html#cb104-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-5"><a href="ch-pdes.html#cb104-5" aria-hidden="true" tabindex="-1"></a><span class="co"># Write code to give an array of times starting at t=0 and ending </span></span>
<span id="cb104-6"><a href="ch-pdes.html#cb104-6" aria-hidden="true" tabindex="-1"></a><span class="co"># at t=1.  Be sure that you use many points in the partition of </span></span>
<span id="cb104-7"><a href="ch-pdes.html#cb104-7" aria-hidden="true" tabindex="-1"></a><span class="co"># the time domain.  Be sure to either specify or calculate the </span></span>
<span id="cb104-8"><a href="ch-pdes.html#cb104-8" aria-hidden="true" tabindex="-1"></a><span class="co"># value of Delta t.</span></span>
<span id="cb104-9"><a href="ch-pdes.html#cb104-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-10"><a href="ch-pdes.html#cb104-10" aria-hidden="true" tabindex="-1"></a><span class="co"># Write code to give an array of x values starting at x=0 and </span></span>
<span id="cb104-11"><a href="ch-pdes.html#cb104-11" aria-hidden="true" tabindex="-1"></a><span class="co"># ending exactly at x=1. This is best done with the np.linspace() </span></span>
<span id="cb104-12"><a href="ch-pdes.html#cb104-12" aria-hidden="true" tabindex="-1"></a><span class="co"># command since you can guarantee that you end exactly at x=1.  </span></span>
<span id="cb104-13"><a href="ch-pdes.html#cb104-13" aria-hidden="true" tabindex="-1"></a><span class="co"># Be sure to either specify or calculate the value of Delta x as</span></span>
<span id="cb104-14"><a href="ch-pdes.html#cb104-14" aria-hidden="true" tabindex="-1"></a><span class="co"># part of your code. </span></span>
<span id="cb104-15"><a href="ch-pdes.html#cb104-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb104-16"><a href="ch-pdes.html#cb104-16" aria-hidden="true" tabindex="-1"></a><span class="co"># The next two lines build two parameters that are of interest </span></span>
<span id="cb104-17"><a href="ch-pdes.html#cb104-17" aria-hidden="true" tabindex="-1"></a><span class="co"># for the finite difference scheme.</span></span>
<span id="cb104-18"><a href="ch-pdes.html#cb104-18" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> <span class="fl">0.5</span> <span class="co"># The diffusion coefficient for the heat equation given.</span></span>
<span id="cb104-19"><a href="ch-pdes.html#cb104-19" aria-hidden="true" tabindex="-1"></a><span class="co"># The coefficient &quot;a&quot; appears in the finite difference scheme.</span></span>
<span id="cb104-20"><a href="ch-pdes.html#cb104-20" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> D<span class="op">*</span>dt <span class="op">/</span> dx<span class="op">**</span><span class="dv">2</span> </span>
<span id="cb104-21"><a href="ch-pdes.html#cb104-21" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">&quot;dt=&quot;</span>,dt,<span class="st">&quot;, dx=&quot;</span>,dx,<span class="st">&quot; and D dt/dx^2=&quot;</span>,a)</span></code></pre></div>
<ul>
<li>Next we build the array <span class="math inline">\(U\)</span> so we can store all of the approximations at all times and at all spatial points. The array will have the dimensions <code>len(t)</code> versus <code>len(x)</code>. We then need to enforce the boundary conditions so for all times we fill the proper portions of the array with the proper boundary conditions. Lastly, we will build the initial condition for all spatial steps in the first time step.</li>
</ul>
<div class="sourceCode" id="cb105"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb105-1"><a href="ch-pdes.html#cb105-1" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> np.zeros( (<span class="bu">len</span>(t),<span class="bu">len</span>(x)) )</span>
<span id="cb105-2"><a href="ch-pdes.html#cb105-2" aria-hidden="true" tabindex="-1"></a>U[:,<span class="dv">0</span>] <span class="op">=</span> <span class="co"># left boundary condition</span></span>
<span id="cb105-3"><a href="ch-pdes.html#cb105-3" aria-hidden="true" tabindex="-1"></a>U[:,<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="co"># right boundary condition</span></span>
<span id="cb105-4"><a href="ch-pdes.html#cb105-4" aria-hidden="true" tabindex="-1"></a>U[<span class="dv">0</span>,:] <span class="op">=</span> <span class="co"># the function for the init. condition (should depend on x)</span></span></code></pre></div>
<ul>
<li>Now we step through a loop that fills the <span class="math inline">\(U\)</span> array one row at a time. Keep in mind that we want to leave the boundary conditions fixed so we will only fill indices <code>1</code> through <code>-2</code> (stop and explain this). Be careful to get the indexing correct. For example, if we want <span class="math inline">\(U_i^n\)</span> we use <code>U[n,1:-1]</code>, if we want <span class="math inline">\(U_{i+1}^n\)</span> we use <code>U[n,2:]</code>, if we want <span class="math inline">\(U_i^{n+1}\)</span> we use <code>U[n+1,1:-1]</code>, etc.</li>
</ul>
<div class="sourceCode" id="cb106"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb106-1"><a href="ch-pdes.html#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb106-2"><a href="ch-pdes.html#cb106-2" aria-hidden="true" tabindex="-1"></a>    U[n<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> U[n,?:?] <span class="op">+</span> a<span class="op">*</span>( U[n,?:] <span class="op">-</span> <span class="dv">2</span><span class="op">*</span>U[n,?:?] <span class="op">+</span> U[n,:?])</span></code></pre></div>
<ul>
<li>It remains to plot the solutions. One way to do this is with the <code>ipywidgets.interactive</code> tool. We first need to create a function which returns a plot at a particular time step. Then we call the function inside the <code>interactive</code> function. You could also use the <code>matplotlib.animation</code> function if you wish.</li>
</ul>
<div class="sourceCode" id="cb107"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb107-1"><a href="ch-pdes.html#cb107-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotter(Frame):</span>
<span id="cb107-2"><a href="ch-pdes.html#cb107-2" aria-hidden="true" tabindex="-1"></a>    plt.plot(x,U[Frame,:],<span class="st">&#39;b&#39;</span>)</span>
<span id="cb107-3"><a href="ch-pdes.html#cb107-3" aria-hidden="true" tabindex="-1"></a>    plt.grid()</span>
<span id="cb107-4"><a href="ch-pdes.html#cb107-4" aria-hidden="true" tabindex="-1"></a>    plt.ylim(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb107-5"><a href="ch-pdes.html#cb107-5" aria-hidden="true" tabindex="-1"></a>    plt.show()</span>
<span id="cb107-6"><a href="ch-pdes.html#cb107-6" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="op">=</span> interactive(plotter, Frame<span class="op">=</span>(<span class="dv">0</span>,<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>))</span>
<span id="cb107-7"><a href="ch-pdes.html#cb107-7" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code></pre></div>
<p>Note: If you don’t want to do an interactive plot then you can produce several snapshots of the solutions with the following code.</p>
<div class="sourceCode" id="cb108"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb108-1"><a href="ch-pdes.html#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> Frame <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(t),<span class="dv">20</span>): <span class="co"># ex: build every 20th frame</span></span>
<span id="cb108-2"><a href="ch-pdes.html#cb108-2" aria-hidden="true" tabindex="-1"></a>    plotter(Frame)</span></code></pre></div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-583" class="exercise"><strong>Exercise 6.31  </strong></span>You may have found that you didn’t get a sensible solution out for the previous problem. The point of this exercise is to show that value of <span class="math inline">\(a = D\frac{\Delta t}{\Delta x^2}\)</span> controls the stability of the finite difference solution to the heat equation, and furthermore that there is a cutoff for <span class="math inline">\(a\)</span> below which the finite difference scheme will be stable. Experiment with values of <span class="math inline">\(\Delta t\)</span> and <span class="math inline">\(\Delta x\)</span> and conjecture the values of <span class="math inline">\(a = D \frac{\Delta t}{\Delta x^2}\)</span> that give a stable result. Your conjecture should take the form:</p>
<p><em>If <span class="math inline">\(a = D\frac{\Delta t}{\Delta x^2} &lt; \underline{\hspace{0.5in}}\)</span> then the finite difference solution for the 1D heat equation is stable. Otherwise it is unstable</em>.</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-584" class="exercise"><strong>Exercise 6.32  </strong></span>Consider the one dimensional heat equation with diffusion coefficient <span class="math inline">\(D=1\)</span>:
<span class="math display">\[ u_t = u_{xx}. \]</span>
We want to solve this equation on the domain <span class="math inline">\(x \in (0,1)\)</span> and <span class="math inline">\(t\in (0,0.5)\)</span> subject to the initial condition <span class="math inline">\(u(0,x) = \sin(\pi x)\)</span> and the boundary conditions <span class="math inline">\(u(t,0)=u(t,1) = 0\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Prove that the function <span class="math inline">\(u(t,x) = e^{-\pi^2 t} \sin(\pi x)\)</span> is a solution to this heat equation, satisfies the initial condition, and satisfies the boundary conditions.<br />
</li>
<li>Pick values of <span class="math inline">\(\Delta t\)</span> and <span class="math inline">\(\Delta x\)</span> so that you can get a stable finite difference solution to this heat equation. Plot your results on top of the analytic solution from part (a).</li>
<li>Now let’s change the initial condition to <span class="math inline">\(u(0,x)=\sin(\pi x) + 0.1\sin(100 \pi x)\)</span>. Prove that the function <span class="math inline">\(u(t,x) = e^{-\pi^2 t} \sin(\pi x) + 0.1 e^{-10^4\pi^2t}\sin(100\pi x)\)</span> is a solution to this heat equation, matches this new initial condition, and matches the boundary conditions.</li>
<li>Pick values of <span class="math inline">\(\Delta t\)</span> and <span class="math inline">\(\Delta x\)</span> so that you can get a stable finite difference solution to this heat equation. Plot your results on top of the analytic solution from part (c).</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-585" class="exercise"><strong>Exercise 6.33  </strong></span>In any initial and boundary value problem such as the heat equation, the boundary values can either be classified as Dirichlet or Neumann type. In Dirichlet boundary conditions the values of the solution at the boundary are dictated specifically. So far we have only solved the heat equation with Dirichlet boundary conditions. In contrast, Neumann boundary conditions dictate the flux at the boundary instead of the value of the solution. Consider the 1D heat equation <span class="math inline">\(u_t = u_{xx}\)</span> with boundary conditions <span class="math inline">\(u_x(t,0)=0\)</span> and <span class="math inline">\(u(t,1)=0\)</span> with initial condition <span class="math inline">\(u(0,x) = \cos(\pi x/2)\)</span>. Notice that the initial condition satisfies both boundary conditions: <span class="math inline">\(\frac{d}{dx}(\cos(\pi \cdot x/2))\Big|_{x=0} = 0\)</span> and <span class="math inline">\(\cos(\pi \cdot 1/2)=0\)</span>. As the heat profile evolves in time the Neumann boundary condition <span class="math inline">\(u_x(t,0)=0\)</span> says that the slope of the solution needs to be fixed at 0 at the left-hand boundary.</p>
<ol style="list-style-type: lower-alpha">
<li>Draw several images of what the solution to the PDE should look like as time evolves. Be sure that all boundary conditions are satisfied and that your solution appears to solve the heat equation.</li>
<li>The Neumann boundary condition <span class="math inline">\(u_x(t,0) = 0\)</span> can be approximated with the first order approximation
<span class="math display">\[ u_x(t_n,0) \approx \frac{U_1^n - U_0^n}{\Delta x}. \]</span>
If we set this approximation to 0 (since <span class="math inline">\(u_x(t,0)=0\)</span>) and solve for <span class="math inline">\(U_0^n\)</span> we get an additional constraint at every time step of the numerical solution to the heat equation. What is this new equation.</li>
<li>Modify your 1D heat equation code to implement this Neumann boundary condition. Give plots that demonstrate that the Neumann boundary is indeed satisfied.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-586" class="exercise"><strong>Exercise 6.34  </strong></span>Modify your 1D heat equation code to solve the following problems. For each be sure to classify the type of boundary conditions given. Notice that we are now using initial and boundary conditions where it would be quite challenging to built the analytic solution so we will only show numerical solutions. Be sure that you choose <span class="math inline">\(\Delta t\)</span> and <span class="math inline">\(\Delta x\)</span> so that your solution is stable.</p>
<ol style="list-style-type: lower-alpha">
<li>Solve <span class="math inline">\(u_t = 0.5 u_{xx}\)</span> with <span class="math inline">\(x \in (0,1)\)</span>, <span class="math inline">\(u(0,x) = x^2\)</span>, <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u(t,1) = 1\)</span>.</li>
<li>Solve <span class="math inline">\(u_t = 0.5 u_{xx}\)</span> with <span class="math inline">\(x \in (0,1)\)</span>, <span class="math inline">\(u(0,x) = 1-\cos(\pi x/2)\)</span>, <span class="math inline">\(u_x(t,0) = 0\)</span> and <span class="math inline">\(u(t,1) = 1\)</span>.</li>
<li>Solve <span class="math inline">\(u_t = 0.5 u_{xx}\)</span> with <span class="math inline">\(x \in (0,1)\)</span>, <span class="math inline">\(u(0,x) = \sin(2\pi x)\)</span>, <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u(t,1) = \sin(5\pi t)\)</span>.</li>
<li>Solve <span class="math inline">\(u_t = 0.5 u_{xx}+x^2/100\)</span> with <span class="math inline">\(x \in (0,1)\)</span>, <span class="math inline">\(u(0,x) = \sin(2\pi x)\)</span>, <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u(t,1) = 0\)</span>.</li>
</ol>
</div>
<hr />
<p>Now we transition to the two dimensional heat equation. Instead of thinking of this as heating a long metal rod we can think of heating a thin plate of metal (like a flat cookie sheet). The heat equation models the propagation of the heat energy throughout the 2D surface. In two spatial dimensions the heat equation is
<span class="math display">\[ \frac{\partial u}{\partial t} = D \left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} \right) \]</span>
or using subscript notation for the partial derivatives,
<span class="math display">\[ u_t = D\left( u_{xx} + u_{yy} \right). \]</span></p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-587" class="exercise"><strong>Exercise 6.35  </strong></span>Let’s build a numerical solution to the 2D heat equation. We need to make a minor modification to our notation since there is now one more spatial dimension to keep track of. Let <span class="math inline">\(U_{i,j}^n\)</span> be the approximation to <span class="math inline">\(u\)</span> at the point <span class="math inline">\((t_n, x_i, y_j)\)</span>. For example, <span class="math inline">\(U_{2,3}^4\)</span> will be the approximation to the solution at the point <span class="math inline">\((t_4,x_2,y_3)\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>We already know how to approximate the time derivative in the heat equation:
<span class="math display">\[ u_t(t_{n+1}, x_i, y_j) \approx \frac{U_{i,j}^{n+1} - U_{i,j}^n}{\Delta t}. \]</span>
The new challenge now is that we have two spatial partial derivatives: one in <span class="math inline">\(x\)</span> and one in <span class="math inline">\(y\)</span>. Use what you learned in Chapter <a href="ch-calculus.html#ch-calculus">3</a> to write the approximations of <span class="math inline">\(u_{xx}\)</span> and <span class="math inline">\(u_{yy}\)</span>.
<span class="math display">\[ u_{xx}(t_n,x_i,y_j) \approx \frac{??? - ??? + ???}{\Delta x^2} \]</span>
<span class="math display">\[ u_{yy}(t_n,x_i,y_j) \approx \frac{??? - ??? + ???}{\Delta y^2} \]</span>
Take careful note that the index <span class="math inline">\(i\)</span> is the only one that changes for the <span class="math inline">\(x\)</span> derivative. Similarly, the index <span class="math inline">\(j\)</span> is the only one that changes for the <span class="math inline">\(y\)</span> derivative.</li>
<li>Put your answers to part (a) together with the 2D heat equation
<span class="math display">\[ \frac{U_{i,j}^{n+1} - U_{i,j}^n}{\Delta t} = D \left( \frac{??? - ??? + ???}{\Delta x^2} + \frac{??? - ??? + ???}{\Delta y^2} \right). \]</span></li>
<li>Let’s make one simplifying assumption. Choose the partition of the domain so that <span class="math inline">\(\Delta x = \Delta y\)</span>. Note that we can usually do this in square domains. In more complicated domains we will need to be more careful. Simplify the right-hand side of your answer to part (b) under this assumption.
<span class="math display">\[ \frac{U_{i,j}^{n+1} - U_{i,j}^n}{\Delta t} = D \left( \frac{??? + ??? - ??? + ??? + ???}{???} \right). \]</span></li>
<li>Now solve your result from part (c) for <span class="math inline">\(U_{i,j}^{n+1}\)</span>. Your answer is the explicit finite differene scheme for the 2D heat equation.
<span class="math display">\[ U_{i,j}^{n+1} = U_{???,???}^{???} + \frac{D \cdot ???}{???} \left( ??? + ??? - ??? + ??? + ??? \right) \]</span></li>
</ol>
</div>
<hr />
<p>The finite difference stencil for the 2D heat equation is a bit more complicated since we now have three indices to track. Hence, the stencil is naturally three dimensional. Figure <a href="ch-pdes.html#fig:heat-stencil-2">6.9</a> shows the stencil for the finite difference scheme that we built in the previous exercise. The left-hand subplot in the figure shows the five points used in time step <span class="math inline">\(t_n\)</span>, and the right-hand subplot shows the one point that is calculated at time step <span class="math inline">\(t_{n+1}\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:heat-stencil-2"></span>
<img src="images/Ch06_HeatStencil2D.png" alt="The finite difference stencil for the 2D heat equation." width="75%" />
<p class="caption">
Figure 6.9: The finite difference stencil for the 2D heat equation.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-588" class="exercise"><strong>Exercise 6.36  </strong></span>Now we need to implement the finite difference scheme that you developed in the previous problem. As a model problem, consider the 2D heat equation <span class="math inline">\(u_t = D(u_{xx} + u_{yy})\)</span> on the domain <span class="math inline">\((x,y) \in [0,1] \times [0,1]\)</span> with the initial condition <span class="math inline">\(u(0,x,y) = \sin(\pi x)\sin(\pi y)\)</span>, homogeneous Dirichlet boundary conditions, and <span class="math inline">\(D=1\)</span>.<a href="#fn13" class="footnote-ref" id="fnref13"><sup>13</sup></a> Fill in the holes in the following code chunks.
</div>
<ul>
<li>First we import the proper libraries and set up the domains for <span class="math inline">\(x\)</span>, <span class="math inline">\(y\)</span>, and <span class="math inline">\(t\)</span>.</li>
</ul>
<div class="sourceCode" id="cb109"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb109-1"><a href="ch-pdes.html#cb109-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb109-2"><a href="ch-pdes.html#cb109-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb109-3"><a href="ch-pdes.html#cb109-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> cm <span class="co"># this allows for color maps </span></span>
<span id="cb109-4"><a href="ch-pdes.html#cb109-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> ipywidgets <span class="im">import</span> interactive</span>
<span id="cb109-5"><a href="ch-pdes.html#cb109-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-6"><a href="ch-pdes.html#cb109-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Write code to build a linearly spaced array of x values </span></span>
<span id="cb109-7"><a href="ch-pdes.html#cb109-7" aria-hidden="true" tabindex="-1"></a><span class="co"># starting at 0 and ending at exactly 1</span></span>
<span id="cb109-8"><a href="ch-pdes.html#cb109-8" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="co"># your code here</span></span>
<span id="cb109-9"><a href="ch-pdes.html#cb109-9" aria-hidden="true" tabindex="-1"></a>y <span class="op">=</span> x <span class="co"># This is a step that allows for us to have y = x </span></span>
<span id="cb109-10"><a href="ch-pdes.html#cb109-10" aria-hidden="true" tabindex="-1"></a><span class="co"># The consequence of the previous line is that dy = dx.</span></span>
<span id="cb109-11"><a href="ch-pdes.html#cb109-11" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> <span class="co"># Extract dx from your array of x values.</span></span>
<span id="cb109-12"><a href="ch-pdes.html#cb109-12" aria-hidden="true" tabindex="-1"></a><span class="co"># Now write code to build a linearly spaced array of time values </span></span>
<span id="cb109-13"><a href="ch-pdes.html#cb109-13" aria-hidden="true" tabindex="-1"></a><span class="co"># starting at 0 and ending at 0.25.</span></span>
<span id="cb109-14"><a href="ch-pdes.html#cb109-14" aria-hidden="true" tabindex="-1"></a><span class="co"># You will want to use many more values for time than for space </span></span>
<span id="cb109-15"><a href="ch-pdes.html#cb109-15" aria-hidden="true" tabindex="-1"></a><span class="co"># (think about the stability conditions from the 1D heat equation).</span></span>
<span id="cb109-16"><a href="ch-pdes.html#cb109-16" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="co"># your code here</span></span>
<span id="cb109-17"><a href="ch-pdes.html#cb109-17" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> <span class="co"># Extract dt from your array of t values</span></span>
<span id="cb109-18"><a href="ch-pdes.html#cb109-18" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-19"><a href="ch-pdes.html#cb109-19" aria-hidden="true" tabindex="-1"></a><span class="co"># Next we will use the np.meshgrid() command to turn the arrays of </span></span>
<span id="cb109-20"><a href="ch-pdes.html#cb109-20" aria-hidden="true" tabindex="-1"></a><span class="co"># x and y values into 2D grids of x and y values.  </span></span>
<span id="cb109-21"><a href="ch-pdes.html#cb109-21" aria-hidden="true" tabindex="-1"></a><span class="co"># If you match the corresponding entries of X and Y then you get </span></span>
<span id="cb109-22"><a href="ch-pdes.html#cb109-22" aria-hidden="true" tabindex="-1"></a><span class="co"># every ordered pair in the domain.</span></span>
<span id="cb109-23"><a href="ch-pdes.html#cb109-23" aria-hidden="true" tabindex="-1"></a>X, Y <span class="op">=</span> np.meshgrid(x,y)</span>
<span id="cb109-24"><a href="ch-pdes.html#cb109-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb109-25"><a href="ch-pdes.html#cb109-25" aria-hidden="true" tabindex="-1"></a><span class="co"># Next we set up a 3 dimensional array of zeros to store all of </span></span>
<span id="cb109-26"><a href="ch-pdes.html#cb109-26" aria-hidden="true" tabindex="-1"></a><span class="co"># the time steps of the solutions.</span></span>
<span id="cb109-27"><a href="ch-pdes.html#cb109-27" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> np.zeros( (<span class="bu">len</span>(t), <span class="bu">len</span>(x), <span class="bu">len</span>(y)))</span></code></pre></div>
<ul>
<li>Next we have to set up the boundary and initial conditions for the given problem.</li>
</ul>
<div class="sourceCode" id="cb110"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb110-1"><a href="ch-pdes.html#cb110-1" aria-hidden="true" tabindex="-1"></a>U[<span class="dv">0</span>,:,:] <span class="op">=</span> <span class="co"># initial condition depending on X and Y</span></span>
<span id="cb110-2"><a href="ch-pdes.html#cb110-2" aria-hidden="true" tabindex="-1"></a>U[:,<span class="dv">0</span>,:] <span class="op">=</span> <span class="co"># boundary condition for x=0</span></span>
<span id="cb110-3"><a href="ch-pdes.html#cb110-3" aria-hidden="true" tabindex="-1"></a>U[:,<span class="op">-</span><span class="dv">1</span>,:] <span class="op">=</span> <span class="co"># boundary condition for x=1</span></span>
<span id="cb110-4"><a href="ch-pdes.html#cb110-4" aria-hidden="true" tabindex="-1"></a>U[:,:,<span class="dv">0</span>] <span class="op">=</span> <span class="co"># boundary condition for y=0</span></span>
<span id="cb110-5"><a href="ch-pdes.html#cb110-5" aria-hidden="true" tabindex="-1"></a>U[:,:,<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="co"># boundary condition for y=1</span></span></code></pre></div>
<ul>
<li>We know that the value of <span class="math inline">\(D \Delta t / \Delta x^2\)</span> controls the stability of finite element methods. Therefore, the next step in our code is to calculate this value and print it.</li>
</ul>
<div class="sourceCode" id="cb111"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb111-1"><a href="ch-pdes.html#cb111-1" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb111-2"><a href="ch-pdes.html#cb111-2" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> D<span class="op">*</span>dt<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span></span>
<span id="cb111-3"><a href="ch-pdes.html#cb111-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(a)</span></code></pre></div>
<ul>
<li>Next for the part of the code that actually calculates all of the time steps. Be sure to keep the indexing straight. Also be sure that we are calculating all of the spatial indices <em>inside</em> the domain since the boundary conditions dictate what happens on the boundary.</li>
</ul>
<div class="sourceCode" id="cb112"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb112-1"><a href="ch-pdes.html#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb112-2"><a href="ch-pdes.html#cb112-2" aria-hidden="true" tabindex="-1"></a>  U[n<span class="op">+</span><span class="dv">1</span>,<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> U[n,<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>:<span class="op">-</span><span class="dv">1</span>] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb112-3"><a href="ch-pdes.html#cb112-3" aria-hidden="true" tabindex="-1"></a>    a<span class="op">*</span>(U[n, ?:? , ?:?] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb112-4"><a href="ch-pdes.html#cb112-4" aria-hidden="true" tabindex="-1"></a>       U[n, ?:?, ?:?] <span class="op">-</span> <span class="op">\</span></span>
<span id="cb112-5"><a href="ch-pdes.html#cb112-5" aria-hidden="true" tabindex="-1"></a>       <span class="dv">4</span><span class="op">*</span>U[n, ?:?, ?:?] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb112-6"><a href="ch-pdes.html#cb112-6" aria-hidden="true" tabindex="-1"></a>       U[n, ?:?, ?:?] <span class="op">+</span> <span class="op">\</span></span>
<span id="cb112-7"><a href="ch-pdes.html#cb112-7" aria-hidden="true" tabindex="-1"></a>       U[n, ?:?, ?:?])</span></code></pre></div>
<ul>
<li>Finally, we just need to visualize the solution. Again we use the <code>ipywidgets.interactive</code> tool to build an interactive plot with time as the slider.</li>
</ul>
<div class="sourceCode" id="cb113"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb113-1"><a href="ch-pdes.html#cb113-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> plotter(Frame):</span>
<span id="cb113-2"><a href="ch-pdes.html#cb113-2" aria-hidden="true" tabindex="-1"></a>  fig <span class="op">=</span> plt.figure(figsize<span class="op">=</span>(<span class="dv">12</span>,<span class="dv">10</span>))</span>
<span id="cb113-3"><a href="ch-pdes.html#cb113-3" aria-hidden="true" tabindex="-1"></a>  ax <span class="op">=</span> fig.gca(projection<span class="op">=</span><span class="st">&#39;3d&#39;</span>)</span>
<span id="cb113-4"><a href="ch-pdes.html#cb113-4" aria-hidden="true" tabindex="-1"></a>  ax.plot_surface(X,Y,U[Frame,:,:], cmap<span class="op">=</span>cm.coolwarm)</span>
<span id="cb113-5"><a href="ch-pdes.html#cb113-5" aria-hidden="true" tabindex="-1"></a>  ax.set_zlim(<span class="dv">0</span>,<span class="dv">1</span>)</span>
<span id="cb113-6"><a href="ch-pdes.html#cb113-6" aria-hidden="true" tabindex="-1"></a>  plt.show()</span>
<span id="cb113-7"><a href="ch-pdes.html#cb113-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb113-8"><a href="ch-pdes.html#cb113-8" aria-hidden="true" tabindex="-1"></a>interactive_plot <span class="op">=</span> interactive(plotter, Frame<span class="op">=</span>(<span class="dv">0</span>,<span class="bu">len</span>(t)))</span>
<span id="cb113-9"><a href="ch-pdes.html#cb113-9" aria-hidden="true" tabindex="-1"></a>interactive_plot</span></code></pre></div>
<p>Fill in all of the holes in the code and verify that your solution appears to solve a heat dissipation problem.</p>
<hr />

<div class="theorem">
<p><span id="thm:unnamed-chunk-594" class="theorem"><strong>Theorem 6.4  </strong></span>In order for the finite difference solution to the 2D heat equation on a square domain to be stable then we need <span class="math inline">\(D \Delta t / \Delta x^2 &lt; \underline{\hspace{0.5in}}\)</span>.</p>
Experiment with several parameters to imperically determine the bound.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-595" class="exercise"><strong>Exercise 6.37  </strong></span>Time to do some experimentation with your new 2D heat equation code! Numerically solve the 2D heat equation with different boundary conditions (both Dirichlet and Neumann). Be prepared to present your solutions.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-596" class="exercise"><strong>Exercise 6.38  </strong></span>Now solve the 2D heat equation on a rectangular domain. You will need to make some modifications to your code since it is unlikely that assuming that <span class="math inline">\(\Delta x = \Delta y\)</span> is a good assumption any longer. Again, be prepared to present your solutions.
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="stability-of-the-heat-equation-solution" class="section level2" number="6.5">
<h2><span class="header-section-number">6.5</span> Stability of the Heat Equation Solution</h2>

<div class="exercise">
<span id="exr:unnamed-chunk-597" class="exercise"><strong>Exercise 6.39  </strong></span>(<strong>Sawtooth Errors</strong>) We have already seen that the 1D heat equation is stable if <span class="math inline">\(D \Delta t / \Delta x^2 &lt; 0.5\)</span>. The goal of this problem is to show what, exactly, occurs when we choose parameters in the unstable region. We’ll solve the PDE <span class="math inline">\(u_t = u_{xx}\)</span> on the domain <span class="math inline">\(x \in [0,1]\)</span> with initial conditions <span class="math inline">\(u(0,x) = \sin(\pi x)\)</span> then the analytic solution is <span class="math inline">\(u(t,x) = e^{-\pi^2 t}\sin(\pi x)\)</span>. To build the spatial and temporal domains we will use <code>x = np.linspace(0,1,21)</code> and <code>t = np.linspace(0,0.25,101)</code>. This means that <span class="math inline">\(\Delta x = 0.05\)</span> and <span class="math inline">\(\Delta t = 0.0025\)</span> so the ratio <span class="math inline">\(D \Delta t / \Delta x^2 = 1 &gt; 0.5\)</span> (certainly in the unstable region). Solve the heat equation with finite differences using these parameters. Make plots of the approximate solution on top of the exact solution at time steps 0, 10, 20, 30, 31, 32, 33, 34, etc. Describe what you observe as the time step exceeds 30.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-598" class="exercise"><strong>Exercise 6.40  </strong></span>Solve the 2D heat equation on the unit square with the following parameters:</p>
<ul>
<li>A partition of 21 points in both the <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span> direction.</li>
<li>301 points between 0 and 0.25 for time</li>
<li>An initial condition of <span class="math inline">\(u(0,x,y) = \sin(\pi x) \sin(\pi y)\)</span></li>
</ul>
What happens near time step number 70?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-599" class="exercise"><strong>Exercise 6.41  </strong></span>What you saw in the previous two exercises is an example of a <strong>sawtooth error</strong> that occurs when a numerical solution technique for a PDE is unstable. Propose a conjecture for why this type of error occurs.
</div>
<hr />

<div class="theorem">
<p><span id="thm:unnamed-chunk-600" class="theorem"><strong>Theorem 6.5  </strong></span>Let’s summarize the stability criteria for the finite difference solutions to the heat equation.</p>
<ul>
<li>In the 1D heat equation the finite difference solution is stable if <span class="math inline">\(D \Delta t / \Delta x^2 &lt; \underline{\hspace{0.5in}}\)</span>.</li>
<li>In the 2D heat equation the finite difference solution is stable if <span class="math inline">\(D \Delta t / \Delta x^2 &lt; \underline{\hspace{0.5in}}\)</span> (assuming a square domain where <span class="math inline">\(\Delta x = \Delta y\)</span>)</li>
<li>Propose a stability criterion for the 3D heat equation.</li>
</ul>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-601" class="exercise"><strong>Exercise 6.42  </strong></span>Rewrite your finite difference code so that it produces an error message when the parameters will result in an unstable finite difference solution. Do the same for your 2D heat equation code.
</div>
<hr />
<p>It is actually possible to beat the stability criteria given in the previous exercises! What follows are two implicit methods that use a forward-looking scheme to help completely avoid unstable solutions. The primary advantage to these schemes is that we won’t need to pay as close attention to the ratio of the time step to the square of the spatial step. Instead, we can take time and spatial steps that are appropriate for the application we have in mind.</p>
<hr />

<div class="exercise">
<p><span id="exr:implicit-heat" class="exercise"><strong>Exercise 6.43  </strong></span>(<strong>Implicit Finite Difference Scheme</strong>) For the 1D heat equation <span class="math inline">\(u_t = D u_{xx}\)</span> we have been finding the numerical solution using the explicit finite difference scheme
<span class="math display">\[\frac{U_i^{n+1} - U_i^n}{\Delta t} = D \frac{U_{i+1}^{n} - 2U_i^{n} + U_{i-1}^{n}}{\Delta x^2}\]</span>
where we approximate the time derivative with the usual forward difference and we approximate the spatial derivative with the usual centered difference. If, however, we use the spatial derivative at time step <span class="math inline">\(n+1\)</span> instead of time step <span class="math inline">\(n\)</span> we get the finite difference scheme
<span class="math display">\[\frac{U_i^{n+1} - U_i^n}{\Delta t} = D \frac{U_{i+1}^{n+1} - 2U_i^{n+1} + U_{i-1}^{n+1}}{\Delta x^2}.\]</span>
This may seem completely ridiculous since we don’t yet know the information at time step <span class="math inline">\(n+1\)</span> but some algebraic rearrangement shows that we can treat this as a system of linear equations which can be solved (using something like <code>np.linalg.solve()</code>) for the <span class="math inline">\((n+1)^{st}\)</span> time step.</p>
<p>Before we start let’s define the coefficient <span class="math inline">\(a = D \Delta t / \Delta x^2.\)</span> This will save a little bit of writing in the coming steps.</p>
<ol style="list-style-type: lower-alpha">
<li>Rearrange the new finite difference scheme so that all of the terms at the <span class="math inline">\((n+1)^{st}\)</span> time step are on the left-hand side and all of the term at the <span class="math inline">\(n^{th}\)</span> time step are on the right-hand side.
<span class="math display">\[(\underline{\hspace{0.25in}}) U_{i-1}^{n+1} + (\underline{\hspace{0.5in}}) U_{i}^{n+1} + (\underline{\hspace{0.25in}}) U_{i-1}^{n+1} = \underline{\hspace{0.25in}} U_i^n\]</span></li>
<li>Now we’re going to build a very small example with only 6 spatial points so that you can clearly see the structure of the resulting linear system.
<ol style="list-style-type: lower-roman">
<li>If we have 6 total points in the spatial grid (<span class="math inline">\(x_0, x_1, \ldots, x_5\)</span>) then we have the following equations (fill in the blanks):
<span class="math display">\[\begin{aligned}
(\text{for $x_1$: }) \quad \underline{\hspace{0.25in}} U_0^{n+1} + \underline{\hspace{0.5in}} U_1^{n+1} + \underline{\hspace{0.25in}} U_2^{n+1}  &amp;=  \underline{\hspace{0.25in}} U_1^{n} \\
(\text{for $x_2$: }) \quad \underline{\hspace{0.25in}} U_1^{n+1} + \underline{\hspace{0.5in}} U_2^{n+1} + \underline{\hspace{0.25in}} U_3^{n+1}  &amp;=  \underline{\hspace{0.25in}} U_2^{n} \\
(\text{for $x_3$: }) \quad \underline{\hspace{0.25in}} U_2^{n+1} + \underline{\hspace{0.5in}} U_3^{n+1} + \underline{\hspace{0.25in}} U_4^{n+1}  &amp;=  \underline{\hspace{0.25in}} U_3^{n} \\
(\text{for $x_4$: }) \quad \underline{\hspace{0.25in}} U_3^{n+1} + \underline{\hspace{0.5in}} U_4^{n+1} + \underline{\hspace{0.25in}} U_5^{n+1}  &amp;=  \underline{\hspace{0.25in}} U_4^{n} \\
\end{aligned}\]</span></li>
<li>Notice that we aready know <span class="math inline">\(U_0^{n+1}\)</span> and <span class="math inline">\(U_5^{n+1}\)</span> since these are dictated by the boundary conditions (assuming Dirichlet boundary conditions). Hence we can move these known quantities to the right-hand side of the equations and hence rewrite the system of equations as:
<span class="math display">\[\begin{aligned}
(\text{for $x_1$: }) &amp;\quad \underline{\hspace{0.5in}} U_1^{n+1} + \underline{\hspace{0.25in}} U_2^{n+1} =  \underline{\hspace{0.25in}} U_1^{n} + \underline{\hspace{0.25in}} U_0^{n+1}\\
(\text{for $x_2$: }) &amp;\quad \underline{\hspace{0.25in}} U_1^{n+1} + \underline{\hspace{0.5in}} U_2^{n+1} + \underline{\hspace{0.25in}} U_3^{n+1} =  \underline{\hspace{0.25in}} U_2^{n} \\
(\text{for $x_3$: }) &amp;\quad \underline{\hspace{0.25in}} U_2^{n+1} + \underline{\hspace{0.5in}} U_3^{n+1} + \underline{\hspace{0.25in}} U_4^{n+1} =  \underline{\hspace{0.25in}} U_3^{n} \\
(\text{for $x_4$: }) &amp;\quad \underline{\hspace{0.25in}} U_3^{n+1} + \underline{\hspace{0.5in}} U_4^{n+1} =  \underline{\hspace{0.25in}} U_4^{n} + \underline{\hspace{0.25in}} U_5^{n+1} \\
\end{aligned}\]</span></li>
<li>Now we can leverage linear algebra and write this as a matrix equation.
<span class="math display">\[\begin{pmatrix} \underline{\hspace{0.25in}} &amp; \underline{\hspace{0.25in}} &amp; 0 &amp; 0 \\ \underline{\hspace{0.25in}} &amp; \underline{\hspace{0.25in}} &amp; \underline{\hspace{0.25in}} &amp; 0 \\ 0 &amp; \underline{\hspace{0.25in}} &amp; \underline{\hspace{0.25in}} &amp; \underline{\hspace{0.25in}} \\ 0 &amp; 0 &amp; \underline{\hspace{0.25in}} &amp; \underline{\hspace{0.25in}} \end{pmatrix}\begin{pmatrix} U_1^{n+1} \\ U_2^{n+1} \\ U_3^{n+1} \\ U_4^{n+1} \end{pmatrix} = \begin{pmatrix} U_1^{n} \\ U_2^{n} \\ U_3^{n} \\ U_4^{n} \end{pmatrix} + \begin{pmatrix} \underline{\hspace{0.25in}} U_0^{n+1} \\ 0 \\ 0 \\ \underline{\hspace{0.25in}} U_5^{n+1} \end{pmatrix}\]</span></li>
</ol></li>
<li>At this point the structure of the coefficient matrix on the left and the vector sum on the right should be clear (even for more spatial points). It is time for us to start writing some code. We’ll start with the basic setup of the problem.</li>
</ol>
</div>
<div class="sourceCode" id="cb114"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb114-1"><a href="ch-pdes.html#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb114-2"><a href="ch-pdes.html#cb114-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb114-3"><a href="ch-pdes.html#cb114-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-4"><a href="ch-pdes.html#cb114-4" aria-hidden="true" tabindex="-1"></a>D <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb114-5"><a href="ch-pdes.html#cb114-5" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> <span class="co"># set up a linearly spaced spatial domain </span></span>
<span id="cb114-6"><a href="ch-pdes.html#cb114-6" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> <span class="co"># set up a linearly spaced temporal domain</span></span>
<span id="cb114-7"><a href="ch-pdes.html#cb114-7" aria-hidden="true" tabindex="-1"></a>dx <span class="op">=</span> x[<span class="dv">1</span>]<span class="op">-</span>x[<span class="dv">0</span>]</span>
<span id="cb114-8"><a href="ch-pdes.html#cb114-8" aria-hidden="true" tabindex="-1"></a>dt <span class="op">=</span> t[<span class="dv">1</span>]<span class="op">-</span>t[<span class="dv">0</span>]</span>
<span id="cb114-9"><a href="ch-pdes.html#cb114-9" aria-hidden="true" tabindex="-1"></a>a <span class="op">=</span> D<span class="op">*</span>dt<span class="op">/</span>dx<span class="op">**</span><span class="dv">2</span></span>
<span id="cb114-10"><a href="ch-pdes.html#cb114-10" aria-hidden="true" tabindex="-1"></a>IC <span class="op">=</span> <span class="kw">lambda</span> x: <span class="co"># write a function for the initial condition</span></span>
<span id="cb114-11"><a href="ch-pdes.html#cb114-11" aria-hidden="true" tabindex="-1"></a>BCleft <span class="op">=</span> <span class="kw">lambda</span> t: <span class="dv">0</span><span class="op">*</span>t <span class="co"># left boundary condition </span></span>
<span id="cb114-12"><a href="ch-pdes.html#cb114-12" aria-hidden="true" tabindex="-1"></a><span class="co"># (we&#39;ve used 0*t here for a homog. bc)</span></span>
<span id="cb114-13"><a href="ch-pdes.html#cb114-13" aria-hidden="true" tabindex="-1"></a>BCright <span class="op">=</span> <span class="kw">lambda</span> t: <span class="dv">0</span><span class="op">*</span>t <span class="co"># right boundary condition </span></span>
<span id="cb114-14"><a href="ch-pdes.html#cb114-14" aria-hidden="true" tabindex="-1"></a><span class="co"># (we&#39;ve used 0*t here for a homog. bc)</span></span>
<span id="cb114-15"><a href="ch-pdes.html#cb114-15" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb114-16"><a href="ch-pdes.html#cb114-16" aria-hidden="true" tabindex="-1"></a>U <span class="op">=</span> np.zeros( ( <span class="bu">len</span>(t), <span class="bu">len</span>(x) ) ) <span class="co"># set up a blank array for U</span></span>
<span id="cb114-17"><a href="ch-pdes.html#cb114-17" aria-hidden="true" tabindex="-1"></a>U[<span class="dv">0</span>,:] <span class="op">=</span> IC(x) <span class="co"># set up the initial condition</span></span>
<span id="cb114-18"><a href="ch-pdes.html#cb114-18" aria-hidden="true" tabindex="-1"></a>U[:,<span class="dv">0</span>] <span class="op">=</span> BCleft(t) <span class="co"># set up the left boundary condition</span></span>
<span id="cb114-19"><a href="ch-pdes.html#cb114-19" aria-hidden="true" tabindex="-1"></a>U[:,<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> BCright(t) <span class="co"># set up the right boundary condition</span></span></code></pre></div>
<ol start="4" style="list-style-type: lower-alpha">
<li>Next we write a function that takes in the number of spatial points and returns the coefficient matrix for the linear system. Take note that the first and last rows take a little more care than the rest.</li>
</ol>
<div class="sourceCode" id="cb115"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb115-1"><a href="ch-pdes.html#cb115-1" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> coeffMatrix(M,a): <span class="co"># we are using M=len(x) as the first input</span></span>
<span id="cb115-2"><a href="ch-pdes.html#cb115-2" aria-hidden="true" tabindex="-1"></a>  A <span class="op">=</span> np.matrix( np.zeros( (M<span class="op">-</span><span class="dv">2</span>,M<span class="op">-</span><span class="dv">2</span>) ) ) </span>
<span id="cb115-3"><a href="ch-pdes.html#cb115-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># why are we using M-2 X M-2 for the size?</span></span>
<span id="cb115-4"><a href="ch-pdes.html#cb115-4" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">0</span>,<span class="dv">0</span>] <span class="op">=</span> <span class="co"># top left entry</span></span>
<span id="cb115-5"><a href="ch-pdes.html#cb115-5" aria-hidden="true" tabindex="-1"></a>  A[<span class="dv">0</span>,<span class="dv">1</span>] <span class="op">=</span> <span class="co"># entry in the first row second column</span></span>
<span id="cb115-6"><a href="ch-pdes.html#cb115-6" aria-hidden="true" tabindex="-1"></a>  A[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="co"># bottom right entry</span></span>
<span id="cb115-7"><a href="ch-pdes.html#cb115-7" aria-hidden="true" tabindex="-1"></a>  A[<span class="op">-</span><span class="dv">1</span>,<span class="op">-</span><span class="dv">2</span>] <span class="op">=</span> <span class="co"># entry in the last row second to last column</span></span>
<span id="cb115-8"><a href="ch-pdes.html#cb115-8" aria-hidden="true" tabindex="-1"></a>  <span class="cf">for</span> i <span class="kw">in</span> <span class="bu">range</span>(<span class="dv">1</span>,M<span class="op">-</span><span class="dv">3</span>): <span class="co"># now loop through all of the other rows</span></span>
<span id="cb115-9"><a href="ch-pdes.html#cb115-9" aria-hidden="true" tabindex="-1"></a>    A[i,i] <span class="op">=</span> <span class="co"># entry on the main diagonal</span></span>
<span id="cb115-10"><a href="ch-pdes.html#cb115-10" aria-hidden="true" tabindex="-1"></a>    A[i,i<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> <span class="co"># entry on the lower diagonal</span></span>
<span id="cb115-11"><a href="ch-pdes.html#cb115-11" aria-hidden="true" tabindex="-1"></a>    A[i,i<span class="op">+</span><span class="dv">1</span>] <span class="op">=</span> <span class="co"># entry on the upper diagonal</span></span>
<span id="cb115-12"><a href="ch-pdes.html#cb115-12" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> A</span>
<span id="cb115-13"><a href="ch-pdes.html#cb115-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb115-14"><a href="ch-pdes.html#cb115-14" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> coeffMatrix(<span class="bu">len</span>(x),a)</span>
<span id="cb115-15"><a href="ch-pdes.html#cb115-15" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb115-16"><a href="ch-pdes.html#cb115-16" aria-hidden="true" tabindex="-1"></a>plt.spy(A) </span>
<span id="cb115-17"><a href="ch-pdes.html#cb115-17" aria-hidden="true" tabindex="-1"></a><span class="co"># spy is a handy plotting tool that shows the structure </span></span>
<span id="cb115-18"><a href="ch-pdes.html#cb115-18" aria-hidden="true" tabindex="-1"></a><span class="co"># of a matrix (optional)</span></span>
<span id="cb115-19"><a href="ch-pdes.html#cb115-19" aria-hidden="true" tabindex="-1"></a>plt.show()</span></code></pre></div>
<ol start="5" style="list-style-type: lower-alpha">
<li>Next we write a loop that iteratively solves the system of equations for each new time step.</li>
</ol>
<div class="sourceCode" id="cb116"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb116-1"><a href="ch-pdes.html#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> n <span class="kw">in</span> <span class="bu">range</span>(<span class="bu">len</span>(t)<span class="op">-</span><span class="dv">1</span>):</span>
<span id="cb116-2"><a href="ch-pdes.html#cb116-2" aria-hidden="true" tabindex="-1"></a>  b1 <span class="op">=</span> U[n,???] </span>
<span id="cb116-3"><a href="ch-pdes.html#cb116-3" aria-hidden="true" tabindex="-1"></a>  <span class="co"># b1 is a vector of U at step n for the inner spatial nodes</span></span>
<span id="cb116-4"><a href="ch-pdes.html#cb116-4" aria-hidden="true" tabindex="-1"></a>  b2 <span class="op">=</span> np.zeros_like(b1) <span class="co"># set up the second right-hand vector</span></span>
<span id="cb116-5"><a href="ch-pdes.html#cb116-5" aria-hidden="true" tabindex="-1"></a>  b2[<span class="dv">0</span>] <span class="op">=</span> ???<span class="op">*</span>BCleft(t[n<span class="op">+</span><span class="dv">1</span>]) <span class="co"># fill in the correct first entry</span></span>
<span id="cb116-6"><a href="ch-pdes.html#cb116-6" aria-hidden="true" tabindex="-1"></a>  b2[<span class="op">-</span><span class="dv">1</span>] <span class="op">=</span> ???<span class="op">*</span>BCright(t[n<span class="op">+</span><span class="dv">1</span>]) <span class="co"># fill in the correct last entry</span></span>
<span id="cb116-7"><a href="ch-pdes.html#cb116-7" aria-hidden="true" tabindex="-1"></a>  b <span class="op">=</span> b1 <span class="op">+</span> b2 <span class="co"># The vector &quot;b&quot; is the right side of the equation</span></span>
<span id="cb116-8"><a href="ch-pdes.html#cb116-8" aria-hidden="true" tabindex="-1"></a>  <span class="co"># </span></span>
<span id="cb116-9"><a href="ch-pdes.html#cb116-9" aria-hidden="true" tabindex="-1"></a>  <span class="co"># finally use a linear algebra solver to fill in the </span></span>
<span id="cb116-10"><a href="ch-pdes.html#cb116-10" aria-hidden="true" tabindex="-1"></a>  <span class="co"># inner spatial nodes at step n+1</span></span>
<span id="cb116-11"><a href="ch-pdes.html#cb116-11" aria-hidden="true" tabindex="-1"></a>  U[n<span class="op">+</span><span class="dv">1</span>,???] <span class="op">=</span> ???</span></code></pre></div>
<ol start="6" style="list-style-type: lower-alpha">
<li><p>All of the hard work is now done. It remains to plot the solution. Try this method on several sets of initial and boundary conditions for the 1D heat equation. Be sure to demonstrate that the method is stable no matter the values of <span class="math inline">\(\Delta t\)</span> and <span class="math inline">\(\Delta x\)</span>.</p></li>
<li><p>What are the primary advantages and disadvantages to the implicit method descirbed in this problem?</p></li>
</ol>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-605" class="exercise"><strong>Exercise 6.44  </strong></span>(<strong>The Crank-Nicolson Method</strong>) We conclude this section with one more implicit scheme: the <strong>Crank-Nicolson Method</strong>. In this method we approximate the temporal derivative with a forward difference just like always, but we approximate the spatial derivative as the average of the central difference at the current time step and the central difference at the new time step. That is:
<span class="math display">\[\frac{U_i^{n+1} - U_i^n}{\Delta t} = \frac{1}{2} \left[D \left( \frac{U_{i+1}^n - 2U_i^n +
        U_{i+1}^n}{\Delta x^2}\right) +D \left(\frac{U_{i+1}^{n+1} - 2U_i^{n+1} +
    U_{i+1}^{n+1}}{\Delta x^2} \right) \right].\]</span>
Letting
<span class="math inline">\(r = D \Delta t / (2\Delta x^2)\)</span> we can rearrange to get
<span class="math display">\[\underline{\hspace{0.25in}} U_{i-1}^{n+1} + \underline{\hspace{0.25in}} U_{i}^{n+1} + \underline{\hspace{0.25in}} U_{i+1}^{n+1} = \underline{\hspace{0.25in}} U_{i-1}^{n} + \underline{\hspace{0.25in}} U_{i}^{n} + \underline{\hspace{0.25in}} U_{i+1}^{n}.\]</span>
This can now be viewed as a system of equations. Let’s build this system carefully and then write code to solve the heat equation from the previous problems with the Crank-Nicolson method. For this problem we will assume fixed Dirichlet boundary conditions on both the left- and right-hand sides of the domain.</p>
<ol style="list-style-type: lower-alpha">
<li><p>First let’s write the equations for several values of <span class="math inline">\(i\)</span>.
<span class="math display">\[\begin{aligned}
                (\text{$x_1$ }): \quad \underline{\hspace{0.15in}} U_0^{n+1} + \underline{\hspace{0.15in}} U^{n+1}_1  + \underline{\hspace{0.15in}} U^{n+1}_2 &amp;=  \underline{\hspace{0.15in}}U^n_0 +
                \underline{\hspace{0.15in}} U^n_1 + \underline{\hspace{0.15in}}U^n_2 \\
                (\text{$x_2$ }): \quad \underline{\hspace{0.15in}} U_1^{n+1} + \underline{\hspace{0.15in}} U^{n+1}_2 + \underline{\hspace{0.15in}}U^{n+1}_3 &amp;= \underline{\hspace{0.15in}}U^n_1 +
                \underline{\hspace{0.15in}} U^n_2 + \underline{\hspace{0.15in}}U^n_3 \\
                (\text{$x_3$ }): \quad \underline{\hspace{0.15in}} U_2^{n+1} + \underline{\hspace{0.15in}} U^{n+1}_3 + \underline{\hspace{0.15in}}U^{n+1}_4 &amp;= \underline{\hspace{0.15in}}U^n_2 +
                \underline{\hspace{0.15in}} U^n_3 + \underline{\hspace{0.15in}}U^n_4 \\
                \qquad \vdots &amp; \qquad \vdots \\
                (\text{$x_{M-2}$ }): \quad \underline{\hspace{0.1in}} U_{M-3}^{n+1} + \underline{\hspace{0.1in}} U^{n+1}_{M-2} + \underline{\hspace{0.1in}}U^{n+1}_{M-1} &amp;= \underline{\hspace{0.1in}}U^n_{M-3} + \underline{\hspace{0.1in}} U^n_{M-2} + \underline{\hspace{0.1in}}U^n_{M-1} 
            \end{aligned}\]</span> where <span class="math inline">\(M\)</span> is the number of spatial
points (enumerated <span class="math inline">\(x_0, x_1, x_2, \ldots, x_{M-1}\)</span>).</p></li>
<li><p>The first and last equations can be simplified since we are assuming that we have
Dirichlet boundary conditions. Therefore for <span class="math inline">\(x_1\)</span> we can rearrange
to move the <span class="math inline">\(U_0^{n+1}\)</span> term to the right-hand side since it is given for all time.
Similarly for <span class="math inline">\(x_{M-2}\)</span> we can move the <span class="math inline">\(U_{M-1}^{n+1}\)</span> term to the right-hand side since
it is fixed for all time. Rewrite these two equtions.</p></li>
<li><p>Verify that the left-hand side of the equations that we have built
in parts (a) and (b) can be written as the following matrix-vector
product: <span class="math display">\[\begin{aligned}
                \begin{pmatrix}
                    (1+2r) &amp; -r &amp; 0 &amp; 0  &amp; \cdots &amp; 0 \\
                    -r &amp; (1+2r) &amp; -r &amp; 0  &amp; \cdots &amp; 0 \\
                    0 &amp; -r &amp; (1+2r) &amp; -r  &amp; \cdots &amp; 0 \\
                    \vdots &amp; &amp;  &amp;  &amp;  &amp;  0 \\
                    0 &amp; \cdots &amp; &amp;  0 &amp; -r &amp; (1+2r)
                \end{pmatrix} 
                \begin{pmatrix} 
                    U^{n+1}_1 \\ U^{n+1}_2 \\ U^{n+1}_3 \\ \vdots
                    \\U^{n+1}_{M-2}   
                \end{pmatrix}
            \end{aligned}\]</span></p></li>
<li><p>Verify that the right-hand side of the equations that we built in
parts (a) and (b) can be written as <span class="math display">\[\begin{aligned}
                \begin{pmatrix}
                    (1-2r) &amp; r &amp; 0 &amp; 0  &amp; \cdots &amp; 0 \\
                    r &amp; (1-2r) &amp; r &amp; 0  &amp; \cdots &amp; 0 \\
                    0 &amp; r &amp; (1-2r) &amp; r  &amp;  &amp; 0 \\
                    \vdots &amp;  &amp;  &amp; &amp; &amp;   \\
                     &amp;  &amp;  &amp;  &amp;  r &amp; (1-2r)
                \end{pmatrix} 
                \begin{pmatrix} 
                    U^{n}_1 \\ U^{n}_2 \\ U_3^n \\ \vdots
                    \\U^{n}_{M-2}   
                \end{pmatrix} + 
                \begin{pmatrix}
                    rU_0^{n+1} \\ 0 \\ \vdots \\ 0 \\ rU_{M-1}^{n+1} 
                \end{pmatrix}
            \end{aligned}\]</span></p></li>
<li><p>Now for the wonderful part! The entire system of equations from
part (a) can be written as <span class="math display">\[A \mathcal{U}^{n+1} = B \mathcal{U}^n + D.\]</span> What are the
matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> and what are the vectors <span class="math inline">\(\mathcal{U}^{n+1}\)</span>, <span class="math inline">\(\mathcal{U}^n\)</span>, and
<span class="math inline">\(D\)</span>?</p></li>
<li><p>To solve for <span class="math inline">\(\mathcal{U}^{n+1}\)</span> at each time step we simply need to do a linear solve: <span class="math display">\[\mathcal{U}^{n+1} = A^{-1} \left( B \mathcal{U}^n + D \right).\]</span> Of course, we will never do a matrix inverse on a computer. Instead we can lean on tools such as <code>np.linalg.solve()</code> to do the linear solve for us.</p></li>
<li><p>Finally. Write code to solve the 1D Heat Equation implementing the
Crank Nicolson method described in this problem. The setup of your
code should be largely the same as for the implicit method from Exercise <a href="ch-pdes.html#exr:implicit-heat">6.43</a>.
You will need to construct the matrices <span class="math inline">\(A\)</span> and <span class="math inline">\(B\)</span> as well as the
vector <span class="math inline">\(D\)</span>. Then your time stepping loop will contain the code from
part (f) of this problem.</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-606" class="exercise"><strong>Exercise 6.45  </strong></span>To graphically show the Crank Nicolson method we can again use a finite difference stencil to show where the information is coming from and where it is going to. In Figure <a href="ch-pdes.html#fig:heat-stencil-crank">6.10</a> notice that there are three points at the new time step that are used to calculate the value of <span class="math inline">\(U_i^{n+1}\)</span> at the new time step. Sketch a similar image for the original implicit scheme from Exercise <a href="ch-pdes.html#exr:implicit-heat">6.43</a>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:heat-stencil-crank"></span>
<img src="images/Ch06_HeatStencilCrankNicolson.png" alt="The finite difference stencil for the Crank Nicolson method." width="80%" />
<p class="caption">
Figure 6.10: The finite difference stencil for the Crank Nicolson method.
</p>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="the-wave-equation" class="section level2" number="6.6">
<h2><span class="header-section-number">6.6</span> The Wave Equation</h2>
<p>The problems that we’ve dealt with thus far all model natural diffusion processes: heat transport, molecular diffusion, etc. Another interesting physical phenomenon is that of wave propagation. Previously it was given that the 1D <em>wave equation</em> is <span class="math display">\[\begin{aligned}
       u_{tt} = c u_{xx}
       \label{eqn:wave1D}
   \end{aligned}\]</span>
where <span class="math inline">\(c\)</span> is a parameter modeling the stiffness of the medium the wave is traveling through. With homogeneous Dirichlet boundary conditions we can think of this as the behavior of a guitar string after it has been plucked. If the boundaries are in motion then the model might be of someone wiggling a taught string from one end.</p>
<p>So far we have just accepted that this is the wave equation, but we should pause now and look at where the equation comes from. We will stick with 1 spatial dimension and imagine that we are modeling the displacement of a plucked guitar string. Let <span class="math inline">\(u(t,x)\)</span> be the displacement of the string from equilibrium. From Newton’s second law we know that <span class="math inline">\(F = ma\)</span> where the force here is the tension in the string. From Calculus, the acceleration is the second time derivative of the displacement. Hence, for a string of density <span class="math inline">\(\rho\)</span> over length <span class="math inline">\(\Delta x\)</span> we have
<span class="math display">\[ma = \rho \Delta x \frac{\partial^2 u}{\partial t^2}\]</span>
and we now have the equation
<span class="math display">\[\text{tension in the string} = \rho \Delta x \frac{\partial^2 u}{\partial t^2}.\]</span></p>
<p>If we assume that there is no bending or side-to-side motion of the spring, the tension vector must be tangential to the string. It would be good to draw a picture now:</p>
<ul>
<li>Draw a curve representing the string.</li>
<li>Pick two points on the curve representing the left and right side of an interval of length <span class="math inline">\(\Delta x\)</span>.</li>
<li>Draw a vector tangent to the string at the left point. The angle from horizontal will be called <span class="math inline">\(\theta_{\text{left}}\)</span></li>
<li>Draw a vector tangent to the string at the right point. The angle from horizontal will be called <span class="math inline">\(\theta_{\text{right}}\)</span></li>
</ul>
<p>If we are interested in a segment of string of length <span class="math inline">\(\Delta x\)</span> then the vertical motion will be dictated by the difference between the vertical components of the tensions at the two endpoints
<span class="math display">\[\text{tension in the spring} = T_{\text{right}} \sin \theta_{\text{right}} - T_{\text{left}} \sin \theta_{\text{left}}\]</span>
Since the motion is only vertical we must have that the horizontal tensions are equal and constant
<span class="math display">\[T_{\text{right}} \cos \theta_{\text{right}} = T_{\text{left}} \cos \theta_{\text{left}} = T.\]</span></p>
<p>If we divide both sides of the equation
<span class="math display">\[T_{\text{right}} \sin \theta_{\text{right}} - T_{\text{left}} \sin \theta_{\text{left}} = \rho \Delta x \frac{\partial^2 u}{\partial t^2}\]</span>
by the constant tension <span class="math inline">\(T\)</span> we get
<span class="math display">\[\tan\theta_{\text{right}} - \tan\theta_{\text{left}} = \frac{\rho \Delta x}{T} \frac{\partial^2 u}{\partial t^2}.\]</span>
Recognizing that the tangent of the angle will just be the slopes at the right and left points we now have
<span class="math display">\[u_x(t,x+\Delta x) - u_x(t,x) = \frac{\rho \Delta x}{T} \frac{\partial^2 u}{\partial t^2}\]</span>
which can be rearranged to
<span class="math display">\[\frac{T}{\rho} \frac{u_x(t,x+\Delta x) - u_x(t,x)}{\Delta x} = \frac{\partial^2 u}{\partial t^2}.\]</span></p>
<p>Allowing <span class="math inline">\(\Delta x\)</span> to get arbitarily small the difference quotient on the left-hand side becomes the second spatial derivative and we arrive at the 1D wave equation
<span class="math display">\[\frac{\partial^2 u}{\partial t^2} = c \frac{\partial^2 u}{\partial x^2}\]</span>
where we have defined <span class="math inline">\(c = T/\rho\)</span> as a parameter describing the stiffness of the string. The 2D and 3D derivations are similar but a bit trickier with the trig and geometry.</p>
<p>For the remainder of this section we will focus on approximating solutions to the wave equation in 1D, 2D, and 3D numerically.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-607" class="exercise"><strong>Exercise 6.46  </strong></span>Let’s write code to numerically solve the 1D wave equation. As before, we use the notation <span class="math inline">\(U_i^n\)</span> to represent the approximate solution <span class="math inline">\(u(t,x)\)</span> at the point <span class="math inline">\(t=t_n\)</span> and <span class="math inline">\(x=x_i\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Give a reasonable discretization of the second derivative in time:
<span class="math display">\[ u_{tt}(t_{n}, x_i) \approx \underline{\hspace{1in}}. \]</span></li>
<li>Give a reasonable discretization of the second derivative in space:
<span class="math display">\[ u_{xx}(t_n, x_i) \approx \underline{\hspace{1in}}. \]</span></li>
<li>Put your answers to parts (a) and (b) together with the wave equation to get
<span class="math display">\[ \frac{??? - ??? + ???}{\Delta t^2} = c \frac{??? - ??? + ???}{\Delta x^2}. \]</span></li>
<li>Solve the equation from part (c) for <span class="math inline">\(U_i^{n+1}\)</span>. The resulting difference equation is the finite difference scheme for the 1D wave equation.<br />
</li>
<li>You should notice that the finite difference scheme for the wave equation references two different times: <span class="math inline">\(U_i^n\)</span> and <span class="math inline">\(U_i^{n-1}\)</span>. Based on this observation, what information do we need to in order to actually start our numerical solution?</li>
<li>Consider the wave equation <span class="math inline">\(u_{tt} = 2 u_{xx}\)</span> in <span class="math inline">\(x \in (0,1)\)</span> with <span class="math inline">\(u(0,x) = 4x(1-x)\)</span>, <span class="math inline">\(u_t(0,x) = 0\)</span>, and <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span>. Use the finite difference scheme that you built in this problem to approximate the solution to this PDE.</li>
</ol>
</div>
<hr />
<p>Figure <a href="ch-pdes.html#fig:wave-stencil">6.11</a> shows the finite difference stencil for the 1D wave equation. Notice that we need two prior time steps in order to advance to the new time step. This means that in order to start the finite difference scheme for the wave equation we need to have information about time <span class="math inline">\(t_0\)</span> and also time <span class="math inline">\(t_1\)</span>. We get this information by using the two initial conditions <span class="math inline">\(u(0,x)\)</span> and <span class="math inline">\(u_t(0,x)\)</span>.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:wave-stencil"></span>
<img src="images/Ch06_WaveStencil.png" alt="The finite difference stencil for the 1D wave equation." width="75%" />
<p class="caption">
Figure 6.11: The finite difference stencil for the 1D wave equation.
</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-608" class="exercise"><strong>Exercise 6.47  </strong></span>The ratio <span class="math inline">\(c\Delta t^2 / \Delta x^2\)</span> shows up explicitly in the finite difference scheme for the 1D wave equation. Just like in the heat equation, this parameter controlls when the finite difference solution will be stable. Experiment with your finite difference solution and conjecture a value of <span class="math inline">\(a = c \Delta t^2 / \Delta x^2\)</span> which divides the regions of stability versus instability. Your answer should be in the form:</p>
<p><em>If <span class="math inline">\(a = c\Delta t^2 / \Delta x^2 &lt; \underline{\hspace{0.5in}}\)</span> then the finite difference scheme for the 1D wave equation will be stable. Otherwise it will be unstable.</em></p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-609" class="exercise"><strong>Exercise 6.48  </strong></span>Show several plots demonstrating what occurs to the finite difference solution of the wave equation when the parameters are in the unstable region and right on the edge of the unstable region.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-610" class="exercise"><strong>Exercise 6.49  </strong></span>What is the expected error in the finite difference scheme for the 1D wave equation? What does this mean in plain English?
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-611" class="exercise"><strong>Exercise 6.50  </strong></span>Use your finite difference code to solve the 1D wave equation
<span class="math display">\[ u_{tt} = c u_{xx} \]</span>
with boundary conditions <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span>, initial condition <span class="math inline">\(u(0,x) = 4x(1-x)\)</span>, and zero initial velocity. Experiment with different values of <span class="math inline">\(c\)</span>. What does the parameter <span class="math inline">\(c\)</span> to the wave? Give a physical interpretation of <span class="math inline">\(c\)</span>.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-612" class="exercise"><strong>Exercise 6.51  </strong></span>Solve the 1D wave equation
<span class="math display">\[ u_{tt} = u_{xx} \]</span>
with Dirichlet boundary conditions <span class="math inline">\(u(t,0) = 0.4 \sin(\pi t)\)</span> and <span class="math inline">\(u(t,1) = 0\)</span> along with initial condition <span class="math inline">\(u(0,x) = 0\)</span> and zero initial velocity. This time the left-hand boundary is being controlled externally and the string starts off at equilibrium. Give a physical situation where this sort of setup might arise. Then modify your solution so that both sides of the string are being wiggled at different frequencies.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-613" class="exercise"><strong>Exercise 6.52  </strong></span>Now consider the 2D wave equation
<span class="math display">\[ u_{tt} = c\left( u_{xx} + u_{yy} \right). \]</span>
We want to build a numerical solution to this new PDE. Just like with the 2D heat equation we propose the notation <span class="math inline">\(U_{i,j}^n\)</span> for the approximation of the function <span class="math inline">\(u(t,x,y)\)</span> at the point <span class="math inline">\(t=t_n\)</span>, <span class="math inline">\(x=x_i\)</span>, and <span class="math inline">\(y=y_j\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Give discretizations of the derivatives <span class="math inline">\(u_{tt}\)</span>, <span class="math inline">\(u_{xx}\)</span>, and <span class="math inline">\(u_{yy}\)</span>.<br />
</li>
<li>Substitute your discretizations into the 2D wave equation, make the simplifying assumption that <span class="math inline">\(\Delta x = \Delta y\)</span>, and solve for <span class="math inline">\(U_{i,j}^{n+1}\)</span>. This is the finite difference scheme for the 2D wave equation.</li>
<li>Write code to implement the finite difference scheme from part (b) on the domain <span class="math inline">\((x,y) \in (0,1)\times (0,1)\)</span> with homogeneous Dirichlet boundary conditions, initial condition <span class="math inline">\(u(0,x,y) = \sin(2\pi (x-0.5))\sin(2\pi(y-0.5))\)</span>, and zero initial velocity.</li>
<li>Draw the finite difference stencil for the 2D heat equation.</li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-614" class="exercise"><strong>Exercise 6.53  </strong></span>What is the region of stability for the finite difference scheme on the 2D wave equation? Produce several plots showing what happens when we are in the unstable region as well as when we are right on the edge of the stable region.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-615" class="exercise"><strong>Exercise 6.54  </strong></span>Solve the 2D wave equation on the unit square with <span class="math inline">\(u\)</span> starting at rest and being driven by a wave coming in from one boundary.
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="traveling-waves" class="section level2" number="6.7">
<h2><span class="header-section-number">6.7</span> Traveling Waves</h2>
<p>Now we turn our attention to a new PDE: the traveling wave equation
<span class="math display">\[ u_t + v u_x = 0. \]</span>
In this equation <span class="math inline">\(u(t,x)\)</span> is the height of a wave at time <span class="math inline">\(t\)</span> and spatial location <span class="math inline">\(x\)</span>. The parameter <span class="math inline">\(v\)</span> is the velocity of the wave. Imagine this as sending a single solitary wave pulsing down a taught rope or as sending a single pulse of light down a fiber optic cable.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-616" class="exercise"><strong>Exercise 6.55  </strong></span>Consider the PDE <span class="math inline">\(u_t + v u_x = 0\)</span>. There is a very easy way to get an analytic solution to this traveling wave equation. If we have the initial condition <span class="math inline">\(u(0,x) = f(x) = e^{-(x-4)^2}\)</span> then we claim that <span class="math inline">\(u(t,x) = f(x-vt)\)</span> is an analytic solution to the PDE. More explicitely, we are claiming that
<span class="math display">\[ u(t,x) = e^{-(x-vt-4)^2} \]</span>
is the analytic solution to the PDE. Let’s prove this.</p>
<ol style="list-style-type: lower-alpha">
<li>Take the <span class="math inline">\(t\)</span> derivative of <span class="math inline">\(u(t,x)\)</span>.</li>
<li>Take the <span class="math inline">\(x\)</span> derivative of <span class="math inline">\(u(t,x)\)</span>.</li>
<li>The PDE claims that <span class="math inline">\(u_t + vu_x = 0\)</span>. Verify that this equal sign is indeed true.</li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-617" class="exercise"><strong>Exercise 6.56  </strong></span>Now we would like to visualize the solution to the PDE from the previous exercise. The Python code below gives an interactive visual of the solution. Experiment with different values of <span class="math inline">\(v\)</span> and different initial conditions.
</div>
<div class="sourceCode" id="cb117"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb117-1"><a href="ch-pdes.html#cb117-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb117-2"><a href="ch-pdes.html#cb117-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb117-3"><a href="ch-pdes.html#cb117-3" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> matplotlib <span class="im">import</span> animation, rc</span>
<span id="cb117-4"><a href="ch-pdes.html#cb117-4" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> IPython.display <span class="im">import</span> HTML</span>
<span id="cb117-5"><a href="ch-pdes.html#cb117-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-6"><a href="ch-pdes.html#cb117-6" aria-hidden="true" tabindex="-1"></a>v <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb117-7"><a href="ch-pdes.html#cb117-7" aria-hidden="true" tabindex="-1"></a>f <span class="op">=</span> <span class="kw">lambda</span> x: np.exp(<span class="op">-</span>(x<span class="op">-</span><span class="dv">4</span>)<span class="op">**</span><span class="dv">2</span>)</span>
<span id="cb117-8"><a href="ch-pdes.html#cb117-8" aria-hidden="true" tabindex="-1"></a>u <span class="op">=</span> <span class="kw">lambda</span> t, x: f(x <span class="op">-</span> v<span class="op">*</span>t)</span>
<span id="cb117-9"><a href="ch-pdes.html#cb117-9" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb117-10"><a href="ch-pdes.html#cb117-10" aria-hidden="true" tabindex="-1"></a>t <span class="op">=</span> np.linspace(<span class="dv">0</span>,<span class="dv">10</span>,<span class="dv">100</span>)</span>
<span id="cb117-11"><a href="ch-pdes.html#cb117-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-12"><a href="ch-pdes.html#cb117-12" aria-hidden="true" tabindex="-1"></a>fig, ax <span class="op">=</span> plt.subplots()</span>
<span id="cb117-13"><a href="ch-pdes.html#cb117-13" aria-hidden="true" tabindex="-1"></a>plt.close()</span>
<span id="cb117-14"><a href="ch-pdes.html#cb117-14" aria-hidden="true" tabindex="-1"></a>ax.grid()</span>
<span id="cb117-15"><a href="ch-pdes.html#cb117-15" aria-hidden="true" tabindex="-1"></a>ax.set_xlabel(<span class="st">&#39;x&#39;</span>)</span>
<span id="cb117-16"><a href="ch-pdes.html#cb117-16" aria-hidden="true" tabindex="-1"></a>ax.set_xlim(( <span class="dv">0</span>, <span class="dv">10</span>))</span>
<span id="cb117-17"><a href="ch-pdes.html#cb117-17" aria-hidden="true" tabindex="-1"></a>ax.set_ylim(( <span class="op">-</span><span class="fl">0.1</span>, <span class="dv">1</span>))</span>
<span id="cb117-18"><a href="ch-pdes.html#cb117-18" aria-hidden="true" tabindex="-1"></a>frame, <span class="op">=</span> ax.plot([], [], linewidth<span class="op">=</span><span class="dv">2</span>, linestyle<span class="op">=</span><span class="st">&#39;--&#39;</span>)</span>
<span id="cb117-19"><a href="ch-pdes.html#cb117-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-20"><a href="ch-pdes.html#cb117-20" aria-hidden="true" tabindex="-1"></a><span class="kw">def</span> animator(N):</span>
<span id="cb117-21"><a href="ch-pdes.html#cb117-21" aria-hidden="true" tabindex="-1"></a>  ax.set_title(<span class="st">&#39;Time=&#39;</span><span class="op">+</span><span class="bu">str</span>(t[N]))</span>
<span id="cb117-22"><a href="ch-pdes.html#cb117-22" aria-hidden="true" tabindex="-1"></a>  frame.set_data(x,???) <span class="co"># plot the correct time step for u(t,x)</span></span>
<span id="cb117-23"><a href="ch-pdes.html#cb117-23" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> (frame,)</span>
<span id="cb117-24"><a href="ch-pdes.html#cb117-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-25"><a href="ch-pdes.html#cb117-25" aria-hidden="true" tabindex="-1"></a>PlotFrames <span class="op">=</span> <span class="bu">range</span>(<span class="dv">0</span>,<span class="bu">len</span>(t),<span class="dv">1</span>) </span>
<span id="cb117-26"><a href="ch-pdes.html#cb117-26" aria-hidden="true" tabindex="-1"></a>anim <span class="op">=</span> animation.FuncAnimation(fig, </span>
<span id="cb117-27"><a href="ch-pdes.html#cb117-27" aria-hidden="true" tabindex="-1"></a>                               animator, </span>
<span id="cb117-28"><a href="ch-pdes.html#cb117-28" aria-hidden="true" tabindex="-1"></a>                               frames<span class="op">=</span>PlotFrames, </span>
<span id="cb117-29"><a href="ch-pdes.html#cb117-29" aria-hidden="true" tabindex="-1"></a>                               interval<span class="op">=</span><span class="dv">100</span>, </span>
<span id="cb117-30"><a href="ch-pdes.html#cb117-30" aria-hidden="true" tabindex="-1"></a>                              )</span>
<span id="cb117-31"><a href="ch-pdes.html#cb117-31" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb117-32"><a href="ch-pdes.html#cb117-32" aria-hidden="true" tabindex="-1"></a>rc(<span class="st">&#39;animation&#39;</span>, html<span class="op">=</span><span class="st">&#39;jshtml&#39;</span>) <span class="co"># embed in the HTML for Google Colab</span></span>
<span id="cb117-33"><a href="ch-pdes.html#cb117-33" aria-hidden="true" tabindex="-1"></a>anim</span></code></pre></div>
<hr />

<div class="theorem">
<span id="thm:unnamed-chunk-619" class="theorem"><strong>Theorem 6.6  </strong></span>If <span class="math inline">\(u_t + v u_{x} = 0\)</span> with initial condition <span class="math inline">\(u(0,x) = f(x)\)</span> then the function <span class="math inline">\(u(t,x) = f(x-vt)\)</span> is an analytic solution to the PDE.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-620" class="exercise"><strong>Exercise 6.57  </strong></span>Use the chain rule to prove the previous theorem.
</div>
<hr />
<p>The traveling wave equation <span class="math inline">\(u_t + vu_x = 0\)</span> has a very nice analytic solution which we can always find. Therefore there is no need to ever find a numerical solution – we can just write down the analytic solution if we are given the initial condition. As it turns out though the numerical solutions exhibit some very interesting behavior.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-621" class="exercise"><strong>Exercise 6.58  </strong></span>Consider the traveling wave equation <span class="math inline">\(u_t + vu_x = 0\)</span> with initial condition <span class="math inline">\(u(0,x) = f(x)\)</span> for some given function <span class="math inline">\(f\)</span> and boundary condition <span class="math inline">\(u(t,0) = 0\)</span>. To build a numerical solution we will again adopt the notation <span class="math inline">\(U_i^n\)</span> for the approximation to <span class="math inline">\(u(t,x)\)</span> at the point <span class="math inline">\(t=t_n\)</span> and <span class="math inline">\(x=x_i\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Write an approximation of <span class="math inline">\(u_t\)</span> using <span class="math inline">\(U_i^{n+1}\)</span> and <span class="math inline">\(U_i^n\)</span>.</li>
<li>Write an approximation of <span class="math inline">\(u_x\)</span> using <span class="math inline">\(U_{i+1}^n\)</span> and <span class="math inline">\(U_i^n\)</span>.</li>
<li>Substitute your answers from parts (a) and (b) into the traveling wave equation and solve for <span class="math inline">\(U_i^{n+1}\)</span>. This is our first finite difference scheme for the traveling wave equation.<br />
</li>
<li>Write Python code to get the finite difference approximation of the solution to the PDE. Plot your finite difference solution on top of the analytic solution for <span class="math inline">\(f(x) = e^{-(x-4)^2}\)</span>. What do you notice? Can you stabilize this method by changing the values of <span class="math inline">\(\Delta t\)</span> and <span class="math inline">\(\Delta x\)</span> like with did with the heat and wave equations?</li>
</ol>
</div>
<hr />
<p>The finite difference scheme that you built in the previous exercise is called the downwind scheme for the traveling wave equation. Figure <a href="ch-pdes.html#fig:downwind-stencil">6.12</a> shows the finite difference stencil for this scheme. We call this scheme “downwind” since we expect the wave to travel from left to right and we can think of a fictitious wind blowing the solution from left to right. Notice that we are using information from “downwind” of the point at the new time step.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:downwind-stencil"></span>
<img src="images/Ch06_DownwindStencil.png" alt="The finite difference stencil for the 1D downwind scheme on the traveling wave equation." width="75%" />
<p class="caption">
Figure 6.12: The finite difference stencil for the 1D downwind scheme on the traveling wave equation.
</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-622" class="exercise"><strong>Exercise 6.59  </strong></span>You should have noticed in the previous exercise that you cannot reasonbly stabilize the finite difference scheme. Propose several reasons why this method appears to be unstable no matter what you use for the ratio <span class="math inline">\(v \Delta t / \Delta x\)</span>.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-623" class="exercise"><strong>Exercise 6.60  </strong></span>One of the troubles with the finite difference scheme that we have built for the traveling wave equation is that we are using the information at our present spatial location and the next spatial location to the right to propogate the solution forward in time. The trouble here is that the wave is moving from left to right, so the interesting information about the next time step’s solution is actually coming from the left, not the right. We call this “looking upwind” since you can think of a fictitious <em>wind</em> blowing from left to right, and we need to look “upwind” to see what is coming at us. If we write the spatial derivative as
<span class="math display">\[ u_x \approx \frac{U_i^n - U_{i-1}^n}{\Delta x}  \]</span>
we still have a first-order approximation of the derivative but we are now looking left instead of right for our spatial derivative. Make this modification in your finite difference code for the traveling wave equation (call it the “upwind method”). Approximate the solution to the same PDE as we worked with in the previous exercises. What do you notice now?
</div>
<hr />
<p>Figure <a href="ch-pdes.html#fig:upwind-stencil">6.13</a> shows the finite difference stencil for the upwind scheme. We call this scheme “up” since we expect the wave to travel from left to right and we can think of a fictitious wind blowing the solution from left to right. Notice that we are using information from “upwind” of the point at the new time step.</p>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:upwind-stencil"></span>
<img src="images/Ch06_UpwindStencil.png" alt="The finite difference stencil for the 1D downwind scheme on the traveling wave equation." width="75%" />
<p class="caption">
Figure 6.13: The finite difference stencil for the 1D downwind scheme on the traveling wave equation.
</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-624" class="exercise"><strong>Exercise 6.61  </strong></span>Complete the following sentences:</p>
<ol style="list-style-type: lower-alpha">
<li>In the downwind finite difference scheme for the traveling wave equation, the approximate solution moves at the correct speed, but …<br />
</li>
<li>In the upwind finite difference scheme for the traveling wave equation, the approximate solution moves at the correct speed, but …</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-625" class="exercise"><strong>Exercise 6.62  </strong></span>Neither the downwind nor the upwind solutions for the traveling wave equation are satisfactory. They completely miss the interesting dynamics of the analytic solution to the PDE. Some ideas for stabilizing the finite difference solution for the traveling wave equation are as follows. Implement each of these ideas and discuss pros and cons of each. Also draw a finite difference stencil for each of these methods.</p>
<ol style="list-style-type: lower-alpha">
<li>Perhaps one of the issues is that we are using first-order methods to approximate <span class="math inline">\(u_t\)</span> and <span class="math inline">\(u_x\)</span>. What if we used a second-order approximation for these first derivatives
<span class="math display">\[ u_t \approx \frac{U_i^{n+1} - U_i^{n-1}}{2\Delta t} \quad \text{ and } \quad u_x \approx \frac{U_{i+1}^n - U_{i-1}^n}{2\Delta x}? \]</span>
Solve for <span class="math inline">\(U_i^{n+1}\)</span> and implement this method. This is called the <strong>leapfrog method.</strong></li>
<li>For this next method let’s stick with the second-order approximation of <span class="math inline">\(u_x\)</span> but we’ll do something clever for <span class="math inline">\(u_t\)</span>. For the time derivative we originally used
<span class="math display">\[ u_t \approx \frac{U_i^{n+1} - U_i^n}{\Delta t} \]</span>
what happens if we replace <span class="math inline">\(U_i^n\)</span> with the average value from the two surrounding spatial points
<span class="math display">\[ U_i^n \approx \frac{1}{2} \left( U_{i+1}^n + U_{i-1}^n \right)? \]</span>
This would make our approximation of the time derivative
<span class="math display">\[ u_t \approx \frac{U_i^{n+1} - \frac{1}{2} \left( U_{i+1}^n + U_{i-1}^n \right)}{\Delta t}. \]</span>
Solve this modified finite difference equation for <span class="math inline">\(U_i^{n+1}\)</span> and implement this method. This is called the <strong>Lax-Friedrichs</strong> method.</li>
<li>Finally we’ll do something very clever (and very counter intuitive). What if we inserted some artificial diffusion into the problem? You know from your work with the heat equation that diffusion spreads a solution out. The downwind scheme seemed to have the issue that it was <em>bunching up</em> at the beginning and end of the wave, so artificial diffusion might smooth this out. The <strong>Lax-Wendroff method</strong> does exactly that: take a regular Euler-type step in time
<span class="math display">\[ u_t \approx \frac{U_i^{n+1} - U_i^n}{\Delta t}, \]</span>
use a second-order centered difference scheme in space to approximate <span class="math inline">\(u_x\)</span>
<span class="math display">\[ u_x \approx \frac{U_{i+1}^n - U_{i-1}^n}{2\Delta x}, \]</span>
but add on the term
<span class="math display">\[ \left( \frac{v^2 \Delta t^2}{2\Delta x^2} \right) \left( U_{i-1}^n - 2 U_i^n + U_{i+1}^n \right) \]</span>
to the right-hand side of the equation. Notice that this new term is a scalar multiple of the second-order approximation of the second derivative <span class="math inline">\(u_{xx}\)</span>. Solve this equation for <span class="math inline">\(U_i^{n+1}\)</span> and implement the Lax-Wendroff method.</li>
</ol>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="the-laplace-and-poisson-equations" class="section level2" number="6.8">
<h2><span class="header-section-number">6.8</span> The Laplace and Poisson Equations</h2>

<div class="exercise">
<p><span id="exr:unnamed-chunk-626" class="exercise"><strong>Exercise 6.63  </strong></span>Consider the 1D heat equation <span class="math inline">\(u_t = 1 u_{xx}\)</span> with boundary conditions <span class="math inline">\(u(t,0) = 0\)</span> and <span class="math inline">\(u(t,1)=1\)</span> and initial condition <span class="math inline">\(u(0,x) = 0\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Describe the physical setup for this problem.<br />
</li>
<li>Recall that the solution to a differential equation reaches a steady state (or equilibrium) when the time rate of change is zero. Based on the physical system, what is the steady state heat profile for this PDE?</li>
<li>Use your 1D heat equation code to show the full time evolution of this PDE. Run the simulation long enough so that you see the steady state heat profile.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-627" class="exercise"><strong>Exercise 6.64  </strong></span>Now consider the forced 1D heat equation <span class="math inline">\(u_t = u_{xx} + e^{-(x-0.5)^2}\)</span> with the same boundary and initial conditions as the previous exercise. The exponential forcing function introduced in this equation is an external source of heat (like a flame held to the middle of the metal rod).</p>
<ol style="list-style-type: lower-alpha">
<li>Conjecture what the steady state heat profile will look like for this particular setup. Be able to defend your answer.</li>
<li>Modify your 1D heat equation code to show the full time evolution of this PDE. Run the simulation long enough so that you see the steady state heat profile.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-628" class="exercise"><strong>Exercise 6.65  </strong></span>Next we’ll examine 2D steady state heat profiles. Consider the PDE <span class="math inline">\(u_t = u_{xx} + u_{yy}\)</span> with boundary conditions <span class="math inline">\(u(t,0,y) = u(t,x,0) = u(t,x,1) = 0\)</span> and <span class="math inline">\(u(t,1,y) = 1\)</span> with initial condition <span class="math inline">\(u(0,x,y) = 0\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li>Describe the physical setup for this problem.</li>
<li>Based on the physical system, describe the steady state heat profile for this PDE. Be sure that your steady state solution still satisfies the boundary conditions.</li>
<li>Use your 2D heat equation code to show the full time evolution of this PDE. Run the simulation long enough so that you see the steady state heat profile.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-629" class="exercise"><strong>Exercise 6.66  </strong></span>Now consider the forced 2D heat equation <span class="math inline">\(u_t = u_{xx} + u_{yy} + 10e^{-(x-0.5)^2-(y-0.5)^2}\)</span> with the same boundary and initial conditions as the previous exercise. The exponential forcing function introduced in this equation is an external source of heat (like a flame held to the middle of the metal sheet).</p>
<ol style="list-style-type: lower-alpha">
<li>Conjecture what the steady state heat profile will look like for this particular setup. Be able to defend your answer.</li>
<li>Modify your 2D heat equation code to show the full time evolution of this PDE. Run the simulation long enough so that you see the steady state heat profile.</li>
</ol>
</div>
<hr />
<p>Up to this point we have studied PDEs that all depend on time. In many applications, however, we are not interested in the transient (time dependent) behavior of a system. Instead we are often interested in the steady state solution when the forces in question are in static equilibrium. Two very famous time-independent PDEs are the Laplace Equation
<span class="math display">\[ u_{xx} + u_{yy} + u_{zz} = 0 \]</span>
and the Poisson equation
<span class="math display">\[ u_{xx} + u_{yy} + u_{zz} = f(x,y,z). \]</span>
Notice that both the Laplace and Poisson equations are the equations that we get when we consider the limit <span class="math inline">\(u_t \to 0\)</span>. In the limit when the time rate of change goes to zero we are actually just looking at the eventual steady state heat profile resulting from the initial and boundary conditions of the heat equation. In the previous exercises you already wrote code that will show the steady state profiles in a few setups. The trouble with the approach of letting the time-dependent simulation run for a <em>long time</em> is that the finite difference solution for the heat equation is known to have stability issues. Moreover, it may take a lot of computational time for the solution to reach the eventual steady state. In the remainder of this section we look at methods of solving for the steady state directly – without examining any of the transient behavior. We will first examine a 1D version of the Laplace and Poisson equations.</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-630" class="exercise"><strong>Exercise 6.67  </strong></span>Consider a 1-dimensional rod that is infinitely thin and has unit length. For the sake of simplicity assume the following:</p>
<ul>
<li>the specific heat of the rod is exactly 1 for the entire length of the rod,</li>
<li>the temperature of the left end is held fixed at <span class="math inline">\(u(0) = 0\)</span>,</li>
<li>the temperature of the right end is held fixed at <span class="math inline">\(u(1) = 1\)</span>, and</li>
<li>the temperature has reached a steady state.</li>
</ul>
<p>You can assume that the temperatures are <em>reference temperatures</em> instead of absolute temperatures, so a temperature of “0” might represent room temperature.</p>
<p>Since there are no external sources of heat we model the steady-state heat profile we must have <span class="math inline">\(u_t = 0\)</span> in the heat equation. Thus the heat equation collapses to <span class="math inline">\(u_{xx} = 0\)</span>. This is exactly the one dimensional Laplace equation.</p>
<ol style="list-style-type: lower-alpha">
<li>To get an exact solution of the Laplace equation in this situation we simply need to integrate twice. Do the integration and write the analytic solution (there should be no surprises here).</li>
<li>To get a numerical solution we first need to partition the domain into finitely many point. For the sake of simplicity let’s say that we subdivide the interval into 5 equal sub intervals (so there are 6 points including the endpoints). Furthermore, we know that we can approximate <span class="math inline">\(u_{xx}\)</span> as
<span class="math display">\[ u_{xx} \approx \frac{U_{i+1} - 2U_i + U_{i-1}}{\Delta x^2}. \]</span>
Thus we have 6 linear equations:
<span class="math display">\[\begin{aligned}
U_0 &amp;= 1 \quad \text{(left boundary condition)}\\
\frac{U_2 - 2U_1 + U_0}{\Delta x^2} &amp;= 0 \\ 
\frac{U_3 - 2U_2 + U_1}{\Delta x^2} &amp;= 0 \\ 
\frac{U_4 - 2U_3 + U_2}{\Delta x^2} &amp;= 0 \\ 
\frac{U_5 - 2U_4 + U_3}{\Delta x^2} &amp;= 0 \\ 
U_5 &amp;= 0 \quad \text{(right boundary condition).}
\end{aligned}\]</span>
Notice that there are really only four unknowns since the boundary conditions dictate two of the temperature values. Rearrange this system of equations into a matrix equation and solve for the unknowns <span class="math inline">\(U_1\)</span>, <span class="math inline">\(U_2\)</span>, <span class="math inline">\(U_3\)</span>, and <span class="math inline">\(U_4\)</span>. Your coefficient matrix should be <span class="math inline">\(4 \times 4\)</span>.</li>
<li>Compare your answers from parts (a) and (b).</li>
<li>Write code to build the numerical solution with an arbitrary value for <span class="math inline">\(\Delta x\)</span> (i.e. an arbitrary number of sub intervals). You should build the linear system automatically in your code.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-631" class="exercise"><strong>Exercise 6.68  </strong></span>Solve the 1D Laplace equation with Dirichlet boundary conditions is rather uninteresting since the answer will alway be a linear function connecting the two boundary conditions. Prove this.</p>
</div>
<hr />
<p>The Poisson equation, <span class="math inline">\(u_{xx} = f(x)\)</span>, is more interesting than the Laplace equation in 1D. The function <span class="math inline">\(f(x)\)</span> is called a forcing function. You can think of it this way: if <span class="math inline">\(u\)</span> is the amount of force on a linear bridge, then <span class="math inline">\(f\)</span> might be a function that gives the distribution of the forces on the bridge due to the cars sitting on the bridge. In terms of heat we can think of this as an external source of heat energy warming up the one-dimensional rod somewhere in the middle (like a flame being held to one place on the rod).</p>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-632" class="exercise"><strong>Exercise 6.69  </strong></span>How would we analytically solve the Poisson equation <span class="math inline">\(u_{xx} = f(x)\)</span> in one spatial dimension? As a sample problem consider <span class="math inline">\(x\in [0,1]\)</span>, the forcing function <span class="math inline">\(f(x) = 5\sin(2 \pi x)\)</span> and boundary conditions <span class="math inline">\(u(0) = 2\)</span> and <span class="math inline">\(u(1) = 0.5\)</span>. Of course you need to check your answer by taking two derivatives and making sure that the second derivative exactly matches <span class="math inline">\(f(x)\)</span>. Also be sure that your solution matches the boundary conditions exactly.</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-633" class="exercise"><strong>Exercise 6.70  </strong></span>Now we can solve the Poisson equation from the previous problem numerically. Let’s again build this with a partition that contains only 6 points just like we did with the Laplace equation a few exercise ago. We know the approximation for <span class="math inline">\(u_{xx}\)</span> so we have the linear system
<span class="math display">\[\begin{aligned}
U_0 &amp;= 2 \quad \text{(left boundary condition)}\\
\frac{U_2 - 2U_1 + U_0}{\Delta x^2} &amp;= f(x_1) \\ 
\frac{U_3 - 2U_2 + U_1}{\Delta x^2} &amp;= f(x_2) \\ 
\frac{U_4 - 2U_3 + U_2}{\Delta x^2} &amp;= f(x_3) \\ 
\frac{U_5 - 2U_4 + U_3}{\Delta x^2} &amp;= f(x_4) \\ 
U_5 &amp;= 0.5 \quad \text{(right boundary condition).}
\end{aligned}\]</span></p>
<ol style="list-style-type: lower-alpha">
<li>Rearrange the system of equations as a matrix equation and then solve the system for <span class="math inline">\(U_1, U_2, U_3\)</span>, and <span class="math inline">\(U_4\)</span>. There are really only four equations so your matrix should be <span class="math inline">\(4 \times 4\)</span>.</li>
<li>Compare your solution from part (a) to the function values that you found in the previous exercise.</li>
<li>Now generalize the process of solving the 1D Poisson equation for an arbitrary value of <span class="math inline">\(\Delta x\)</span>. You will need to build the matrix and the right-hand side in your code. Test your code on new forcing functions and new boundary conditions.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-634" class="exercise"><strong>Exercise 6.71  </strong></span>The previous exercises only account for Dirichlet boundary conditions (fixed boundary conditions). We would now like to modify our Poisson solution to allow for a Neumann condition: where we know the derivative of <span class="math inline">\(u\)</span> at one of the boundaries. The statement of the problem is as follows:
<span class="math display">\[\text{Solve: } u_{xx} = f(x) \quad \text{on} \quad x \in (0,1) \quad \text{with} \quad u_x(0) = \alpha \quad \text{and} \quad u(1) = \beta.\]</span>
The derivative condition on the boundary can be approximated by using a first-order approximation of the derivative, and as a consequence we have one new equation. Specifically, if we know that <span class="math inline">\(u_x(0) = \alpha\)</span> then we can approximate this condition as
<span class="math display">\[ \frac{U_1 - U_0}{\Delta x} = \alpha, \]</span>
and we simply need to add this equation to the system that we were solving in the previous exercise. If we go back to our example of a partition with 6 points the system becomes
<span class="math display">\[\begin{aligned}
\frac{U_1 - U_0}{\Delta x} &amp;= \alpha \quad \text{(left boundary condition)}\\
\frac{U_2 - 2U_1 + U_0}{\Delta x^2} &amp;= f(x_1) \\ 
\frac{U_3 - 2U_2 + U_1}{\Delta x^2} &amp;= f(x_2) \\ 
\frac{U_4 - 2U_3 + U_2}{\Delta x^2} &amp;= f(x_3) \\ 
\frac{U_5 - 2U_4 + U_3}{\Delta x^2} &amp;= f(x_4) \\ 
U_5 &amp;= \beta \quad \text{(right boundary condition).}
\end{aligned}\]</span>
There are 5 equations this time.</p>
<ol style="list-style-type: lower-alpha">
<li>With a 6 point grid solve the Poisson equation <span class="math inline">\(u_{xx} = 5\sin(2\pi x)\)</span> with <span class="math inline">\(u_x(0) = 0\)</span> and <span class="math inline">\(u(1) = 3\)</span>.</li>
<li>Modify your code from part (a) to solve the same problem but with a much smaller value of <span class="math inline">\(\Delta x\)</span>. You will need to build the matrix equation in your code.</li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:poisson2dhomog" class="exercise"><strong>Exercise 6.72  </strong></span>(<strong>The 2D Poisson Equation</strong>) We conclude this section, and chapter, by examining the two dimensional Poisson equations. As a sample problem, we want to solve the Poisson equation <span class="math inline">\(u_{xx} + u_{yy} = f(x,y)\)</span> on the domain <span class="math inline">\((x,y) \in (0,1)\times (0,1)\)</span> with homogenous Dirichlet boundary conditions and focing function <span class="math inline">\(f(x,y) = -20\text{exp}\left( -\frac{(x-0.5)^2 + (y-0.5)^2}{0.05} \right)\)</span> numerically. We are going to start with a <span class="math inline">\(6 \times 6\)</span> grid of points and explicitly write down all of the equations. In Figure <a href="ch-pdes.html#fig:poisson2d">6.14</a> the red stars represent boundary points where the value of <span class="math inline">\(u(x,y)\)</span> is known and the blue interior points are the ones where <span class="math inline">\(u(x,y)\)</span> is yet unknown. It should be clear that we should have two indices for each point (one for the <span class="math inline">\(x\)</span> position and one for the <span class="math inline">\(y\)</span> position), but it should also be clear that this will cause problems when writing down the resulting system of equations as a matrix equation (stop and think carefully about this). Therefore, in Figure <a href="ch-pdes.html#fig:poisson2d">6.14</a> we propose an index, <span class="math inline">\(k\)</span>, starting at the top left of the uninown nodes and reading left to right (just like we do with Python arrays).</p>
<ol style="list-style-type: lower-alpha">
<li>Start by discretizing the 2D Poisson equation <span class="math inline">\(u_{xx} + u_{yy} = f(x,y)\)</span>. For simplicity we assume that <span class="math inline">\(\Delta x = \Delta y\)</span> so that we can combine like terms from the <span class="math inline">\(x\)</span> derivative and the <span class="math inline">\(y\)</span> derivative. Fill in the missing coefficients and indices below.
<span class="math display">\[U_{i+1,j} + U_{i,j-1} - (\underline{\hspace{0.2in}}) U_{\underline{\hspace{0.2in}},\underline{\hspace{0.2in}}} + U_{\underline{\hspace{0.2in}},\underline{\hspace{0.2in}}} + U_{\underline{\hspace{0.2in}},\underline{\hspace{0.2in}}} = \Delta x^2 f(x_i,y_i)\]</span></li>
<li>In Figure <a href="ch-pdes.html#fig:poisson2d">6.14</a> we see that there are 16 total equations resulting from the discretization of the Poisson equation. Your first task is to write all 16 of these equations. We’ll get you started:</li>
</ol>
<p><span class="math display">\[\begin{aligned}
\text{$k=0$: } &amp;\quad U_{k=1} + {\color{red} U_{i=1,j=0} } - 4U_{k=0} + {\color{red} U_{i=0,j=1} } + U_{k=4} = \Delta x^2 f(x_1,y_1) \\
\text{$k=1$: } &amp;\quad U_{k=2} + U_{k=0} - 4U_{k=1} + {\color{red} U_{i=0,j=2} } + U_{k=5} = \Delta x^2 f(x_1,y_2) \\
&amp; \qquad \vdots \\
\text{$k=15$: } &amp;\quad {\color{red} U_{i=4,j=5}} + U_{k=14} - 4 U_{k=15} + U_{k=11} + {\color{red} U_{i=5,j=4}} = \Delta x^2 f(x_4,y_4)
\end{aligned}\]</span></p>
<p>In this particular example we have homogeneous Dirichlet boundary conditions so all of the boundary values are zero. If this was not the case then every boundary value would need to be moved to the right-hand sides of the equations.
c. We now have a <span class="math inline">\(16 \times 16\)</span> matrix equation to write based on the equations from part (b). Each row and column of the matrix equation is indexed by <span class="math inline">\(k\)</span>. The coefficient matrix <span class="math inline">\(A\)</span> is started for you below. Write the whole thing out and fill in the blanks. Notice that this matrix has a much more complicated structure than the coefficient matrix in the 1D Poisson and Laplace equations.</p>
<p><span class="math display">\[A = \begin{pmatrix} -4 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\ 1 &amp; -4 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; 0 &amp; \cdots &amp; 0 \\ 0 &amp; 1 &amp; -4 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; 0 &amp; \cdots &amp; 0 \\ 0 &amp; 0 &amp; 1 &amp; -4 &amp; 1 &amp; 0 &amp; 0 &amp; 1 &amp; &amp;  \\ 1 &amp; 0 &amp; 0 &amp; 0 &amp; -4 &amp; 1 &amp; 0 &amp; 0 &amp; \ddots &amp; \\ 0 &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\ \vdots &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\ &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; \\ &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; &amp; -4 \\ \end{pmatrix}\]</span></p>
<ol start="4" style="list-style-type: lower-alpha">
<li>In the coefficient matrix from part (c) notice that the small matrix
<span class="math display">\[\begin{pmatrix} -4 &amp; 1 &amp; 0 &amp; 0 \\ 1 &amp; -4 &amp; 1 &amp; 0 \\ 0 &amp; 1 &amp; -4 &amp; 1 \\ 0 &amp; 0 &amp; 1 &amp; -4 \end{pmatrix}\]</span>
shows up in blocks along the main diagonal. If you have a hard copy of the matrix go back and draw a box around these blocks in the coefficient matrix. Also notice that there are diagonal bands of <span class="math inline">\(1^s\)</span>. Discuss the following:
<ol style="list-style-type: lower-roman">
<li>Why are the blocks <span class="math inline">\(4 \times 4\)</span>?</li>
<li>How could you have predicted the location of the diagonal bands of <span class="math inline">\(1^s\)</span>?</li>
<li>What would the structure of the matrix look like if we partitioned the domain into a <span class="math inline">\(10 \times 10\)</span> grid of points instead of a <span class="math inline">\(6 \times 6\)</span> grid (including the boundary points)?</li>
<li>Why is it helpful to notice this structure?</li>
</ol></li>
<li>The right-hand side of the matrix equation resulting the your system of equations from part (b) is
<span class="math display">\[\boldsymbol{b} = \Delta x^2 \begin{pmatrix} f(x_1,y_1) \\ f(x_1,y_2) \\ f(x_1,y_3) \\ f(x_1,y_4) \\ f(x_2,y_1) \\ f(x_2,y_2) \\ \vdots \\ \\ f(x_4,y_y) \end{pmatrix}.\]</span>
Notice the structure of this vector. Why is it structured this way? Why is it useful to notice this?</li>
<li>Write Python code to solve the problem at hand. Recall that <span class="math inline">\(f(x,y) = -20\exp\left(-\frac{-(x-0.5)^2+(y-0.5)^2}{0.05}\right)\)</span>. Show a contour plot of your solution. This will take a little work changing the indices back from <span class="math inline">\(k\)</span> to <span class="math inline">\(i\)</span> and <span class="math inline">\(j\)</span>. Think carefully about how you want to code this before you put fingers to keyboard. You might want to use the <code>np.block()</code> command to build the coefficient matrix efficiently or you can use loops with carefully chosen indices.</li>
<li>(Challenge) Generalize your code to solve the Poisson equation with a much smaller value of <span class="math inline">\(\Delta x = \Delta y\)</span>.</li>
<li>One more significant observation should be made about the 2D Poisson equation on this square domain. Notice that the corner points of the domain (e.g. <span class="math inline">\(i=0, j=0\)</span> or <span class="math inline">\(i=5, j=0\)</span>) are never included in the system of equations. What does this mean about trying to enforce boundary conditions that only apply at the corners?</li>
</ol>
</div>
<div class="figure" style="text-align: center"><span style="display:block;" id="fig:poisson2d"></span>
<img src="images/Ch06_2DPoisson.png" alt="A finite difference grid for the Poisson equation with 6 grid points in each direction." width="95%" />
<p class="caption">
Figure 6.14: A finite difference grid for the Poisson equation with 6 grid points in each direction.
</p>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
<div id="exercises-5" class="section level2" number="6.9">
<h2><span class="header-section-number">6.9</span> Exercises</h2>
<div id="algorithm-summaries-4" class="section level3" number="6.9.1">
<h3><span class="header-section-number">6.9.1</span> Algorithm Summaries</h3>

<div class="exercise">
<p><span id="exr:unnamed-chunk-635" class="exercise"><strong>Exercise 6.73  </strong></span>Explain in clear language what it means to check an analytic solution to
a differential equation.</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-636" class="exercise"><strong>Exercise 6.74  </strong></span>Explain in clear language what Dirichlet boundary conditions are.</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-637" class="exercise"><strong>Exercise 6.75  </strong></span>Explain in clear language what Neumann boundary conditions are.</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-638" class="exercise"><strong>Exercise 6.76  </strong></span>Show the full mathematical details for building a first-order in time
and second-order in space approximation method for the one-dimensional
heat equation. Explain what the order of the error means in this context</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-639" class="exercise"><strong>Exercise 6.77  </strong></span>Show the full mathematical details for building a second-order in time
and second-order in space approximation method for the one-dimensional
wave equation. Explain what the order of the error means in this context</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-640" class="exercise"><strong>Exercise 6.78  </strong></span>Show the full mathematical details for building a first-order in time
and second-order in space approximation method for the two-dimensional
heat equation. Explain what the order of the error means in this context</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-641" class="exercise"><strong>Exercise 6.79  </strong></span>Show the full mathematical details for building a second-order in time
and second-order in space approximation method for the two-dimensional
wave equation. Explain what the order of the error means in this context</p>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-642" class="exercise"><strong>Exercise 6.80  </strong></span>Explain in clear language what it means for a finite difference method to be stable vs unstable.</p>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-643" class="exercise"><strong>Exercise 6.81  </strong></span>Show the full mathematical details for solving the 1D heat equation using the implicit and Crank-Nicolson methods.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-644" class="exercise"><strong>Exercise 6.82  </strong></span>Show the full mathematical details for building a downwind finite difference scheme for the traveling wave equation. Discuss the primary disadvantages of the downwind scheme.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-645" class="exercise"><strong>Exercise 6.83  </strong></span>Show the full mathematical details for building an upwind finite difference scheme for the traveling wave equation. Discuss the primary disadvantages of the upwind scheme.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-646" class="exercise"><strong>Exercise 6.84  </strong></span>Show the full mathematical details for numerically solving the 1D Laplace and Poisson equations.
</div>
<hr />
</div>
<div id="applying-what-youve-learned-5" class="section level3" number="6.9.2">
<h3><span class="header-section-number">6.9.2</span> Applying What You’ve Learned</h3>

<div class="exercise">
<p><span id="exr:unnamed-chunk-647" class="exercise"><strong>Exercise 6.85  </strong></span>In this problem we will solve a more realistic 1D heat equation. We will
allow the diffusivity to change spatially, so <span class="math inline">\(D = D(x)\)</span> and we want to
solve <span class="math display">\[u_t = \left( D(x) u_x \right)_x\]</span> on <span class="math inline">\(x \in (0,1)\)</span> with
Dirichlet boundary conditions <span class="math inline">\(u(t,0) = u(t,1) = 0\)</span> and initial
condition <span class="math inline">\(u(0,x) = \sin(2 \pi x)\)</span>. This is “more realistic” since it
would be rare to have a perfectly homogenous medium, and the function
<span class="math inline">\(D\)</span> reflects any heterogeneities in the way the diffusion occurs. In
this problem we will take <span class="math inline">\(D(x)\)</span> to be the parabola <span class="math inline">\(D(x)= x^3(1-x)\)</span>. We
start by doing some calculus to rewrite the differential equation:
<span class="math display">\[u_t = D(x) u_{xx}(x) + D&#39;(x) u_x(x).\]</span></p>
<p>Your jobs are:</p>
<ol style="list-style-type: lower-alpha">
<li><p>Describe what this choice of <span class="math inline">\(D(x)\)</span> might mean physically in the
heat equation.</p></li>
<li><p>Write an explicit scheme to solve this problem by using centered
differences for the spatial derivatives and an Euler-type
discretization for the temporal derivative. Write a clear and
thorough explanation for how you are doing the discretization as
well as a discussion for the errors that are being made with each
discretization.</p></li>
<li><p>Write a script to find an approximate solution to this problem.</p></li>
<li><p>Write a clear and thorough discussion about how your will choose
<span class="math inline">\(\Delta x\)</span> and <span class="math inline">\(\Delta t\)</span> to give stable solutions to this equation.</p></li>
<li><p>Graphically compare your solution to this problem with a heat
equation where <span class="math inline">\(D\)</span> is taken to be the constant average diffusivity
found by calculating <span class="math inline">\(D_{ave} = \int_0^1 D(x) dx.\)</span> How does the
changing diffusivity change the shape of the solution?</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-648" class="exercise"><strong>Exercise 6.86  </strong></span>In a square domain create a function <span class="math inline">\(u(0,x,y)\)</span> that looks like your
college logo. The simplest way to do this might be to take a photo of
the logo, crop it to a square, and use the <code>scipy.ndimage.imread</code> command to read in the image.
Use this function as the initial condition for the heat equation on a
square domain with homogeneous Dirichlet boundary conditions.
Numerically solve the heat equation and show an animation for what
happens to the logo as time evolves.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-649" class="exercise"><strong>Exercise 6.87  </strong></span>Repeat the previous exercise but this time solve the wave equation with
the logo as the initial condition.
</div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-650" class="exercise"><strong>Exercise 6.88  </strong></span>The explicit finite difference scheme that we built for the 1D heat equation in this chapter has error on the order of <span class="math inline">\(\mathcal{O}(\Delta t) + \mathcal{O}(\Delta x^2)\)</span>. Explain clearly what this means. Then devise a numerical experiment to empirically test this fact. Clearly explain your thought process and show sufficient plots and mathematics to support your work.
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-651" class="exercise"><strong>Exercise 6.89  </strong></span>Suppose that we have a concrete slab that is 10 meters in length, with
the left boundary held at a temperature of <span class="math inline">\(75^\circ\)</span> and the right
boundary held at a temperature of <span class="math inline">\(90^\circ\)</span>. Assume that the thermal
diffusivity of concrete is about <span class="math inline">\(k = 10^{-5}\)</span> m<span class="math inline">\(^2\)</span>/s. Assume that the
initial temperature of the slab is given by the function
<span class="math inline">\(T(x) = 75 + 1.5x - 20 \sin( \pi x / 10)\)</span>. In this case, the temperature
can be analytically solved by the function
<span class="math inline">\(T(t,x) = 75 + 1.5x - 20 \sin(\pi x / 10)  e^{-ct}\)</span> for some value of <span class="math inline">\(c\)</span>.</p>
<ol style="list-style-type: lower-alpha">
<li><p>Working by hand (no computers!) test the proposed analytic solution by substituting
it into the 1D heat equation and verifying that it is indeed a
solution. In doing so you will be able to find the correct value of
<span class="math inline">\(c\)</span>.</p></li>
<li><p>Write numerical code to solve this 1D heat equation. The output of
your code should be an animation showing how the error between the
numerical solution and the analytic solution evolve in time.</p></li>
</ol>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-652" class="exercise"><strong>Exercise 6.90  </strong></span>(This problem is modified from <span class="citation"><a href="#ref-simiodeheat" role="doc-biblioref">[11]</a></span>. The data given below is real experimental data provided courtesy of the authors.)</p>
<p>Harry and Sally set up an experiment to gather data specifically for the heat diffusion through a long thin metal rod. Their experimental setup was as follows.</p>
<ul>
<li>The ends of the rod are submerged in water baths at different temperatures and the heat from the hot water bath (on the right hand side) travels through the metal to the cooler end (on the left hand side).</li>
<li>The temperature of the rod is measured at four locations; those measurements are sent to a Raspberry Pi, which processes the raw data and sends the collated data to be displayed on the computer screen.</li>
<li>They used a metal rod of length <span class="math inline">\(L = 300 mm\)</span> and square cross-sectional width <span class="math inline">\(3.2 mm\)</span>.<br />
</li>
<li>The temperature sensors were placed at <span class="math inline">\(x_1 = 47mm\)</span>, <span class="math inline">\(x_2 = 94mm\)</span>, <span class="math inline">\(x_3 = 141mm\)</span>, and <span class="math inline">\(x_4 = 188mm\)</span> as measured from the cool end (the left end).</li>
<li>Foam tubing, with a thickness of 25 mm, was wrapped around the rod and sensors to provide some insulation.</li>
<li>The ambient temperature in the room was <span class="math inline">\(22^\circ C\)</span> and the cool water bath is a large enough reservoir that the left side of the rod is kept at <span class="math inline">\(22^\circ C\)</span>.</li>
</ul>
<p>The data table below gives temperature measurements at 60 second intervals for each of the four sensors.</p>
<table>
<thead>
<tr class="header">
<th>Time (sec)</th>
<th>Sensor 188</th>
<th>Sensor 141</th>
<th>Sensor 94</th>
<th>Sensor 47</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>0</td>
<td>22.8</td>
<td>22</td>
<td>22</td>
<td>22</td>
</tr>
<tr class="even">
<td>60</td>
<td>29.3</td>
<td>24.4</td>
<td>23.2</td>
<td>22.8</td>
</tr>
<tr class="odd">
<td>120</td>
<td>35.7</td>
<td>27.5</td>
<td>25.9</td>
<td>25.2</td>
</tr>
<tr class="even">
<td>180</td>
<td>41.8</td>
<td>30.3</td>
<td>27.9</td>
<td>26.8</td>
</tr>
<tr class="odd">
<td>240</td>
<td>45.8</td>
<td>33.8</td>
<td>30.6</td>
<td>29.2</td>
</tr>
<tr class="even">
<td>300</td>
<td>48.2</td>
<td>36.5</td>
<td>32.6</td>
<td>31.2</td>
</tr>
<tr class="odd">
<td>360</td>
<td>50.6</td>
<td>37.7</td>
<td>34.2</td>
<td>32</td>
</tr>
<tr class="even">
<td>420</td>
<td>53.4</td>
<td>38.5</td>
<td>34.9</td>
<td>32.8</td>
</tr>
<tr class="odd">
<td>480</td>
<td>53</td>
<td>38.9</td>
<td>35.3</td>
<td>33.6</td>
</tr>
<tr class="even">
<td>540</td>
<td>53</td>
<td>40.4</td>
<td>36.5</td>
<td>34.8</td>
</tr>
<tr class="odd">
<td>600</td>
<td>55.1</td>
<td>41.2</td>
<td>37.3</td>
<td>35.2</td>
</tr>
<tr class="even">
<td>660</td>
<td>54.7</td>
<td>42</td>
<td>38.1</td>
<td>35.6</td>
</tr>
<tr class="odd">
<td>720</td>
<td>54.7</td>
<td>42.4</td>
<td>38.1</td>
<td>36</td>
</tr>
<tr class="even">
<td>780</td>
<td>54.7</td>
<td>42.4</td>
<td>38.1</td>
<td>36.4</td>
</tr>
<tr class="odd">
<td>840</td>
<td>54.7</td>
<td>42</td>
<td>38.5</td>
<td>36</td>
</tr>
<tr class="even">
<td>900</td>
<td>57.5</td>
<td>41.2</td>
<td>37.7</td>
<td>35.6</td>
</tr>
<tr class="odd">
<td>960</td>
<td>56.3</td>
<td>40.8</td>
<td>37.3</td>
<td>35.6</td>
</tr>
</tbody>
</table>
<ol style="list-style-type: lower-alpha">
<li>At time time <span class="math inline">\(t=960\)</span> seconds the temperatures of the rod are essentially at a steady state. Use this data to make a prediction of the temperature of the hot water bath located at <span class="math inline">\(x=300mm\)</span>.<br />
</li>
<li>The thermal diffusivity, <span class="math inline">\(D\)</span>, of the metal is unknown. Use your numerical solution in conjunction with the data to approximate the value of <span class="math inline">\(D\)</span>. Be sure to fully defend your process.</li>
<li>It is unlikely that your numerical solution to the heat equation and the data from part (b) match very well. What are some sources of error in the data or in the heat equation model?</li>
</ol>
You can load the data directly with the following code.
</div>
<div class="sourceCode" id="cb118"><pre class="sourceCode python"><code class="sourceCode python"><span id="cb118-1"><a href="ch-pdes.html#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb118-2"><a href="ch-pdes.html#cb118-2" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> pandas <span class="im">as</span> pd</span>
<span id="cb118-3"><a href="ch-pdes.html#cb118-3" aria-hidden="true" tabindex="-1"></a>URL1 <span class="op">=</span> <span class="st">&#39;https://raw.githubusercontent.com/NumericalMethodsSullivan&#39;</span></span>
<span id="cb118-4"><a href="ch-pdes.html#cb118-4" aria-hidden="true" tabindex="-1"></a>URL2 <span class="op">=</span> <span class="st">&#39;/NumericalMethodsSullivan.github.io/master/data/&#39;</span></span>
<span id="cb118-5"><a href="ch-pdes.html#cb118-5" aria-hidden="true" tabindex="-1"></a>URL <span class="op">=</span> URL1<span class="op">+</span>URL2</span>
<span id="cb118-6"><a href="ch-pdes.html#cb118-6" aria-hidden="true" tabindex="-1"></a>data <span class="op">=</span> np.array( pd.read_csv(URL<span class="op">+</span><span class="st">&#39;Exercise6_1dheatdata.csv&#39;</span>) )</span>
<span id="cb118-7"><a href="ch-pdes.html#cb118-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Exercise6_1dheatdata.csv</span></span></code></pre></div>
<hr />

<div class="exercise">
<span id="exr:unnamed-chunk-654" class="exercise"><strong>Exercise 6.91  </strong></span>You may recall from your differential equations class that population growth under limited resources is goverened by the logistic equation <span class="math inline">\(x&#39; = k_1x(1-x/k_2)\)</span> where <span class="math inline">\(x=x(t)\)</span> is the population, <span class="math inline">\(k_1\)</span> is the intrinsic growth rate of the population, and <span class="math inline">\(k_2\)</span> is the carrying capacity of the population. The carrying capacity is the maximum population that can be supported by the environment. The trouble with this model is that the species is presumed to be fixed to a spatial location. Let’s make a modification to this model that allows the species to spread out over time while they reproduce. We have seen throughout this chapter that the heat equation <span class="math inline">\(u_t = D(u_{xx} + u_{yy})\)</span> models the diffusion of a substance (like heat or concentration). We therefore propose the model<br />
<span class="math display">\[ \frac{\partial u}{\partial t} = k_1 u \left( 1 - \frac{u}{k_2} \right) + D \left( \frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} \right)  \]</span>
where <span class="math inline">\(u(t,x,y)\)</span> is the population density of the species at time <span class="math inline">\(t\)</span> and spatial point <span class="math inline">\((x,y)\)</span>, <span class="math inline">\((x,y)\)</span> is a point in some square spatial domain, <span class="math inline">\(k_1\)</span> is the growth rate of the population, <span class="math inline">\(k_2\)</span> is the carrying capacity of the population, and <span class="math inline">\(D\)</span> is the rate of diffusion. Develop a finite difference scheme to solve this PDE. Experiment with this model showing the interplay between the parameters <span class="math inline">\(D\)</span>, <span class="math inline">\(k_1\)</span>, and <span class="math inline">\(k_2\)</span>. Take an initial condition of
<span class="math display">\[ u(0,x,y) = e^{-( (x-0.5)^2 + (y-0.5)^2)/0.05}. \]</span>
</div>
<hr />

<div class="exercise">
<p><span id="exr:unnamed-chunk-655" class="exercise"><strong>Exercise 6.92  </strong></span>In Exercise <a href="ch-pdes.html#exr:poisson2dhomog">6.72</a> you solved the Poisson equation, <span class="math inline">\(u_{xx} + u_{yy} = f(x,y)\)</span>, on the unit square with homogenous Dirichlet boundary conditions and a forcing function <span class="math inline">\(f(x,y) = -20 \exp\left(-\frac{(x-0.5)^2 + (y-0.5)^2}{0.05} \right)\)</span>. Use a <span class="math inline">\(10 \times 10\)</span> grid of points to solve the Poisson equation on the same domain with the same forcing function but with boundary conditions
<span class="math display">\[u(0,y)=0, \quad u(1,y) = 0, \quad u(x,0) = -\sin(\pi x), \quad u(x,1) = 0.\]</span>
Show a contour plot of your solution.</p>
</div>
<hr />
<div style="page-break-after: always;"></div>
</div>
</div>
<div id="projects-4" class="section level2" number="6.10">
<h2><span class="header-section-number">6.10</span> Projects</h2>
<p>In this section we propose several ideas for projects related to
numerical partial differential equations. These projects are meant to be
open ended, to encourage creative mathematics, to push your coding
skills, and to require you to write and communicate your mathematics.
Take the time to read Appendix <a href="ch-writing.html#ch-writing">B</a> before you write your final solution.</p>
<div id="hunting-and-diffusion" class="section level3" number="6.10.1">
<h3><span class="header-section-number">6.10.1</span> Hunting and Diffusion</h3>
<p>Let <span class="math inline">\(u\)</span> be a function modeling a mobile population that in an
environment where it has a growth rate of <span class="math inline">\(r\%\)</span> per year with a carrying
capacity of <span class="math inline">\(K\)</span>. If we were only worried about the size of the
population we could solve the differential equation
<span class="math display">\[\frac{du}{dt} = ru \left( 1-\frac{u}{K} \right),\]</span> but there is more
to the story.</p>
<p>Hunters harvest <span class="math inline">\(h\)</span>% of the population per year so we can append the
differential equation with the harvesting term “<span class="math inline">\(-h u\)</span>” to arrive at the
ordinary differential equation
<span class="math display">\[\frac{du}{dt} = ru \left( 1-\frac{u}{K} \right) - hu.\]</span></p>
<p>Since the population is mobile let’s make a few assumptions about the
environment that they’re in and how the individuals move.</p>
<ul>
<li><p>Food is abundant in the entire environment.</p></li>
<li><p>Individuals in the population like to spread out so that they don’t
interfere with each others’ hunt for food.</p></li>
<li><p>It is equally easy for the individuals to travel in any direction in
the environment.</p></li>
</ul>
<p>Clearly some of these assumptions are unreasonable for real populations
and real environments, but let’s go with it for now. Given the nature of
these assumptions we assume that a diffusion term models the spread of
the individuals in the population. Hence, the PDE model is
<span class="math display">\[\frac{\partial u}{\partial t} = ru\left( 1-\frac{u}{K} \right) - hu + D \left( u_{xx} + u_{yy|} \right).\]</span></p>
<ol style="list-style-type: decimal">
<li><p>Use any of your ODE codes to solve the ordinary differential
equation with harvesting. Give a complete description of the
parameter space.</p></li>
<li><p>Write code to solve the spatial+temporal PDE equation on the 2D
domain <span class="math inline">\((x,y) \in [0,1] \times [0,1]\)</span>. Choose an appropriate initial
condition and choose appropriate boundary conditions.</p></li>
<li><p>The third assumption isn’t necessary true for rough terrain. The
true form of the spatial component of the differential equation is
<span class="math inline">\(\nabla \cdot  \left( D(x,y) \nabla u \right)\)</span> where <span class="math inline">\(D(x,y)\)</span> is a
multivariable function dictating the ease of diffusion in different
spatial locations. Propose a (non-negative) function <span class="math inline">\(D(x,y)\)</span> and
repeat part (b) with this new diffusion term.</p></li>
</ol>
</div>
<div id="heating-adobe-houses" class="section level3" number="6.10.2">
<h3><span class="header-section-number">6.10.2</span> Heating Adobe Houses</h3>
<p>Adobe houses, typically built in desert climates, are known for their
great thermal efficiency. The heat equation
<span class="math display">\[\frac{\partial T}{\partial t} = \frac{k}{c_p \rho} \left( T_{xx} + T_{yy} + T_{zz} \right),\]</span>
where <span class="math inline">\(c_p\)</span> is the specific heat of the adobe, <span class="math inline">\(\rho\)</span> is the mass
density of the adobe, and <span class="math inline">\(k\)</span> is the thermal conductivity of the adobe,
can be used to model the heat transfer through the adobe from the
outside of the house to the inside. Clearly, the thicker the adobe walls
the better, but there is a trade off to be considered:</p>
<ul>
<li><p>it would be prohibitively expensive to build walls so think that the
inside temperature was (nearly) constant, and</p></li>
<li><p>if the walls are too thin then the cost is low but the temperature
inside has a large amount of variability.</p></li>
</ul>
<p>Your Tasks:</p>
<ol style="list-style-type: decimal">
<li><p>Pick a desert location in the southwestern US (New Mexico, Arizona,
Nevada, or Southern California) and find some basic temperature data
to model the outside temperature during typical summer and winter
months.</p></li>
<li><p>Do some research on the cost of building adobe walls and find
approximations for the parameters in the heat equation.</p></li>
<li><p>Use a numerical model to find the optimal thickness of an adobe
wall. Be sure to fully describe your criteria for optimality, the
initial and boundary conditions used, and any other simplifying
assumptions needed for your model.</p></li>
</ol>

</div>
</div>
</div>



<h3>References</h3>
<div id="refs" class="references csl-bib-body">
<div id="ref-simiodeheat" class="csl-entry">
<div class="csl-left-margin">[11] </div><div class="csl-right-inline">K. Spayd and J. Puckett, <span>“9-020-t-HeatDiffusion.”</span> Oct. 2019, [Online]. Available: <a href="https://simiode.org/resources/6452">https://simiode.org/resources/6452</a>.</div>
</div>
</div>
<div class="footnotes">
<hr />
<ol start="13">
<li id="fn13"><p>Take note that homogeneous boundary conditions are “0,” so saying that a PDE has homogeneous Dirichlet boundary conditions on this domain means that <span class="math inline">\(u(t,x,0) = u(t,x,1)=u(t,0,y)=u(t,1,y)=0\)</span>.<a href="ch-pdes.html#fnref13" class="footnote-back">↩︎</a></p></li>
</ol>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="ch-odes.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="ch-python.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": null,
"text": null
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["_main.pdf"],
"search": {
"engine": "fuse",
"options": null
},
"toc": {
"collapse": "section",
"toc_depth": 1
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
